{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogs/entry476/","result":{"data":{"site":{"siteMetadata":{"title":"銀ねこアトリエ"}},"allFile":{"edges":[]},"markdownRemark":{"id":"ee30adcb-d44d-57f8-828e-631fc053a236","excerpt":"スプシからファイルをアップロードしてドライブに保存するまでざっくり この記事は、【GAS】スプシからファイルアップロードし、ドライブに保存する・UI編の続編です。 ファイルアップロード用のコードを書きます。手順としては以下の流れです。 スプシを準備（済） GAS…","html":"<p><custom></custom></p>\n<h2 id=\"スプシからファイルをアップロードしてドライブに保存するまでざっくり\">スプシからファイルをアップロードしてドライブに保存するまでざっくり</h2>\n<div class=\"msg-baloon\">\n<p><img src=\"/static/ecd737bbd9e6b99fd33fbd308f2b88e8/f836f/camille.jpg\">かみーゆ</p>\n<p>この記事は「人のやる作業を減らしたい」、「書類を管理するためにルールを厳格に守りたい」、「個人で会社や仕事を切り盛りしている」方にオススメです。</p>\n</div>\n<p>この記事は、<a href=\"%22/blogs/entry475/\">【GAS】スプシからファイルアップロードし、ドライブに保存する・UI編</a>の続編です。</p>\n<p>ファイルアップロード用のコードを書きます。手順としては以下の流れです。</p>\n<ol>\n<li>スプシを準備（済）</li>\n<li>GASのプロジェクト作成（済）</li>\n<li>アップロード用のモーダルパーツを作成（UI追加）（済）</li>\n<li>\bバリデーションで保存するファイルのサイズやタイプを判定（済）</li>\n<li><em>\bGoogleドライブでファイルを保存しリネーム</em></li>\n<li>\b<em>スプシにファイル情報を書き出す</em></li>\n<li>\b<em>メニュー操作で保存処理を常に実行できるようにする</em></li>\n</ol>\n<p><small>※ （済）は前回の記事で紹介しています。</small></p>\n<p>1 ~ 4を確認したい方は前回の記事をお読みください。</p>\n<a class=\"article-link\" href=\"/blogs/entry475/\">\n<section><div class=\"article-link__img\"><img alt=\"【GAS】スプシからファイルアップロードし、ドライブに保存・UI編\" src=\"/static/c54562085bca0c60e7c9a80b7acd3a29/f836f/entry475.jpg\" width=\"150\" height=\"113\" class=\"\"></div><div class=\"article-link__main\">\n<div class=\"article-link__main__title\">【GAS】スプシからファイルアップロードし、ドライブに保存する・UI編</div>\n<p class=\"description\">プログラミングで自動化してヒューマンエラーやルールのブレをを減らしたい！Google Apps Scriptを使ってスプシ（Googleスプレッドシート）から･･･</p>\n<p>\n<time datetime=\"2021-06-24\">2021.06.24</time>\n</p>\n</div>\n</section>\n</a>\n<p>請求書の整理を例にとって進めていきます。</p>\n<p><br><em>ファイルがフォルダーに格納されるイメージ</em></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">請求書/\n ├ invoice-00001.pdf\n ├ invoice-00002.png\n ├ invoice-00002.jpg\n │   ・・・\n └ invoice-00008.png</code></pre></div>\n<h2 id=\"googleドライブにファイルを格納する\">Googleドライブにファイルを格納する</h2>\n<p>ファイルを格納するフォルダーを作ってコードを書いていきましょ！</p>\n<h3 id=\"請求書を格納するフォルダーを作る\">請求書を格納するフォルダーを作る</h3>\n<p>請求書を格納するためのフォルダーをGoogleドライブ上に作成します。</p>\n<p>今回はフォルダー名を<em>請求書</em>としました。IDをメモっておきます。URLのfolders/以降がIDです。</p>\n<p><code class=\"language-text\">https://drive.google.com/drive/u/0/folders/【ID】</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.69620253164557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHciwEHD//EABgQAAMBAQAAAAAAAAAAAAAAAAACEgEg/9oACAEBAAEFAoUlcJXj/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEyIP/aAAgBAQAGPwKUSiVj/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAEQwREx8f/aAAgBAQABPyFYKBrUnMh6j//aAAwDAQACAAMAAAAQIM//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgIDAAAAAAAAAAAAAAABABEQIXGRof/aAAgBAQABPxBIvpy2IHGDF+PBHYgUan//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e1866b7bf83bd645b065ac062cda7559/81b7c/entry475-4.webp 158w,\n/static/e1866b7bf83bd645b065ac062cda7559/6ea66/entry475-4.webp 315w,\n/static/e1866b7bf83bd645b065ac062cda7559/e88ff/entry475-4.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e1866b7bf83bd645b065ac062cda7559/ff44c/entry475-4.jpg 158w,\n/static/e1866b7bf83bd645b065ac062cda7559/a6688/entry475-4.jpg 315w,\n/static/e1866b7bf83bd645b065ac062cda7559/b4294/entry475-4.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e1866b7bf83bd645b065ac062cda7559/b4294/entry475-4.jpg\"\n            alt=\"folders/以降がID\"\n            title=\"folders/以降がID\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h3 id=\"ファイルを格納するコード\">ファイルを格納するコード</h3>\n<p><a href=\"/blogs/entry470/\">【GAS】スプシからファイルアップロードし、ドライブに保存する・UI編</a>で作った関数<code class=\"language-text\">sendForm</code>を書き換えます。ファイルを取得し、フォルダーに格納するまでのコードです。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">form</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> folder <span class=\"token operator\">=</span> DriveApp<span class=\"token punctuation\">.</span><span class=\"token function\">getFolderById</span><span class=\"token punctuation\">(</span>【フォルダー<span class=\"token constant\">ID</span>】<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> doc <span class=\"token operator\">=</span> folder<span class=\"token punctuation\">.</span><span class=\"token function\">createFile</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"ファイルをリネームする\">ファイルをリネームする</h3>\n<p>ファイルを管理用のIDでリネームします。</p>\n<p>今回は請求書なので<em>invoice + -（ハイフン） + 五桁の数字</em>としました。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">invoice-00001</code></pre></div>\n<p>ID生成のコードはこちらです。スプシに登録された請求書数からIDを作っていきます。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token keyword\">const</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> accounting <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'請求書'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> num <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> fileName <span class=\"token operator\">=</span> <span class=\"token string\">'invoice-'</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0000\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()</code>は2行以上連続でセルに値がないと取得できません。</p>\n<p>ファイルが未格納の場合は<em>1</em>にしておきます。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">(</span>accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>生成したIDでリネームします。</p>\n<p><code class=\"language-text\">setName</code>でファイル名を変更できます。保存が終了したら<code class=\"language-text\">Browser.msgBox</code>を使ってメッセージボックスを表示します。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">form</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> folder <span class=\"token operator\">=</span> DriveApp<span class=\"token punctuation\">.</span><span class=\"token function\">getFolderById</span><span class=\"token punctuation\">(</span>【フォルダー<span class=\"token constant\">ID</span>】<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> accounting <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'請求書'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> num <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> fileName <span class=\"token operator\">=</span> <span class=\"token string\">'invoice-'</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0000\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> doc <span class=\"token operator\">=</span> folder<span class=\"token punctuation\">.</span><span class=\"token function\">createFile</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    doc<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Browser<span class=\"token punctuation\">.</span><span class=\"token function\">msgBox</span><span class=\"token punctuation\">(</span><span class=\"token string\">'新しい請求書「'</span> <span class=\"token operator\">+</span> fileName <span class=\"token operator\">+</span> <span class=\"token string\">\"」を保存しました\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>実行すると権限を求められるので許可します。許可の仕方が分からない方は前回の記事<a href=\"/blogs/entry475/#%E6%A8%A9%E9%99%90%E3%81%AE%E8%A8%B1%E5%8F%AF\">権限の許可</a>を参考にしてください。</p>\n<p>処理が終わると<em>新しい請求書「invoice-xxxxx」を保存しました</em>と表示されます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.79746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF1vJkWAf/EABsQAAEEAwAAAAAAAAAAAAAAAAEAAgMQBBIU/9oACAEBAAEFAseJsi5mUCVsa//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAEFAQAAAAAAAAAAAAAAAAABEBExQZH/2gAIAQEABj8CWcN61lq3/8QAGxABAAICAwAAAAAAAAAAAAAAAQAxECFRceH/2gAIAQEAAT8hA30pjx4gUjpj62P/2gAMAwEAAgADAAAAEEAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAIDAQAAAAAAAAAAAAAAAQARECExwf/aAAgBAQABPxBHLUDR25RcCx3fbCUffj//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a794e9eee35d121f52fd9bdb95a65ab7/81b7c/entry476-2.webp 158w,\n/static/a794e9eee35d121f52fd9bdb95a65ab7/6ea66/entry476-2.webp 315w,\n/static/a794e9eee35d121f52fd9bdb95a65ab7/7f61c/entry476-2.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a794e9eee35d121f52fd9bdb95a65ab7/ff44c/entry476-2.jpg 158w,\n/static/a794e9eee35d121f52fd9bdb95a65ab7/a6688/entry476-2.jpg 315w,\n/static/a794e9eee35d121f52fd9bdb95a65ab7/066f9/entry476-2.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a794e9eee35d121f52fd9bdb95a65ab7/066f9/entry476-2.jpg\"\n            alt=\"実行結果\"\n            title=\"実行結果\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>リネームされたファイルがちゃんと指定されたGoogleドライブのフォルダー内に格納されます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.35443037974683%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAQAF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3kSmP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAAIDAQAAAAAAAAAAAAAAABARAAFRgf/aAAgBAQABPyHkVYEf/9oADAMBAAIAAwAAABAzD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAAICAwAAAAAAAAAAAAAAABEhARAAUYH/2gAIAQEAAT8QgJMMUdRsJ5f/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/62f335ba5866ef0cbf4726ab79fe40ae/81b7c/entry476-3.webp 158w,\n/static/62f335ba5866ef0cbf4726ab79fe40ae/6ea66/entry476-3.webp 315w,\n/static/62f335ba5866ef0cbf4726ab79fe40ae/7f61c/entry476-3.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/62f335ba5866ef0cbf4726ab79fe40ae/ff44c/entry476-3.jpg 158w,\n/static/62f335ba5866ef0cbf4726ab79fe40ae/a6688/entry476-3.jpg 315w,\n/static/62f335ba5866ef0cbf4726ab79fe40ae/066f9/entry476-3.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/62f335ba5866ef0cbf4726ab79fe40ae/066f9/entry476-3.jpg\"\n            alt=\"リネームされたファイルがちゃんと保存されます\"\n            title=\"リネームされたファイルがちゃんと保存されます\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>できた！！</p>\n<div class=\"msg-baloon\">\n<p><img src=\"/static/ecd737bbd9e6b99fd33fbd308f2b88e8/f836f/camille.jpg\">かみーゆ</p>\n<p>ドライブには同じ名前のファイルがアップロードできますよね？<br>ファイル名を自動でつけると重複することがないので、後々困らずにすみますよ！</p>\n</div>\n<h2 id=\"スプシにファイル情報を書き出す\">スプシにファイル情報を書き出す</h2>\n<p>ファイル以外のデータも取得します。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">;</span><span class=\"token comment\">//ファイルデータ</span>\n<span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">;</span><span class=\"token comment\">//日時データ</span>\n<span class=\"token keyword\">const</span> project <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>project<span class=\"token punctuation\">;</span><span class=\"token comment\">//プロジェクト名</span>\n<span class=\"token keyword\">var</span> client <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//顧客名。あとで値を取得します</span></code></pre></div>\n<p>顧客名はデータシートからデータを引っ張ってきて照合します。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'データ'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> projectsLastRow <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//最終行を取得</span>\n<span class=\"token keyword\">const</span> clients <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> projectsLastRow<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//プロジェクトと顧客の列のみ取得</span>\n\n<span class=\"token comment\">//プロジェクト名から顧客名を割り出す</span>\n<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token keyword\">in</span> clients<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>clients<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> project<span class=\"token punctuation\">)</span> client <span class=\"token operator\">=</span> clients<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>それぞれデータができたら、シートに出力します。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">'=HYPERLINK(\"'</span> <span class=\"token operator\">+</span> doc<span class=\"token punctuation\">.</span><span class=\"token function\">getUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\",\"'</span> <span class=\"token operator\">+</span> fileName <span class=\"token operator\">+</span> <span class=\"token string\">'\")'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">'請求書発行済'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>実行するとこんな感じになります。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.848101265822784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3AUH/8QAFRABAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQEAAQUCj//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABkQAAIDAQAAAAAAAAAAAAAAAAABETFRYf/aAAgBAQABPyFYSI4ij//aAAwDAQACAAMAAAAQ8A//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhUWH/2gAIAQEAAT8QEMVxSenYhmif/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/28dbfb5f4dccf2df552377da9e2738b3/81b7c/entry476-4.webp 158w,\n/static/28dbfb5f4dccf2df552377da9e2738b3/6ea66/entry476-4.webp 315w,\n/static/28dbfb5f4dccf2df552377da9e2738b3/e88ff/entry476-4.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/28dbfb5f4dccf2df552377da9e2738b3/ff44c/entry476-4.jpg 158w,\n/static/28dbfb5f4dccf2df552377da9e2738b3/a6688/entry476-4.jpg 315w,\n/static/28dbfb5f4dccf2df552377da9e2738b3/b4294/entry476-4.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/28dbfb5f4dccf2df552377da9e2738b3/b4294/entry476-4.jpg\"\n            alt=\"スプシの書き出し\"\n            title=\"スプシの書き出し\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<div class=\"msg-baloon\">\n<p><img src=\"/static/ecd737bbd9e6b99fd33fbd308f2b88e8/f836f/camille.jpg\">かみーゆ</p>\n<p>請求書などのファイルを一元管理！<br>IDのリンクからファイルに飛べるので、ファイルをいちいちドライブで探す必要がなくなりますヨ！</p>\n</div>\n<h2 id=\"sendformのすべてのコード\">sendFormのすべてのコード</h2>\n<p>ファイルをリネームしてドライブに保存し、スプシに書き出すまでの処理です。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/**\n * スプシのフォームからの値の受け取り、リネーム後、スプシに詳細を追記\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">form</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> folder <span class=\"token operator\">=</span> DriveApp<span class=\"token punctuation\">.</span><span class=\"token function\">getFolderById</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>フォルダー<span class=\"token constant\">ID</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//ファイルを取得したら。</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> accounting <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'請求書'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> num <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> fileName <span class=\"token operator\">=</span> <span class=\"token string\">'invoice-'</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0000\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> doc <span class=\"token operator\">=</span> folder<span class=\"token punctuation\">.</span><span class=\"token function\">createFile</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    doc<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Browser<span class=\"token punctuation\">.</span><span class=\"token function\">msgBox</span><span class=\"token punctuation\">(</span><span class=\"token string\">'新しい請求書「'</span> <span class=\"token operator\">+</span> fileName <span class=\"token operator\">+</span> <span class=\"token string\">\"」を保存しました\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//スプシに書き出すデータ</span>\n    <span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> project <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>project<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> client <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'データ'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> projectsLastRow <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> clients <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> projectsLastRow<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token keyword\">in</span> clients<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>clients<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> project<span class=\"token punctuation\">)</span> client <span class=\"token operator\">=</span> clients<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">//スプシに書き出し</span>\n    accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">'=HYPERLINK(\"'</span><span class=\"token operator\">+</span>doc<span class=\"token punctuation\">.</span><span class=\"token function\">getUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">'\",\"'</span><span class=\"token operator\">+</span>fileName<span class=\"token operator\">+</span><span class=\"token string\">'\")'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">'請求書発行済'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    Browser<span class=\"token punctuation\">.</span><span class=\"token function\">msgBox</span><span class=\"token punctuation\">(</span><span class=\"token string\">'保存できませんでした'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"メニューから操作して保存処理を常に実行できるようにする\">メニューから操作して保存処理を常に実行できるようにする</h2>\n<p>メニューを表示するための関数を<code class=\"language-text\">コード.gs</code>（GAS）に追記します。</p>\n<p><code class=\"language-text\">functionName</code>に前回<a href=\"/blogs/entry475\">【GAS】スプシからファイルアップロードし、ドライブに保存・UI編</a>で作った、フォームをスプシ上に出力するための関数<code class=\"language-text\">showMdal</code>をセットします。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/**\n * メニューの出力\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">setMenu</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> menu <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>name<span class=\"token operator\">:</span> <span class=\"token string\">\"請求書を発行する\"</span><span class=\"token punctuation\">,</span> functionName<span class=\"token operator\">:</span> <span class=\"token string\">\"showModal\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addMenu</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"請求書の管理\"</span><span class=\"token punctuation\">,</span> menu<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">setMenu</code>を実行します。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.0506329113924%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHuTSKD/8QAFxAAAwEAAAAAAAAAAAAAAAAAABARQf/aAAgBAQABBQLVCL//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAADAAMAAAAAAAAAAAAAAAAAAREQUXH/2gAIAQEAAT8hYSjKcInWP//aAAwDAQACAAMAAAAQHO//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPxBH/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8Qqv/EABsQAQADAQADAAAAAAAAAAAAAAEAETEhUWFx/9oACAEBAAE/EMHjWRkUXtluS3uN9T7AGwynwT//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/24d5935140a73cc05a40b59f63214b27/81b7c/entry476-5.webp 158w,\n/static/24d5935140a73cc05a40b59f63214b27/6ea66/entry476-5.webp 315w,\n/static/24d5935140a73cc05a40b59f63214b27/b0a15/entry476-5.webp 500w\"\n              sizes=\"(max-width: 500px) 100vw, 500px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/24d5935140a73cc05a40b59f63214b27/ff44c/entry476-5.jpg 158w,\n/static/24d5935140a73cc05a40b59f63214b27/a6688/entry476-5.jpg 315w,\n/static/24d5935140a73cc05a40b59f63214b27/41099/entry476-5.jpg 500w\"\n            sizes=\"(max-width: 500px) 100vw, 500px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/24d5935140a73cc05a40b59f63214b27/41099/entry476-5.jpg\"\n            alt=\"関数をセットし、実行\"\n            title=\"関数をセットし、実行\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>スプシ側で確認するとちゃんとメニューができました！！\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.708860759493675%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd2sJg//xAAWEAADAAAAAAAAAAAAAAAAAAAAECH/2gAIAQEAAQUCKv/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAAMAAAAAAAAAAAAAAAAAAAAQMf/aAAgBAQAGPwIq/8QAGRAAAwADAAAAAAAAAAAAAAAAAAEhMUGB/9oACAEBAAE/IeirI1Wz/9oADAMBAAIAAwAAABDzz//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEBAQEBAQAAAAAAAAAAAAABEQAhYXH/2gAIAQEAAT8QsGr3BqITtcDHV93/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d4cfe647244ad4ee16a9c52e16740df5/81b7c/entry476-6.webp 158w,\n/static/d4cfe647244ad4ee16a9c52e16740df5/c85cb/entry476-6.webp 300w\"\n              sizes=\"(max-width: 300px) 100vw, 300px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d4cfe647244ad4ee16a9c52e16740df5/ff44c/entry476-6.jpg 158w,\n/static/d4cfe647244ad4ee16a9c52e16740df5/f93b5/entry476-6.jpg 300w\"\n            sizes=\"(max-width: 300px) 100vw, 300px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d4cfe647244ad4ee16a9c52e16740df5/f93b5/entry476-6.jpg\"\n            alt=\"関数をセットし、実行\"\n            title=\"関数をセットし、実行\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h3 id=\"常にメニューをスプシ側で表示する\">常にメニューをスプシ側で表示する</h3>\n<p>トリガーから「トリガーを追加」を選びます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 450px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.75949367088608%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAUBAgP/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAXxOZcVmp//EABgQAAIDAAAAAAAAAAAAAAAAAAECAyAx/9oACAEBAAEFAqYFncj/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEv/aAAgBAgEBPwFL/8QAFhABAQEAAAAAAAAAAAAAAAAAARAg/9oACAEBAAY/AsLP/8QAGhAAAgIDAAAAAAAAAAAAAAAAAREAMRAhkf/aAAgBAQABPyFS9PJKa04yEjk//9oADAMBAAIAAwAAABCz/wD/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8QS6//xAAVEQEBAAAAAAAAAAAAAAAAAAABAP/aAAgBAgEBPxCWX//EABwQAQACAgMBAAAAAAAAAAAAAAEAETFBEFGRof/aAAgBAQABPxARv5BEgKZKiJ15xWEArVuIrO6wn//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b7980c82bf37a889bc381741dec5c77b/81b7c/entry476-7.webp 158w,\n/static/b7980c82bf37a889bc381741dec5c77b/6ea66/entry476-7.webp 315w,\n/static/b7980c82bf37a889bc381741dec5c77b/8626f/entry476-7.webp 450w\"\n              sizes=\"(max-width: 450px) 100vw, 450px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b7980c82bf37a889bc381741dec5c77b/ff44c/entry476-7.jpg 158w,\n/static/b7980c82bf37a889bc381741dec5c77b/a6688/entry476-7.jpg 315w,\n/static/b7980c82bf37a889bc381741dec5c77b/20e5d/entry476-7.jpg 450w\"\n            sizes=\"(max-width: 450px) 100vw, 450px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b7980c82bf37a889bc381741dec5c77b/20e5d/entry476-7.jpg\"\n            alt=\"entry476 7\"\n            title=\"entry476 7\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>関数に<code class=\"language-text\">setMenu</code>をセット。あとは、デフォルトのままで大丈夫です。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.46835443037975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIDBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHsTWGRMXSDMD//xAAcEAEAAQQDAAAAAAAAAAAAAAACAAEDETESITL/2gAIAQEAAQUCJOOJjJydS5s+Yuq//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAGhABAAIDAQAAAAAAAAAAAAAAAQAQITEykf/aAAgBAQAGPwIwTk8miFl//8QAHxAAAgEDBQEAAAAAAAAAAAAAAAEREDGhIUFRYXGB/9oACAEBAAE/IekS2IyJJCtODCVLPhgUWxP1yf/aAAwDAQACAAMAAAAQs8cA/8QAFhEAAwAAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/EKj/xAAWEQADAAAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8QrP/EACEQAQABAgUFAAAAAAAAAAAAAAEAEUEQMVFhcSGRsdHw/9oACAEBAAE/EE1uO6cRoCrvR6hEdYEuyw3u0Mp8m7CZdvjAAEqlepc6z//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3dd569c08d9c4c5b66d847c72cd18925/81b7c/entry476-8.webp 158w,\n/static/3dd569c08d9c4c5b66d847c72cd18925/6ea66/entry476-8.webp 315w,\n/static/3dd569c08d9c4c5b66d847c72cd18925/b0a15/entry476-8.webp 500w\"\n              sizes=\"(max-width: 500px) 100vw, 500px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3dd569c08d9c4c5b66d847c72cd18925/ff44c/entry476-8.jpg 158w,\n/static/3dd569c08d9c4c5b66d847c72cd18925/a6688/entry476-8.jpg 315w,\n/static/3dd569c08d9c4c5b66d847c72cd18925/41099/entry476-8.jpg 500w\"\n            sizes=\"(max-width: 500px) 100vw, 500px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3dd569c08d9c4c5b66d847c72cd18925/41099/entry476-8.jpg\"\n            alt=\"entry476 8\"\n            title=\"entry476 8\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>これでスプシ起動時にメニューが表示され、いつでもファイルをアップロードできるようになりました。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.56962025316456%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHuW0wolEBf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQABBQIf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwIf/8QAGhABAAIDAQAAAAAAAAAAAAAAAQARECExUf/aAAgBAQABPyENcCUvkQvYM6Qoj2Wy8f/aAAwDAQACAAMAAAAQYA9A/8QAFhEAAwAAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/ECP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAbEAADAQADAQAAAAAAAAAAAAAAAREhMUFR8P/aAAgBAQABPxBipfXCLMXNfA/pF20SCd46EREocwvQr0es/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8da89153174e98fff4ff461cf2161dee/81b7c/entry476-9.webp 158w,\n/static/8da89153174e98fff4ff461cf2161dee/6ea66/entry476-9.webp 315w,\n/static/8da89153174e98fff4ff461cf2161dee/8aab1/entry476-9.webp 630w,\n/static/8da89153174e98fff4ff461cf2161dee/d00b9/entry476-9.webp 800w\"\n              sizes=\"(max-width: 630px) 100vw, 630px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8da89153174e98fff4ff461cf2161dee/ff44c/entry476-9.jpg 158w,\n/static/8da89153174e98fff4ff461cf2161dee/a6688/entry476-9.jpg 315w,\n/static/8da89153174e98fff4ff461cf2161dee/828fb/entry476-9.jpg 630w,\n/static/8da89153174e98fff4ff461cf2161dee/4b190/entry476-9.jpg 800w\"\n            sizes=\"(max-width: 630px) 100vw, 630px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8da89153174e98fff4ff461cf2161dee/828fb/entry476-9.jpg\"\n            alt=\"リネームされたファイルがちゃんと保存されます\"\n            title=\"リネームされたファイルがちゃんと保存されます\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h2 id=\"まとめ・gasはやっぱり便利じゃわー（広島弁）\">まとめ・GASはやっぱり便利じゃわー（広島弁）</h2>\n<p>今回は前回のアップロードフォームのパーツ表示に続き、ファイルにバリデーションをかけてアップロードし、スプシにデータを書き出す方法をご紹介しました。</p>\n<div class=\"msg-baloon\">\n<p><img src=\"/static/ecd737bbd9e6b99fd33fbd308f2b88e8/f836f/camille.jpg\">かみーゆ</p>\n<p>普段の事務作業を少しでも減らしたくてGASを使ってみたら便利だったのでこの記事を書きました</p>\n</div>\n<p>フォルダー自動生成に関しては、こちらの記事を参考に！</p>\n<a class=\"article-link\" href=\"/blogs/entry470/\">\n<section><div class=\"article-link__img\"><img alt=\"Google Apps Script（GAS） でスプシからドライブにフォルダー自動生成\" src=\"/static/250e1864a7205400c846e6381f082a1a/f836f/entry470.jpg\" width=\"150\" height=\"113\" class=\"\"></div><div class=\"article-link__main\">\n<div class=\"article-link__main__title\">Google Apps Script（GAS） でスプシからドライブにフォルダー自動生成</div>\n<p class=\"description\">GASを使ってスプレッドシートからGoogleドライブにフォルダーを自動追加する方法の紹介です･･･</p>\n<p>\n<time datetime=\"2021-06-08\">2021.06.08</time>\n</p>\n</div>\n</section>\n</a>\n<p>皆さんの事務作業軽減の一助となれば幸いです。</p>\n<p>最後までお読みいただきありがとうございました。</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E3%82%B9%E3%83%97%E3%82%B7%E3%81%8B%E3%82%89%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89%E3%81%97%E3%81%A6%E3%83%89%E3%83%A9%E3%82%A4%E3%83%96%E3%81%AB%E4%BF%9D%E5%AD%98%E3%81%99%E3%82%8B%E3%81%BE%E3%81%A7%E3%81%96%E3%81%A3%E3%81%8F%E3%82%8A\">スプシからファイルをアップロードしてドライブに保存するまでざっくり</a></p>\n</li>\n<li>\n<p><a href=\"#google%E3%83%89%E3%83%A9%E3%82%A4%E3%83%96%E3%81%AB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E6%A0%BC%E7%B4%8D%E3%81%99%E3%82%8B\">Googleドライブにファイルを格納する</a></p>\n<ul>\n<li><a href=\"#%E8%AB%8B%E6%B1%82%E6%9B%B8%E3%82%92%E6%A0%BC%E7%B4%8D%E3%81%99%E3%82%8B%E3%83%95%E3%82%A9%E3%83%AB%E3%83%80%E3%83%BC%E3%82%92%E4%BD%9C%E3%82%8B\">請求書を格納するフォルダーを作る</a></li>\n<li><a href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E6%A0%BC%E7%B4%8D%E3%81%99%E3%82%8B%E3%82%B3%E3%83%BC%E3%83%89\">ファイルを格納するコード</a></li>\n<li><a href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E3%83%AA%E3%83%8D%E3%83%BC%E3%83%A0%E3%81%99%E3%82%8B\">ファイルをリネームする</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%82%B9%E3%83%97%E3%82%B7%E3%81%AB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%83%85%E5%A0%B1%E3%82%92%E6%9B%B8%E3%81%8D%E5%87%BA%E3%81%99\">スプシにファイル情報を書き出す</a></p>\n</li>\n<li>\n<p><a href=\"#sendform%E3%81%AE%E3%81%99%E3%81%B9%E3%81%A6%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89\">sendFormのすべてのコード</a></p>\n</li>\n<li>\n<p><a href=\"#%E3%83%A1%E3%83%8B%E3%83%A5%E3%83%BC%E3%81%8B%E3%82%89%E6%93%8D%E4%BD%9C%E3%81%97%E3%81%A6%E4%BF%9D%E5%AD%98%E5%87%A6%E7%90%86%E3%82%92%E5%B8%B8%E3%81%AB%E5%AE%9F%E8%A1%8C%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\">メニューから操作して保存処理を常に実行できるようにする</a></p>\n<ul>\n<li><a href=\"#%E5%B8%B8%E3%81%AB%E3%83%A1%E3%83%8B%E3%83%A5%E3%83%BC%E3%82%92%E3%82%B9%E3%83%97%E3%82%B7%E5%81%B4%E3%81%A7%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\">常にメニューをスプシ側で表示する</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81%E3%83%BBgas%E3%81%AF%E3%82%84%E3%81%A3%E3%81%B1%E3%82%8A%E4%BE%BF%E5%88%A9%E3%81%98%E3%82%83%E3%82%8F%E3%83%BC%EF%BC%88%E5%BA%83%E5%B3%B6%E5%BC%81%EF%BC%89\">まとめ・GASはやっぱり便利じゃわー（広島弁）</a></p>\n</li>\n</ul>","frontmatter":{"title":"【GAS】 スプシにファイルアップロード機能をつけてドライブに保存・保存編","date":"2021.06.26","description":"プログラミングで事務作業を自動化してラクしよう！前回に続き、Google Apps Scriptを使ってファイルを管理する方法を紹介します。この記事では 1.スプシ（Googleスプレッドシート）からファイルアップロード2.ルール通りにファイルをリネーム保存 3.スプシにファイル情報を自動で追記する方法を解説します。","lead":["プログラミングで事務作業を自動化してラクしよう！","前回に続き、Google Apps Scriptを使ってファイルを管理する方法を紹介します。 この記事では1.スプシ（Googleスプレッドシート）からファイルアップロード 2.ルール通りにファイルをリネーム保存 3.スプシにファイル情報を自動で追記する方法を解説します。"],"hero":"entry476.jp","cateId":"web-developer","tags":["GAS","JavaScript"],"pagetype":"blog","modifieddate":null}},"previous":{"fields":{"slug":"/blogs/entry475/"},"frontmatter":{"title":"【GAS】スプシからファイルアップロードし、ドライブに保存・UI編"}},"next":null},"pageContext":{"id":"ee30adcb-d44d-57f8-828e-631fc053a236","previousPostId":"77afcb2c-7c11-5ed4-aef9-0606b430b374","nextPostId":null,"hero":"entry476.jp"}},"staticQueryHashes":["1145805751","2829560153","3000541721","3766793980"]}