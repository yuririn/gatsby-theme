{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogs/entry455/","result":{"data":{"site":{"siteMetadata":{"title":"銀ねこアトリエ"}},"allFile":{"edges":[{"node":{"name":"entry455","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/f0f06a57307c09469dad2f8e1bf5723d/88c96/entry455.jpg","srcSet":"/static/f0f06a57307c09469dad2f8e1bf5723d/e23da/entry455.jpg 350w,\n/static/f0f06a57307c09469dad2f8e1bf5723d/cd750/entry455.jpg 750w,\n/static/f0f06a57307c09469dad2f8e1bf5723d/5caa2/entry455.jpg 1080w,\n/static/f0f06a57307c09469dad2f8e1bf5723d/88c96/entry455.jpg 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/f0f06a57307c09469dad2f8e1bf5723d/4c075/entry455.webp 350w,\n/static/f0f06a57307c09469dad2f8e1bf5723d/e56aa/entry455.webp 750w,\n/static/f0f06a57307c09469dad2f8e1bf5723d/257a3/entry455.webp 1080w,\n/static/f0f06a57307c09469dad2f8e1bf5723d/296b8/entry455.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":900}}}}]},"markdownRemark":{"id":"f7836ac6-98fd-560c-9561-4c746d0d3f7d","excerpt":"今回この実装をしたきっかけ 複数のブランチを持つクライアントがいて、データをまとめてWordPress…","html":"<h2 id=\"今回この実装をしたきっかけ\">今回この実装をしたきっかけ</h2>\n<p>複数のブランチを持つクライアントがいて、データをまとめてWordPressに登録するのがしんどい！でも各担当者にそれぞれ書かせたら、書式がバラバラになるのはイヤ。。。。</p>\n<p>ということで、各担当者にデータをスプシ上決まった書式で入力してもらったら楽なんじゃないかと思いスプシ管理が実現しました。</p>\n<h2 id=\"下準備・スプシ側の設定\">下準備・スプシ側の設定</h2>\n<p>まず新規でスプレッドシートを作成します。</p>\n<p>今回は各ブランチのイベントなどの日程を一箇所に表示するような機能を作ってみます。</p>\n<p>まずは各ブランチ用のシートを作ります。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.571428571428573%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAEABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB16AB/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAERMf/aAAgBAQABBQJZCH//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAADAAAAAAAAAAAAAAAAAAAAATH/2gAIAQEABj8CrKys/8QAGRAAAgMBAAAAAAAAAAAAAAAAAAERMbHx/9oACAEBAAE/IZsCtoPoP//aAAwDAQACAAMAAAAQAA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEAAwEBAAAAAAAAAAAAAAABABExIWH/2gAIAQEAAT8Q7js4+XFaO0MPJP/Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/37d5715b2459793dd8e81273316d5975/c54d4/entry455-0.webp 175w,\n/static/37d5715b2459793dd8e81273316d5975/a3432/entry455-0.webp 350w,\n/static/37d5715b2459793dd8e81273316d5975/426ac/entry455-0.webp 700w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/37d5715b2459793dd8e81273316d5975/e52aa/entry455-0.jpg 175w,\n/static/37d5715b2459793dd8e81273316d5975/70ebb/entry455-0.jpg 350w,\n/static/37d5715b2459793dd8e81273316d5975/29d31/entry455-0.jpg 700w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/37d5715b2459793dd8e81273316d5975/29d31/entry455-0.jpg\"\n            alt=\"まずは各ブランチ用のシート\"\n            title=\"まずは各ブランチ用のシート\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h3 id=\"b列に日付\">B列に日付</h3>\n<p>日付は入力規則で制限をかけます。</p>\n<p>セルを選んだ状態で、右クリックしたらデータの入力規則という項目を選びます。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd2XJYg//8QAGRAAAgMBAAAAAAAAAAAAAAAAAAESITFB/9oACAEBAAEFAkdFsbP/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAAAAREhMRD/2gAIAQEAAT8hTS58ew0cmZh//9oADAMBAAIAAwAAABBgz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABgQAQEBAQEAAAAAAAAAAAAAAAERIQAx/9oACAEBAAE/EBJ83y8YSS5vJIcCITXeW21s4AQQ7//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e9b3fcd01486734b08ad27f40cf9f633/c54d4/entry455-1.webp 175w,\n/static/e9b3fcd01486734b08ad27f40cf9f633/a3432/entry455-1.webp 350w,\n/static/e9b3fcd01486734b08ad27f40cf9f633/e88ff/entry455-1.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e9b3fcd01486734b08ad27f40cf9f633/e52aa/entry455-1.jpg 175w,\n/static/e9b3fcd01486734b08ad27f40cf9f633/70ebb/entry455-1.jpg 350w,\n/static/e9b3fcd01486734b08ad27f40cf9f633/b4294/entry455-1.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e9b3fcd01486734b08ad27f40cf9f633/b4294/entry455-1.jpg\"\n            alt=\"セルを選んだ状態で、右クリックしたらデータの入力規則\"\n            title=\"セルを選んだ状態で、右クリックしたらデータの入力規則\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>書式を狂わせないために条件を日付にし、入力拒否。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.285714285714285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHbpoZAn//EABcQAAMBAAAAAAAAAAAAAAAAAAABISD/2gAIAQEAAQUCFcKH/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFxAAAwEAAAAAAAAAAAAAAAAAABEgMf/aAAgBAQAGPwKdZ//EABsQAAIBBQAAAAAAAAAAAAAAAAABMRARIUFx/9oACAEBAAE/IYyMkgZeiPZ0f//aAAwDAQACAAMAAAAQ0x//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8QS6//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAADAQEAAwAAAAAAAAAAAAAAAREhMWFxgf/aAAgBAQABPxByUVzcwulHwRXg8cRX6gladztezwf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/49a6b69626f4b994dfac2391d78d4277/c54d4/entry455-2.webp 175w,\n/static/49a6b69626f4b994dfac2391d78d4277/a3432/entry455-2.webp 350w,\n/static/49a6b69626f4b994dfac2391d78d4277/e88ff/entry455-2.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/49a6b69626f4b994dfac2391d78d4277/e52aa/entry455-2.jpg 175w,\n/static/49a6b69626f4b994dfac2391d78d4277/70ebb/entry455-2.jpg 350w,\n/static/49a6b69626f4b994dfac2391d78d4277/b4294/entry455-2.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/49a6b69626f4b994dfac2391d78d4277/b4294/entry455-2.jpg\"\n            alt=\"日付は入力規則で、入力制限をかける\"\n            title=\"日付は入力規則で、入力制限をかける\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h3 id=\"c、d列に時間を設定\">C、D列に時間を設定</h3>\n<p>C、D列には時間を入れます。この項目は別セルに共通の時間を入力しておき、データを引っ張ってくるやり方もあるんですが面倒なので直入力しました。</p>\n<p>これで決まった時間しか入力できなくなりました。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.14285714285714%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB7i8BmT//xAAXEAADAQAAAAAAAAAAAAAAAAAAAREg/9oACAEBAAEFAmXCP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABoQAAICAwAAAAAAAAAAAAAAAAFBACERIDH/2gAIAQEAAT8hpBkxo9nrM//aAAwDAQACAAMAAAAQdB//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPxBX/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBAAAgMAAwEAAAAAAAAAAAAAAREAITFBUXGx/9oACAEBAAE/ECCka9LQhMRbDqcRe73BQu30P2f/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/da2c575bb3c2e418a6b8cb66ececd845/c54d4/entry455-3.webp 175w,\n/static/da2c575bb3c2e418a6b8cb66ececd845/a3432/entry455-3.webp 350w,\n/static/da2c575bb3c2e418a6b8cb66ececd845/e88ff/entry455-3.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/da2c575bb3c2e418a6b8cb66ececd845/e52aa/entry455-3.jpg 175w,\n/static/da2c575bb3c2e418a6b8cb66ececd845/70ebb/entry455-3.jpg 350w,\n/static/da2c575bb3c2e418a6b8cb66ececd845/b4294/entry455-3.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/da2c575bb3c2e418a6b8cb66ececd845/b4294/entry455-3.jpg\"\n            alt=\"日付は入力規則で、入力制限をかける\"\n            title=\"日付は入力規則で、入力制限をかける\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>スプシにはデータが蓄積されていきますが、当月とその先の日程のみの日程をA列に出力します。</p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token operator\">=</span><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">and</span><span class=\"token punctuation\">(</span>B4<span class=\"token operator\">></span><span class=\"token operator\">=</span><span class=\"token keyword\">date</span><span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">(</span>today<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>month<span class=\"token punctuation\">(</span>today<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>B4<span class=\"token operator\">&lt;</span><span class=\"token operator\">></span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>year<span class=\"token punctuation\">(</span><span class=\"token operator\">$</span>B4<span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">&amp;</span>text<span class=\"token punctuation\">(</span>month<span class=\"token punctuation\">(</span><span class=\"token operator\">$</span>B4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"00\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token string\">\"-\"</span><span class=\"token operator\">&amp;</span>text<span class=\"token punctuation\">(</span>DAY<span class=\"token punctuation\">(</span><span class=\"token operator\">$</span>B4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"00\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token string\">\" \"</span><span class=\"token operator\">&amp;</span>text<span class=\"token punctuation\">(</span>C4<span class=\"token punctuation\">,</span><span class=\"token string\">\"00\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token string\">\":\"</span><span class=\"token operator\">&amp;</span>text<span class=\"token punctuation\">(</span>D4<span class=\"token punctuation\">,</span><span class=\"token string\">\"00\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token string\">\":00\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>日にちが過ぎたかつ、出力しない行はグレーアウトします。条件式書式の設定を利用します。</p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token operator\">=</span><span class=\"token keyword\">and</span><span class=\"token punctuation\">(</span><span class=\"token operator\">$</span>B4<span class=\"token operator\">&lt;</span>today<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">$</span>B4<span class=\"token operator\">&lt;</span><span class=\"token operator\">></span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ここまでできたら、入力規則・書式と条件式書式をコピーしてすべてのセルにコピーします。</p>\n<p>ブランチの数だけシートをコピーしてシート名とタイトルだけ変更します。</p>\n<h3 id=\"すべてのデータの作成\">すべてのデータの作成</h3>\n<p>タブの一番左にすべてのデータをまとめるシートを作ります。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.714285714285715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAG4AD//xAAVEAEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAQABBQKP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhABAQEAAAAAAAAAAAAAAAAAMQAQ/9oACAEBAAY/Amc//8QAFhABAQEAAAAAAAAAAAAAAAAAEQAB/9oACAEBAAE/IRDKF//aAAwDAQACAAMAAAAQg8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAABBAMAAAAAAAAAAAAAAAABABEhQTFhof/aAAgBAQABPxAsCUDKetxUAvsr/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4be5a7f45da0de7fc51b9c39cadca319/c54d4/entry455-7.webp 175w,\n/static/4be5a7f45da0de7fc51b9c39cadca319/a3432/entry455-7.webp 350w,\n/static/4be5a7f45da0de7fc51b9c39cadca319/e88ff/entry455-7.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4be5a7f45da0de7fc51b9c39cadca319/e52aa/entry455-7.jpg 175w,\n/static/4be5a7f45da0de7fc51b9c39cadca319/70ebb/entry455-7.jpg 350w,\n/static/4be5a7f45da0de7fc51b9c39cadca319/b4294/entry455-7.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4be5a7f45da0de7fc51b9c39cadca319/b4294/entry455-7.jpg\"\n            alt=\"すべてのデータの作成\"\n            title=\"すべてのデータの作成\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>GASであれこれ自動化することもできそうですが、今回はデータも少ないので手入力です。</p>\n<p>B列を参照してAブランチ、Bブランチのデータを<code class=\"language-text\">,（カンマ）</code>区切りで連結します。</p>\n<p>このデータは受け取った側でバラします。</p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token operator\">=</span>TEXTJOIN<span class=\"token punctuation\">(</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>INDIRECT<span class=\"token punctuation\">(</span>B3<span class=\"token operator\">&amp;</span><span class=\"token string\">\"!$A$4:A\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"担当者に自分のシートと決まった範囲しか編集させない\">担当者に自分のシートと決まった範囲しか編集させない</h3>\n<p>他ブランチのスタッフには閲覧権限だけつけておきます。\n担当ブランチの編集できないように各シートの日付、時間、備考のみに範囲の編集権限をつけます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdigkWf/xAAWEAEBAQAAAAAAAAAAAAAAAAAAIUH/2gAIAQEAAQUCrK//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAVEAEBAAAAAAAAAAAAAAAAAAAAMf/aAAgBAQAGPwKqr//EABkQAQADAQEAAAAAAAAAAAAAAAEAEaEx8P/aAAgBAQABPyECl4iPGJ4qf//aAAwDAQACAAMAAAAQi+//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEAAgMBAAAAAAAAAAAAAAABABEhMUHx/9oACAEBAAE/ECgXd4VAnp0EXyT/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c2c2a1718727fd21b62ea7e232b8dc65/c54d4/entry455-6.webp 175w,\n/static/c2c2a1718727fd21b62ea7e232b8dc65/a3432/entry455-6.webp 350w,\n/static/c2c2a1718727fd21b62ea7e232b8dc65/e88ff/entry455-6.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c2c2a1718727fd21b62ea7e232b8dc65/e52aa/entry455-6.jpg 175w,\n/static/c2c2a1718727fd21b62ea7e232b8dc65/70ebb/entry455-6.jpg 350w,\n/static/c2c2a1718727fd21b62ea7e232b8dc65/b4294/entry455-6.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c2c2a1718727fd21b62ea7e232b8dc65/b4294/entry455-6.jpg\"\n            alt=\"担当ブランチの編集できないように各シートの日付、時間、備考のみに範囲の編集権限\"\n            title=\"担当ブランチの編集できないように各シートの日付、時間、備考のみに範囲の編集権限\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>編集権限をつけます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.42857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHuU0lBP//EABgQAAIDAAAAAAAAAAAAAAAAAAABEBFB/9oACAEBAAEFAtHNn//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAAMAAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwJYf//EABgQAAMBAQAAAAAAAAAAAAAAAAABESEx/9oACAEBAAE/IUlUYjohDd0ph//aAAwDAQACAAMAAAAQY9//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPxBX/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAAMBAQEBAAAAAAAAAAAAAREhMQBhEEH/2gAIAQEAAT8QlASMU8KJh94H4M7ajvxfpG0X7vf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0b4acda320b3c5c9da2673c95228827a/c54d4/entry455-4.webp 175w,\n/static/0b4acda320b3c5c9da2673c95228827a/a3432/entry455-4.webp 350w,\n/static/0b4acda320b3c5c9da2673c95228827a/e88ff/entry455-4.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0b4acda320b3c5c9da2673c95228827a/e52aa/entry455-4.jpg 175w,\n/static/0b4acda320b3c5c9da2673c95228827a/70ebb/entry455-4.jpg 350w,\n/static/0b4acda320b3c5c9da2673c95228827a/b4294/entry455-4.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0b4acda320b3c5c9da2673c95228827a/b4294/entry455-4.jpg\"\n            alt=\"セル以外は編集できないように範囲の編集権限\"\n            title=\"セル以外は編集できないように範囲の編集権限\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h3 id=\"スプシをウェブ公開してjsonデータを取得しよう！\">スプシをウェブ公開してJSONデータを取得しよう！</h3>\n<p>スプシに「リンクを知っている全員」に閲覧権限をつけます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAMBAgQF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAexdEjTGWf/EABkQAAIDAQAAAAAAAAAAAAAAAAABAhEhEv/aAAgBAQABBQJXWmikzpinI//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/AVf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPwFH/8QAGhAAAQUBAAAAAAAAAAAAAAAAAAEQITGhQf/aAAgBAQAGPwIvC8dZ6f/EABsQAAICAwEAAAAAAAAAAAAAAAABESFRYaGR/9oACAEBAAE/IUiteEEaxCGr4bOEi0f/2gAMAwEAAgADAAAAEJAP/8QAFREBAQAAAAAAAAAAAAAAAAAAAAH/2gAIAQMBAT8QQ//EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAgEBPxBcP//EAB4QAAIBBAMBAAAAAAAAAAAAAAABESExQaFhkfDB/9oACAEBAAE/EFpd36JFEi95GX67LCWWAp1R0H5WQ0Tg/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b0fe490f9cae278aab21306a02fb111b/c54d4/entry455-9.webp 175w,\n/static/b0fe490f9cae278aab21306a02fb111b/a3432/entry455-9.webp 350w,\n/static/b0fe490f9cae278aab21306a02fb111b/426ac/entry455-9.webp 700w,\n/static/b0fe490f9cae278aab21306a02fb111b/d00b9/entry455-9.webp 800w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b0fe490f9cae278aab21306a02fb111b/e52aa/entry455-9.jpg 175w,\n/static/b0fe490f9cae278aab21306a02fb111b/70ebb/entry455-9.jpg 350w,\n/static/b0fe490f9cae278aab21306a02fb111b/29d31/entry455-9.jpg 700w,\n/static/b0fe490f9cae278aab21306a02fb111b/4b190/entry455-9.jpg 800w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b0fe490f9cae278aab21306a02fb111b/29d31/entry455-9.jpg\"\n            alt=\"スプシに閲覧権限をつける\"\n            title=\"スプシに閲覧権限をつける\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>「ファイル」から「ウェブに公開」を選び、Webページとしてすべてのデータのみ公開します。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 108.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAWABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe5qDQJQA//EABUQAQEAAAAAAAAAAAAAAAAAACAR/9oACAEBAAEFAhD/AP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEABj8CH//EABwQAAICAgMAAAAAAAAAAAAAAAABMUEQESFRkf/aAAgBAQABPyG5Oe14M0SnFiGf/9oADAMBAAIAAwAAABDwAAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAZEAEAAwEBAAAAAAAAAAAAAAABABExIXH/2gAIAQEAAT8Q6JAPlyuYNTte6y1HBpWx2dE0RKdKmp//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fb7fe47469fba3924d2da19dbe578f45/c54d4/entry455-8.webp 175w,\n/static/fb7fe47469fba3924d2da19dbe578f45/a3432/entry455-8.webp 350w,\n/static/fb7fe47469fba3924d2da19dbe578f45/e88ff/entry455-8.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fb7fe47469fba3924d2da19dbe578f45/e52aa/entry455-8.jpg 175w,\n/static/fb7fe47469fba3924d2da19dbe578f45/70ebb/entry455-8.jpg 350w,\n/static/fb7fe47469fba3924d2da19dbe578f45/b4294/entry455-8.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fb7fe47469fba3924d2da19dbe578f45/b4294/entry455-8.jpg\"\n            alt=\"スプシに閲覧権限をつける\"\n            title=\"スプシに閲覧権限をつける\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>ちなみに、*「変更が加えられたときに自動的に公開する」*も選ぶとシートを更新したらデータも更新されます。</p>\n<p>今回は事故防止のためにあえてチェックを外しました。</p>\n<p>ではデータを取得してみましょう。</p>\n<table>\n<thead>\n<tr>\n<th>ページのID</th>\n<th>ページの順番</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>{sheet_id}</td>\n<td>{sheet_order}</td>\n</tr>\n</tbody>\n</table>\n<p>スプシのURLからID取得します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://docs.google.com/spreadsheets/d/{スプシのid}/edit#gid={なんかのID}</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 5.714285714285714%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAABABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABzIAH/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFRABAQAAAAAAAAAAAAAAAAAAARD/2gAIAQEAAT8hb//aAAwDAQACAAMAAAAQ+C//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAYEAADAQEAAAAAAAAAAAAAAAAAATFBcf/aAAgBAQABPxCFw0dP/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bd8e37e255a9f5af2b961030aeada28c/c54d4/entry455-10.webp 175w,\n/static/bd8e37e255a9f5af2b961030aeada28c/a3432/entry455-10.webp 350w,\n/static/bd8e37e255a9f5af2b961030aeada28c/426ac/entry455-10.webp 700w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bd8e37e255a9f5af2b961030aeada28c/e52aa/entry455-10.jpg 175w,\n/static/bd8e37e255a9f5af2b961030aeada28c/70ebb/entry455-10.jpg 350w,\n/static/bd8e37e255a9f5af2b961030aeada28c/29d31/entry455-10.jpg 700w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bd8e37e255a9f5af2b961030aeada28c/29d31/entry455-10.jpg\"\n            alt=\"シートのURLからID取得します\"\n            title=\"シートのURLからID取得します\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><code class=\"language-text\">{sheet_id}</code>にはスプシのID、1枚目のシートなので<code class=\"language-text\">{sheet_order}</code>には1と入れます。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">https://spreadsheets.google.com/feeds/list/{$sheet_id}/{$sheet_order}/public/values?alt=json</code></pre></div>\n<p>URLを叩いてみましょう。</p>\n<p>JSONデータが返ってきました！！</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.42857142857142%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB1wWD/8QAFxABAQEBAAAAAAAAAAAAAAAAABIBAv/aAAgBAQABBQKMQjl//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhAAAwAAAAAAAAAAAAAAAAAAAAEy/9oACAEBAAY/ApRKJR//xAAaEAACAgMAAAAAAAAAAAAAAAAAAREhkeHx/9oACAEBAAE/IeSiOlCgvAj/2gAMAwEAAgADAAAAEHPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxAAAgEFAAAAAAAAAAAAAAAAAAExEUFhcdH/2gAIAQEAAT8QU1Ykm1opwvPI/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/375ad539d79082459aa6a0d4c21dcc43/c54d4/entry455-11.webp 175w,\n/static/375ad539d79082459aa6a0d4c21dcc43/a3432/entry455-11.webp 350w,\n/static/375ad539d79082459aa6a0d4c21dcc43/426ac/entry455-11.webp 700w,\n/static/375ad539d79082459aa6a0d4c21dcc43/d00b9/entry455-11.webp 800w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/375ad539d79082459aa6a0d4c21dcc43/e52aa/entry455-11.jpg 175w,\n/static/375ad539d79082459aa6a0d4c21dcc43/70ebb/entry455-11.jpg 350w,\n/static/375ad539d79082459aa6a0d4c21dcc43/29d31/entry455-11.jpg 700w,\n/static/375ad539d79082459aa6a0d4c21dcc43/4b190/entry455-11.jpg 800w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/375ad539d79082459aa6a0d4c21dcc43/29d31/entry455-11.jpg\"\n            alt=\"JSONデータが返ってきた！！\"\n            title=\"JSONデータが返ってきた！！\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>データにはGMailなど結構な個人情報も入っています。取扱注意ですね。。。。</p>\n<h2 id=\"実装とコードサンプル\">実装とコードサンプル</h2>\n<p>すんごいダサいですが仕上がりイメージはこんな感じです。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 518px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 116.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAXABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHulgCaKA//xAAXEAEAAwAAAAAAAAAAAAAAAAAQAREg/9oACAEBAAEFAsWQ/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAZEAADAQEBAAAAAAAAAAAAAAAAAREhMRD/2gAIAQEAAT8hTwWcRRNQgpx7/9oADAMBAAIAAwAAABDX2AD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAYEQACAwAAAAAAAAAAAAAAAAAAEBFhgf/aAAgBAgEBPxCbNf8A/8QAHBABAAIDAAMAAAAAAAAAAAAAAQARITFBUWGB/9oACAEBAAE/EHbI7gOG5bww2bVLBNNykydVtgPa+ET1P//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9c0c63909c4af05eccda6689abe069bd/c54d4/entry455-12.webp 175w,\n/static/9c0c63909c4af05eccda6689abe069bd/a3432/entry455-12.webp 350w,\n/static/9c0c63909c4af05eccda6689abe069bd/c29d2/entry455-12.webp 518w\"\n              sizes=\"(max-width: 518px) 100vw, 518px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9c0c63909c4af05eccda6689abe069bd/e52aa/entry455-12.jpg 175w,\n/static/9c0c63909c4af05eccda6689abe069bd/70ebb/entry455-12.jpg 350w,\n/static/9c0c63909c4af05eccda6689abe069bd/bc760/entry455-12.jpg 518w\"\n            sizes=\"(max-width: 518px) 100vw, 518px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9c0c63909c4af05eccda6689abe069bd/bc760/entry455-12.jpg\"\n            alt=\"すんごいダサいですが仕上がりイメージはこんな感じ\"\n            title=\"すんごいダサいですが仕上がりイメージはこんな感じ\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">get_event_deta</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token variable\">$sheet_id</span>    <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'{スプシのID}'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$sheet_order</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'1'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$data</span>        <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"https://spreadsheets.google.com/feeds/list/<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$sheet_id</span><span class=\"token punctuation\">}</span></span>/<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$sheet_order</span><span class=\"token punctuation\">}</span></span>/public/values?alt=json\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$curl</span>        <span class=\"token operator\">=</span> <span class=\"token function\">curl_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$curl</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_URL</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$data</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$curl</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_CUSTOMREQUEST</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'GET'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$curl</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_RETURNTRANSFER</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$curl</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">curl_close</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$curl</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span> <span class=\"token variable\">$json</span><span class=\"token operator\">-></span><span class=\"token property\">errors</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n\t\t<span class=\"token variable\">$json_decode</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$response</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$events</span>      <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$json_decode</span><span class=\"token operator\">-></span><span class=\"token property\">feed</span><span class=\"token operator\">-></span><span class=\"token property\">entry</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$value</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token variable\">$branch</span>         <span class=\"token operator\">=</span> <span class=\"token variable\">$value</span><span class=\"token operator\">-></span><span class=\"token punctuation\">{</span><span class=\"token string single-quoted-string\">'gsx$branch'</span><span class=\"token punctuation\">}</span><span class=\"token operator\">-></span><span class=\"token punctuation\">{</span><span class=\"token string single-quoted-string\">'$t'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$schedule</span>        <span class=\"token operator\">=</span> <span class=\"token function\">explode</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">','</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token operator\">-></span><span class=\"token punctuation\">{</span><span class=\"token string single-quoted-string\">'gsx$detail'</span><span class=\"token punctuation\">}</span><span class=\"token operator\">-></span><span class=\"token punctuation\">{</span><span class=\"token string single-quoted-string\">'$t'</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$events</span><span class=\"token punctuation\">[</span> <span class=\"token variable\">$branch</span> <span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$schedule</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token variable\">$events</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'error'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token variable\">$events</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$events</span>  <span class=\"token operator\">=</span> <span class=\"token function\">get_event_deta</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$lastday</span> <span class=\"token operator\">=</span> <span class=\"token function\">gmdate</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'d'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strtotime</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'last day of this month'</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$c_year</span>  <span class=\"token operator\">=</span> <span class=\"token function\">gmdate</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'Y'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$c_month</span> <span class=\"token operator\">=</span> <span class=\"token function\">gmdate</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'m'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$d</span>       <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'日'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'月'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'火'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'水'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'木'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'金'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'土'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'error'</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$events</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;p class=\"text-center mt-5\">カレンダーの読み込みに失敗しました。&lt;p>'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;table>'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;caption>'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$c_year</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'年'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$month</span> <span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'月&lt;/caption>'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;=</span> <span class=\"token variable\">$lastday</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token variable\">$c_date</span>   <span class=\"token operator\">=</span> <span class=\"token variable\">$c_year</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'-'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$c_month</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'-'</span> <span class=\"token operator\">.</span> <span class=\"token function\">str_pad</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">STR_PAD_LEFT</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$week</span>     <span class=\"token operator\">=</span> <span class=\"token function\">date</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'w'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strtotime</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$c_date</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$bg_color</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token number\">0</span> <span class=\"token operator\">===</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">int</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$week</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token variable\">$bg_color</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">' class=\"bg_sun\"'</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token number\">6</span> <span class=\"token operator\">===</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">int</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$week</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token variable\">$bg_color</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">' class=\"bg_sat\"'</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;tr'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$bg_color</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'>'</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;td>'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'('</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$d</span><span class=\"token punctuation\">[</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">int</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$week</span> <span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">' ) '</span><span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/td>'</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token variable\">$branch</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$events</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$name</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$items</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$items</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$date</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token variable\">$event_date</span> <span class=\"token operator\">=</span> <span class=\"token function\">strtotime</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$date</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$c_date</span> <span class=\"token operator\">===</span> <span class=\"token function\">gmdate</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'Y-m-d'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$event_date</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token variable\">$branch</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;span>'</span> <span class=\"token operator\">.</span> <span class=\"token function\">gmdate</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'H:i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$event_date</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$name</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/span>'</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;td>'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$branch</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/td>'</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;/tr>'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;/table>'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"wordpressに対応したい場合\">WordPressに対応したい場合</h3>\n<p><code class=\"language-text\">get_event_deta()</code>のcurlのところを書き換えます。</p>\n<p><code class=\"language-text\">wp_remote_get()</code>を使わないと怒られますので気をつけてください。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">/**\n * Get event data.\n *\n * @return $events\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">get_event_data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token variable\">$sheet_id</span>    <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'{スプシのID}'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$sheet_order</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'1'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$data</span>        <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"https://spreadsheets.google.com/feeds/list/<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$sheet_id</span><span class=\"token punctuation\">}</span></span>/<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$sheet_order</span><span class=\"token punctuation\">}</span></span>/public/values?alt=json\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$json</span>        <span class=\"token operator\">=</span> <span class=\"token function\">wp_remote_get</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$data</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span> <span class=\"token variable\">$json</span><span class=\"token operator\">-></span><span class=\"token property\">errors</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n\t\t<span class=\"token variable\">$json_decode</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$json</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'body'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t <span class=\"token variable\">$events</span>      <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$json_decode</span><span class=\"token operator\">-></span><span class=\"token property\">feed</span><span class=\"token operator\">-></span><span class=\"token property\">entry</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$value</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token variable\">$school</span>            <span class=\"token operator\">=</span> <span class=\"token variable\">$value</span><span class=\"token operator\">-></span><span class=\"token punctuation\">{</span><span class=\"token string single-quoted-string\">'gsx$branch'</span><span class=\"token punctuation\">}</span><span class=\"token operator\">-></span><span class=\"token punctuation\">{</span><span class=\"token string single-quoted-string\">'$t'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$schedule</span>          <span class=\"token operator\">=</span> <span class=\"token function\">explode</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">','</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token operator\">-></span><span class=\"token punctuation\">{</span><span class=\"token string single-quoted-string\">'gsx$detail'</span><span class=\"token punctuation\">}</span><span class=\"token operator\">-></span><span class=\"token punctuation\">{</span><span class=\"token string single-quoted-string\">'$t'</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t <span class=\"token variable\">$events</span><span class=\"token punctuation\">[</span> <span class=\"token variable\">$branch</span> <span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$schedule</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t\t <span class=\"token variable\">$events</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'error'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">return</span>  <span class=\"token variable\">$events</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">/**\n * Show event schedule\n *\n * @return $table\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">show_event_schedule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token variable\">$events</span>  <span class=\"token operator\">=</span> <span class=\"token function\">get_event_deta</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'error'</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$events</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'&lt;p class=\"text-center mt-5\">カレンダーの読み込みに失敗しました。&lt;p>'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token variable\">$lastday</span> <span class=\"token operator\">=</span> <span class=\"token function\">gmdate</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'d'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strtotime</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'last day of this month'</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$c_year</span>  <span class=\"token operator\">=</span> <span class=\"token function\">gmdate</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'Y'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$c_month</span> <span class=\"token operator\">=</span> <span class=\"token function\">gmdate</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'m'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$d</span>       <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'日'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'月'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'火'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'水'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'木'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'金'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'土'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token variable\">$table</span>  <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'&lt;table>'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$table</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;caption>'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$c_year</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'年'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$month</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'月&lt;/caption>'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;=</span> <span class=\"token variable\">$lastday</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token variable\">$c_date</span>   <span class=\"token operator\">=</span> <span class=\"token variable\">$c_year</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'-'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$c_month</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'-'</span> <span class=\"token operator\">.</span> <span class=\"token function\">str_pad</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">STR_PAD_LEFT</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$week</span>     <span class=\"token operator\">=</span> <span class=\"token function\">gmdate</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'w'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strtotime</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$c_date</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$bg_color</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token number\">0</span> <span class=\"token operator\">===</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">int</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$week</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token variable\">$bg_color</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">' class=\"bg_sun\"'</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token number\">6</span> <span class=\"token operator\">===</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">int</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$week</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token variable\">$bg_color</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">' class=\"bg_sat\"'</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\n\t\t<span class=\"token variable\">$table</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;tr'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$bg_color</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'>'</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$table</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;td>'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'('</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$d</span><span class=\"token punctuation\">[</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">int</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$week</span> <span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">')&lt;/td>'</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$branch</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$events</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$name</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$items</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$items</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$date</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token variable\">$event_date</span> <span class=\"token operator\">=</span> <span class=\"token function\">strtotime</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$date</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token function\">gmdate</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'Y-m-d'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$event_date</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$c_date</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token variable\">$branch</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;span>'</span> <span class=\"token operator\">.</span> <span class=\"token function\">gmdate</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'H:i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$event_date</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$name</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/span>'</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token variable\">$table</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;td>'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$branch</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/td>'</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$table</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;/tr>'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token variable\">$table</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;/table>'</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">return</span> <span class=\"token variable\">$table</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_shortcode</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'show_event_schedule'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'show_event_schedule'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>これで、記事などにもショートコードで貼れます。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">[show_event_schedule]</code></pre></div>\n<p>ちなみにエラーで苦しんだらこちらを参考にしてください。</p>\n<a class=\"article-link\" href=\"/blogs/entry452/\">\n<section><div class=\"article-link__img\"><img alt=\"WordPress phpcsでコーディング規約を守るコード\" src=\"/static/4e7d7db8849ad47fcf44a549cf857b2a/f836f/entry452.jpg\" width=\"150\" height=\"113\" class=\"\"></div><div class=\"article-link__main\">\n<div class=\"article-link__main__title\">WordPress phpcsでコーディング規約を守るコード</div>\n<p class=\"description\">この記事はWordPressコーディング規約をphpcs導入して入れたものの、エラー英語だしよくわかんないって嘆いている人向･･･</p>\n<p>\n<time datetime=\"2021-04-05\">2021.04.05</time>\n</p>\n</div>\n</section></a>\n<h2 id=\"まとめ・スプシをjsonで取得したら気軽にデータをウェブサイトに使える\">まとめ・スプシをJSONで取得したら気軽にデータをウェブサイトに使える</h2>\n<p>今回スプシをJSONデータで取得し、Webサイトに埋め込む方法を紹介しました。</p>\n<p>注意点もあります。</p>\n<p>残念なことに読み込みも多少重いのと何度かに一度読み込みを失敗します。</p>\n<p>あまり精密に使いたい場合はsheet APIとかに変えて、利用しないほうがいいかもです。</p>\n<p>みなさんのコーディングライフの一助となれば幸いです。</p>\n<p>今回も最後までお読みいただきありがとうございました。</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E4%BB%8A%E5%9B%9E%E3%81%93%E3%81%AE%E5%AE%9F%E8%A3%85%E3%82%92%E3%81%97%E3%81%9F%E3%81%8D%E3%81%A3%E3%81%8B%E3%81%91\">今回この実装をしたきっかけ</a></p>\n</li>\n<li>\n<p><a href=\"#%E4%B8%8B%E6%BA%96%E5%82%99%E3%83%BB%E3%82%B9%E3%83%97%E3%82%B7%E5%81%B4%E3%81%AE%E8%A8%AD%E5%AE%9A\">下準備・スプシ側の設定</a></p>\n<ul>\n<li><a href=\"#b%E5%88%97%E3%81%AB%E6%97%A5%E4%BB%98\">B列に日付</a></li>\n<li><a href=\"#c%E3%80%81d%E5%88%97%E3%81%AB%E6%99%82%E9%96%93%E3%82%92%E8%A8%AD%E5%AE%9A\">C、D列に時間を設定</a></li>\n<li><a href=\"#%E3%81%99%E3%81%B9%E3%81%A6%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E4%BD%9C%E6%88%90\">すべてのデータの作成</a></li>\n<li><a href=\"#%E6%8B%85%E5%BD%93%E8%80%85%E3%81%AB%E8%87%AA%E5%88%86%E3%81%AE%E3%82%B7%E3%83%BC%E3%83%88%E3%81%A8%E6%B1%BA%E3%81%BE%E3%81%A3%E3%81%9F%E7%AF%84%E5%9B%B2%E3%81%97%E3%81%8B%E7%B7%A8%E9%9B%86%E3%81%95%E3%81%9B%E3%81%AA%E3%81%84\">担当者に自分のシートと決まった範囲しか編集させない</a></li>\n<li><a href=\"#%E3%82%B9%E3%83%97%E3%82%B7%E3%82%92%E3%82%A6%E3%82%A7%E3%83%96%E5%85%AC%E9%96%8B%E3%81%97%E3%81%A6json%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%82%88%E3%81%86%EF%BC%81\">スプシをウェブ公開してJSONデータを取得しよう！</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E5%AE%9F%E8%A3%85%E3%81%A8%E3%82%B3%E3%83%BC%E3%83%89%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB\">実装とコードサンプル</a></p>\n<ul>\n<li><a href=\"#wordpress%E3%81%AB%E5%AF%BE%E5%BF%9C%E3%81%97%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88\">WordPressに対応したい場合</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81%E3%83%BB%E3%82%B9%E3%83%97%E3%82%B7%E3%82%92json%E3%81%A7%E5%8F%96%E5%BE%97%E3%81%97%E3%81%9F%E3%82%89%E6%B0%97%E8%BB%BD%E3%81%AB%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E3%82%A6%E3%82%A7%E3%83%96%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AB%E4%BD%BF%E3%81%88%E3%82%8B\">まとめ・スプシをJSONで取得したら気軽にデータをウェブサイトに使える</a></p>\n</li>\n</ul>","frontmatter":{"title":"スプシのデータをJSON化してウェブサイトに取り込む（Sheets API使いません）","date":"2021.04.14","description":"最近Googleスプレッドシートにクライアント側でデータを入力してもらい、ウェブサイトに表示する処理をやりました。スプシ側の設定、データの取得方法、PHPの処理方法を記載しておきます。WordPressでの対応方法も紹介しています。スプシでの設定が細かいので不要な方は目次の「スプシをウェブ公開してJSONデータを取得しよう！」から飛ばし読みしてください。","lead":["最近Googleスプレッドシートにクライアント側でデータを入力してもらい、ウェブサイトに表示する処理をやりました。","スプシ側の設定、データの取得方法、PHPの処理方法を記載しておきます。WordPressでの対応方法も紹介しています。","スプシの設定が細かいので不要な方は目次の「スプシをウェブ公開してJSONデータを取得しよう！」から飛ばし読みしてください。"],"hero":"2021/entry455.jpg","cateId":"web-developer","tags":["PHP","JSON","WordPress"],"pagetype":"blog","modifieddate":null}},"previous":{"fields":{"slug":"/blogs/entry454/"},"frontmatter":{"title":"プラグインなしでWordPressのカスタムフィールドを追加&管理画面投稿一覧に出力"}},"next":{"fields":{"slug":"/blogs/entry456/"},"frontmatter":{"title":"使いこなせたら超便利！Twitter検索術まとめ"}}},"pageContext":{"id":"f7836ac6-98fd-560c-9561-4c746d0d3f7d","previousPostId":"3bc12bc3-3ad9-52b0-8e08-324e1cf1c1aa","nextPostId":"d2bdbffc-f209-5ed1-b807-898c49dd6d22","hero":"2021/entry455.jpg"}},"staticQueryHashes":["1145805751","2829560153","3000541721","3766793980"]}