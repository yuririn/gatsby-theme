{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogs/entry291/","result":{"data":{"site":{"siteMetadata":{"title":"銀ねこアトリエ"}},"allFile":{"edges":[{"node":{"name":"entry291","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#d89858","images":{"fallback":{"src":"/static/9769649823f1080aa5f4f726bc78fc72/0fbb2/entry291.png","srcSet":"/static/9769649823f1080aa5f4f726bc78fc72/294f4/entry291.png 375w,\n/static/9769649823f1080aa5f4f726bc78fc72/0fbb2/entry291.png 640w","sizes":"(min-width: 640px) 640px, 100vw"},"sources":[{"srcSet":"/static/9769649823f1080aa5f4f726bc78fc72/fd9fd/entry291.webp 375w,\n/static/9769649823f1080aa5f4f726bc78fc72/66a24/entry291.webp 640w","type":"image/webp","sizes":"(min-width: 640px) 640px, 100vw"}]},"width":640,"height":480}}}}]},"markdownRemark":{"id":"da648550-b86c-5b26-abc8-a73cc21a4d87","excerpt":"CSSスプライトってなんぞ？ CSSスプライトとは、複数のアイコンなどをまとめた画像を一枚で読み込んで好きな部位だけ切り取って利用する CSS…","html":"<h2 id=\"cssスプライトってなんぞ？\">CSSスプライトってなんぞ？</h2>\n<p>CSSスプライトとは、複数のアイコンなどをまとめた画像を一枚で読み込んで好きな部位だけ切り取って利用する CSS の技術です。</p>\n<p>一般的なサーバーでは、画像などのデータファイルは一個ずつ転送されて始めてブラウザに表示されます。</p>\n<p>なのでちまちま一個ずつの画像を作るより、まとめた方がブラウザに表示されるまでが格段に早くなります。</p>\n<p>通常画像ファイルは imgタグで個々に出力しますが、CSSスプライトは CSS で背景としてほしい箇所だけ切り取って表示させます。</p>\n<p>結果サイトは軽くなるし、<strong>複数のアイコンをオリジナルで作るときに向いています</strong>。</p>\n<p>やり方としては以下のようなコード。</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token url\">url</span><span class=\"token punctuation\">(</span>assets/images/common/slice.png<span class=\"token punctuation\">)</span> no-repeat<span class=\"token punctuation\">;</span>\n<span class=\"token property\">background-size</span><span class=\"token punctuation\">:</span> auto 60px<span class=\"token punctuation\">;</span>\n<span class=\"token property\">background-position</span><span class=\"token punctuation\">:</span> 60px 0<span class=\"token punctuation\">;</span>\n<span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #2e683a<span class=\"token punctuation\">;</span>\n<span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 60px<span class=\"token punctuation\">;</span>\n<span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 60px<span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">background-image</code>で背景を設定して、<code class=\"language-text\">background-position</code>で切り取る位置を指定します。</p>\n<p>backgroundはショートハンドで書いてもOKです！<br>\nスマフォやRetina対応も必要なので、<code class=\"language-text\">width</code>や<code class=\"language-text\">height</code>に対しての画像サイズ、<code class=\"language-text\">background-size</code>を縮小してガビらないような気遣いもお忘れなく。</p>\n<h2 id=\"仕様が変わってすぐcssスプライトのアイコンが増える時はscssの変数とミックスインで回避\">仕様が変わってすぐCSSスプライトのアイコンが増える時はSCSSの変数とミックスインで回避</h2>\n<p>制作あるあるだと思いますが、途中デザインや出力項目が変わってアイコンが増えたりします。<br>\nCSSスプライトの面倒なところは、アイコンが増えると他のアイコンの表示のために毎回CSSを書き換えたり設定を変えないといけないところです。</p>\n<p>それはとても面倒なのでSCSSの変数やミックスインで管理するのがオススメ。これはアイコンが正方形の場合の例です。\n縦横アイコンの数を予め変数に入れておく。</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token comment\">// CSSスプライトの設定 ​​​​​​</span>\n<span class=\"token property\"><span class=\"token variable\">$icon-col</span></span><span class=\"token punctuation\">:</span> 3<span class=\"token punctuation\">;</span> <span class=\"token comment\">//横の数</span>\n<span class=\"token property\"><span class=\"token variable\">$icon-row</span></span><span class=\"token punctuation\">:</span> 6<span class=\"token punctuation\">;</span> <span class=\"token comment\">//縦の数</span></code></pre></div>\n<p>表示するアイコンの位置をミックスインで管理すれば、変更に強くなります。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// $url 画像のパス\n// $size 表示したい画像のサイズ\n// $posX 横の位置\n// $posY 縦の位置\n@mixin slice($url, $size, $posX, $posY){\n  $posX: $posX;\n  $posY: $posY;\n  height: $size;\n  width: $size;\n  background: url($url) no-repeat;\n  background-size: $size*$icon-col $size*$icon-row;\n  background-position :#{-$size*$posX} #{-$size*$posY};\n}</code></pre></div>\n<p><code class=\"language-text\">background-position: 0 0;</code>で左端の画像が取れるので1個目の画像を撮りたい場合は以下のようなコードになります。</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token keyword\">@include</span> <span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../images/common/icons.png'</span><span class=\"token punctuation\">,</span> 100px<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"画像は-gulp-で圧縮する\">画像は gulp で圧縮する</h2>\n<p>私は基本、サイトにアップする画像は<code class=\"language-text\">gulp</code>で一気に圧縮しています。<br>\nどんな方法でもいいので画像の圧縮は絶対やった方がいいです。読み込み速度が格段に違いますので！</p>\n<p>gulp インストールしていることが前提です。</p>\n<p>gulp にモジュールをインストールします。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> gulp-imagemin -D</code></pre></div>\n<p>gulpfile.jsに以下コードをよしなに追加するだけです。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// モジュールの呼び出し</span>\n<span class=\"token keyword\">const</span> imagemin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gulp-imagemin'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//開発用ディレクトリ</span>\n<span class=\"token keyword\">const</span> devDir <span class=\"token operator\">=</span> <span class=\"token string\">'dev/'</span>\n<span class=\"token keyword\">const</span> dev <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'imgs'</span><span class=\"token operator\">:</span> devDir <span class=\"token operator\">+</span> <span class=\"token string\">'assets/images'</span>\n<span class=\"token punctuation\">}</span><span class=\"token comment\">//リリース用ディレクトリ</span>\n<span class=\"token keyword\">const</span> destDir <span class=\"token operator\">=</span> <span class=\"token string\">'dest/'</span>\n<span class=\"token keyword\">const</span> dest <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'imgs'</span><span class=\"token operator\">:</span> destDir <span class=\"token operator\">+</span> <span class=\"token string\">'assets/images'</span>\n<span class=\"token punctuation\">}</span><span class=\"token comment\">// 画像の圧縮</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">imageMin</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">done</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  gulp<span class=\"token punctuation\">.</span><span class=\"token function\">src</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>dev<span class=\"token punctuation\">.</span>imgs <span class=\"token operator\">+</span> <span class=\"token string\">'/*.+(jpg|jpeg|png|gif)'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">changed</span><span class=\"token punctuation\">(</span>destDir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">imagemin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>gulp<span class=\"token punctuation\">.</span><span class=\"token function\">dest</span><span class=\"token punctuation\">(</span>dest<span class=\"token punctuation\">.</span>imgs <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">done</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token comment\">// デフォルトタスク</span>\ngulp<span class=\"token punctuation\">.</span><span class=\"token function\">task</span><span class=\"token punctuation\">(</span><span class=\"token string\">'default'</span><span class=\"token punctuation\">,</span>\n  gulp<span class=\"token punctuation\">.</span><span class=\"token function\">series</span><span class=\"token punctuation\">(</span>\n    gulp<span class=\"token punctuation\">.</span><span class=\"token function\">parallel</span><span class=\"token punctuation\">(</span>imageMin<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"まとめ\">まとめ</h2>\n<p>昨今、ウェブサイトはスマフォで閲覧されます。<br>\nなのでどんな環境下でも3秒以内に表示されるような努力がクリエーターには必要ですね。<br>\n小さな努力の積み重ねで表示速度は変わりますし、離脱率の改善に繋がります。</p>\n<p>最後までお読みいただきありがとうございました。</p>","tableOfContents":"<ul>\n<li><a href=\"#css%E3%82%B9%E3%83%97%E3%83%A9%E3%82%A4%E3%83%88%E3%81%A3%E3%81%A6%E3%81%AA%E3%82%93%E3%81%9E%EF%BC%9F\">CSSスプライトってなんぞ？</a></li>\n<li><a href=\"#%E4%BB%95%E6%A7%98%E3%81%8C%E5%A4%89%E3%82%8F%E3%81%A3%E3%81%A6%E3%81%99%E3%81%90css%E3%82%B9%E3%83%97%E3%83%A9%E3%82%A4%E3%83%88%E3%81%AE%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3%E3%81%8C%E5%A2%97%E3%81%88%E3%82%8B%E6%99%82%E3%81%AFscss%E3%81%AE%E5%A4%89%E6%95%B0%E3%81%A8%E3%83%9F%E3%83%83%E3%82%AF%E3%82%B9%E3%82%A4%E3%83%B3%E3%81%A7%E5%9B%9E%E9%81%BF\">仕様が変わってすぐCSSスプライトのアイコンが増える時はSCSSの変数とミックスインで回避</a></li>\n<li><a href=\"#%E7%94%BB%E5%83%8F%E3%81%AF-gulp-%E3%81%A7%E5%9C%A7%E7%B8%AE%E3%81%99%E3%82%8B\">画像は gulp で圧縮する</a></li>\n<li><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>","frontmatter":{"title":"CSSスプライトのコードは Sass の Mixin にとりあえずまとめとけ！","date":"2019.01.17","description":"毎度のことですがウェブサイトが重くなる原因の一つに画像の読み込みが挙げられます。そこでCSSスプライトで gulp と Sass を利用してサイトを減量する方法をメモしておきます。","lead":["毎度のことですがウェブサイトが重くなる原因の一つに画像の読み込みが挙げられます。そこでCSSスプライトで gulp と Sass を利用してサイトを減量する方法をメモしておきます。"],"hero":"2019/entry291.png","cateId":"web-developer","tags":["SCSS","CSS","Gulp"],"pagetype":"blog","modifieddate":null}},"previous":{"fields":{"slug":"/blogs/entry286/"},"frontmatter":{"title":"脱 jQuery！軽量のスクロール JS・MoveTo が便利"}},"next":{"fields":{"slug":"/blogs/entry308/"},"frontmatter":{"title":"さくらレンサバで concrete5 8系を使うなら最新 Ver に Upgrade しとけ！"}}},"pageContext":{"id":"da648550-b86c-5b26-abc8-a73cc21a4d87","previousPostId":"d18a8b5c-a282-51b1-bb38-0c50b2dd7dc8","nextPostId":"ae91547d-a6b5-5a9c-a183-dfb428e93379","hero":"2019/entry291.png"}},"staticQueryHashes":["1145805751","2829560153","3000541721","3766793980"]}