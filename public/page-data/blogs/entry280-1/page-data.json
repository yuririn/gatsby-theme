{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogs/entry280-1/","result":{"data":{"site":{"siteMetadata":{"title":"銀ねこアトリエ"}},"allFile":{"edges":[{"node":{"name":"entry175","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#484848","images":{"fallback":{"src":"/static/3339da9bdeb5980312809995d46c0e88/018b3/entry175.jpg","srcSet":"/static/3339da9bdeb5980312809995d46c0e88/e23da/entry175.jpg 350w,\n/static/3339da9bdeb5980312809995d46c0e88/018b3/entry175.jpg 640w","sizes":"(min-width: 640px) 640px, 100vw"},"sources":[{"srcSet":"/static/3339da9bdeb5980312809995d46c0e88/4c075/entry175.webp 350w,\n/static/3339da9bdeb5980312809995d46c0e88/66a24/entry175.webp 640w","type":"image/webp","sizes":"(min-width: 640px) 640px, 100vw"}]},"width":640,"height":480}}}}]},"markdownRemark":{"id":"d920fa09-9341-5dfe-a883-4714d4b05cb2","excerpt":"concrete5の設定で気をつけること concrete5では、あらかじめphp.iniや.htaccessで文字コードをUTF-8に設定しておくのは必須です。データベースもutf8_general_ci…","html":"<h2 id=\"concrete5の設定で気をつけること\">concrete5の設定で気をつけること</h2>\n<p>concrete5では、あらかじめphp.iniや.htaccessで文字コードをUTF-8に設定しておくのは必須です。データベースもutf8_general_ciで新規作成します。これをしておかないとインストール時にカオスになることも。。。</p>\n<p>レンサバなどで簡単インストールなどが付いている場合はそっちでやったほうが失敗は少ないのでおすすめです。</p>\n<p><a href=\"https://concrete5-japan.org/help/5-6/install/gettingready/\">concrete5インストールまでの準備</a></p>\n<h2 id=\"突然の文字化け\">突然の文字化け</h2>\n<p>今回は、X-serverに実装しているconcrete5サイトが文字化けしてしまいました。それまでは通常通り見れていました。sqlデータ落としてファイル開いてみたけど異常なし。</p>\n<p>X-serverはCGI版でphp.iniを変更することができます。</p>\n<p>サーバー内を確認すると.htaccessとphp.iniが更新されている形跡が。。。エンコードもなぜかEUCになっておりなぜこんなことになったのかが分からず、とりあえずUTF-8に変えて更新。それでも相変わらず文字化けが直らない。</p>\n<p>うちの会社で運用しているサイトではないですが、とても付き合いの長い方のお客様だったので早く解決してあげたいし、原因は分からないし途方に暮れていると、concrete5側でデータベース設定ができることを思い出しました。</p>\n<h2 id=\"concrete5側でデータベースのdriveroptionsを修正\">concrete5側でデータベースのdriverOptionsを修正</h2>\n<p>concrete5にはapplication/config/内にdatabase.phpというファイルがあり、ここにデータベースの設定があります。ここでMySQLを読み込むドライバーのオプション設定を変えることができます。</p>\n<p><a href=\"https://qiita.com/hiro_y/items/6fabdef669e35e92bdc4\">MySQLとPDOの組み合わせでcharsetを指定する</a></p>\n<p>concrete5でのデフォルトのドライバーはPDOが指定されてます。以下のコードを追加します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">'driverOptions' => array(PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES utf8')</code></pre></div>\n<p>MYSQL_ATTR_INIT_COMMANDの文字コードをutf8にセット。場合によってはutf8だけでいい場合も。</p>\n<p>まずはMySQLの文字コードをよく確認してみてください。</p>\n<h2 id=\"とりあえずは一件落着\">とりあえずは一件落着</h2>\n<p>最近、大きなアップデートがあったことで思い当たる節は、WAFに対応？PHPのバージョン?結局、なんで急に文字化けしたのかは分からないです。。。。</p>\n<p>もしみなさんも困った時はやってみてください。</p>","tableOfContents":"<ul>\n<li><a href=\"#concrete5%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%81%A7%E6%B0%97%E3%82%92%E3%81%A4%E3%81%91%E3%82%8B%E3%81%93%E3%81%A8\">concrete5の設定で気をつけること</a></li>\n<li><a href=\"#%E7%AA%81%E7%84%B6%E3%81%AE%E6%96%87%E5%AD%97%E5%8C%96%E3%81%91\">突然の文字化け</a></li>\n<li><a href=\"#concrete5%E5%81%B4%E3%81%A7%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AEdriveroptions%E3%82%92%E4%BF%AE%E6%AD%A3\">concrete5側でデータベースのdriverOptionsを修正</a></li>\n<li><a href=\"#%E3%81%A8%E3%82%8A%E3%81%82%E3%81%88%E3%81%9A%E3%81%AF%E4%B8%80%E4%BB%B6%E8%90%BD%E7%9D%80\">とりあえずは一件落着</a></li>\n</ul>","frontmatter":{"title":"concrete5サイトが突然の文字化け！データベース設定で回避","date":"2018.07.22","description":"突然、昔納品したconcrete5がサイトが文字化けしました。データベースを読み込む際のOption設定で文字化けを回避できるのでそのやり方についてご紹介します","lead":["突然、昔納品したconcrete5がサイトが文字化けしました。データベースを読み込む際のOption設定で文字化けを回避できるのでそのやり方についてご紹介します"],"hero":"2014/entry175.jpg","cateId":"cms","tags":["DB","concrete5"],"pagetype":"blog","modifieddate":null}},"previous":{"fields":{"slug":"/blogs/entry278/"},"frontmatter":{"title":"飼いネコが食中毒！？対処法等の備忘録"}},"next":{"fields":{"slug":"/blogs/entry280/"},"frontmatter":{"title":"初心者コーダーに贈る！超軽量高機能エディターVS Code入門2"}}},"pageContext":{"id":"d920fa09-9341-5dfe-a883-4714d4b05cb2","previousPostId":"67e8a701-ba5d-5f94-bbcf-0e932be7b9fd","nextPostId":"643a9dfa-651b-595d-9024-e4f252f98128","hero":"2014/entry175.jpg"}},"staticQueryHashes":["1145805751","2829560153","3000541721","3766793980"]}