{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogs/entry235/","result":{"data":{"site":{"siteMetadata":{"title":"銀ねこアトリエ"}},"allFile":{"edges":[{"node":{"name":"entry211","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e8b888","images":{"fallback":{"src":"/static/c00a1ad6ac74b4ff881b3a105663bb57/0fbb2/entry211.png","srcSet":"/static/c00a1ad6ac74b4ff881b3a105663bb57/cc1cd/entry211.png 350w,\n/static/c00a1ad6ac74b4ff881b3a105663bb57/0fbb2/entry211.png 640w","sizes":"(min-width: 640px) 640px, 100vw"},"sources":[{"srcSet":"/static/c00a1ad6ac74b4ff881b3a105663bb57/4c075/entry211.webp 350w,\n/static/c00a1ad6ac74b4ff881b3a105663bb57/66a24/entry211.webp 640w","type":"image/webp","sizes":"(min-width: 640px) 640px, 100vw"}]},"width":640,"height":480}}}}]},"markdownRemark":{"id":"1a18dda2-c5e9-5295-b493-50cb114f89d5","excerpt":"functions.phpにリサイズを登録 画像のリサイズをできるようにするためにはまず、アイキャッチを有効にしなければいけません。 functions.phpに以下コードを追記します。 WordPress…","html":"<h2 id=\"functionsphpにリサイズを登録\">functions.phpにリサイズを登録</h2>\n<p>画像のリサイズをできるようにするためにはまず、アイキャッチを有効にしなければいけません。</p>\n<p>functions.phpに以下コードを追記します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">add_theme_support('post-thumbnails');//アイキャッチを有効にする</code></pre></div>\n<p>WordPressでは画像をアップロードしたときに、リサイズした画像を生成できます。</p>\n<h3 id=\"リサイズする画像の登録\">リサイズする画像の登録</h3>\n<p>なので<code class=\"language-text\">add_image_size()</code>でリサイズする画像サイズを登録します。</p>\n<p><code class=\"language-text\">add_image_size( $name, $width, $height, $crop );</code></p>\n<ul>\n<li>$name…新しい画像サイズの名前</li>\n<li>$width…画像の幅（px）</li>\n<li>$height…画像の高さ（px）</li>\n<li>$crop…画像を切り抜くか否か(初期値はfalse)</li>\n</ul>\n<p>ただ、画像サイズ名に予約名があるのでそれ以外で指定します。</p>\n<ul>\n<li>thumb</li>\n<li>thumbnail</li>\n<li>medium</li>\n<li>large</li>\n<li>post-thumbnail</li>\n</ul>\n<p>ということで、「newResizeImage」という名前で画像サイズを作るとするとこんな感じになります。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">get_post_meta($post->ID, 'customImage', true);</code></pre></div>\n<h3 id=\"カスタムフィールドの画像情報を取得\">カスタムフィールドの画像情報を取得</h3>\n<p>出力したいカスタムフィールドの画像情報を取得します。</p>\n<p><code class=\"language-text\">get_post_meta($post_id, $key, $single);</code></p>\n<ul>\n<li>$post_id…カスタムフィールドを取得したい投稿のID</li>\n<li>$key…取得したい値のキー名の文字列。オプションで初期値はnull</li>\n<li>$single…初期値はfalse。falseでカスタムフィールドの配列を返す。true をセットした場合、文字列として単一の結果を返す。</li>\n</ul>\n<p>わざわざ配列にする必要はないのでtrueをセット。\nIDは時と場合によるのでですが、whileなどで回してなりして取得します。今回は割愛します。</p>\n<p>あとは画像を<code class=\"language-text\">wp_get_attachment_image_src()</code>で画像情報を取得します。</p>\n<p>取得できる値は配列で以下のようになってます。</p>\n<ul>\n<li>[0] => url</li>\n<li>[1] => width</li>\n<li>[2] => height</li>\n<li>[3] => 真偽値: リサイズされいている場合は true、元のサイズの場合は false</li>\n</ul>\n<p>なのでパスを取得してimgタグなどに出力したい時は以下のような感じになります。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$imagepath</span> <span class=\"token operator\">=</span> <span class=\"token function\">wp_get_attachment_image_src</span><span class=\"token punctuation\">(</span><span class=\"token function\">get_post_meta</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$post</span><span class=\"token operator\">-></span><span class=\"token constant\">ID</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'photo1'</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'newResizeImage'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;img src=\"'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$imagepath</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'\" width=\"'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$imagepath</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'\" height=\"'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$imagepath</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'\">'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>パスだけ取得できたら、JSなどにも応用できて便利です。</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#functionsphp%E3%81%AB%E3%83%AA%E3%82%B5%E3%82%A4%E3%82%BA%E3%82%92%E7%99%BB%E9%8C%B2\">functions.phpにリサイズを登録</a></p>\n<ul>\n<li><a href=\"#%E3%83%AA%E3%82%B5%E3%82%A4%E3%82%BA%E3%81%99%E3%82%8B%E7%94%BB%E5%83%8F%E3%81%AE%E7%99%BB%E9%8C%B2\">リサイズする画像の登録</a></li>\n<li><a href=\"#%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%A0%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E3%81%AE%E7%94%BB%E5%83%8F%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%96%E5%BE%97\">カスタムフィールドの画像情報を取得</a></li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"WordPressで画像をリサイズする","date":"2015.11.19","description":"WordPressのカスタムフィールドに登録した画像のリサイズの仕方についてメモっておきます。","lead":["WordPressのカスタムフィールドに登録した画像のリサイズの仕方についてメモっておきます。"],"hero":"2014/entry211.png","cateId":"cms","tags":["WordPress"],"pagetype":"blog","modifieddate":null}},"previous":{"fields":{"slug":"/blogs/entry233/"},"frontmatter":{"title":"XAMPP/PHP5.5.27~mySQLの初期パスワード設定"}},"next":{"fields":{"slug":"/blogs/entry236/"},"frontmatter":{"title":"コンクリの外部フォームでお問い合わせフォーム作ったよ"}}},"pageContext":{"id":"1a18dda2-c5e9-5295-b493-50cb114f89d5","previousPostId":"ad0ed4fc-f950-577a-83a5-55ca9359a9ba","nextPostId":"457feb30-4b14-5ff6-a723-cad664634a79","hero":"2014/entry211.png"}},"staticQueryHashes":["1145805751","2829560153","3000541721","3766793980"]}