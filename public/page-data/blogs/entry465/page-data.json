{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogs/entry465/","result":{"data":{"site":{"siteMetadata":{"title":"銀ねこアトリエ"}},"allFile":{"edges":[{"node":{"name":"entry465","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#a8b8b8","images":{"fallback":{"src":"/static/26868c11e76a03d0395793abde2e2026/88c96/entry465.jpg","srcSet":"/static/26868c11e76a03d0395793abde2e2026/15952/entry465.jpg 375w,\n/static/26868c11e76a03d0395793abde2e2026/cd750/entry465.jpg 750w,\n/static/26868c11e76a03d0395793abde2e2026/5caa2/entry465.jpg 1080w,\n/static/26868c11e76a03d0395793abde2e2026/88c96/entry465.jpg 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/26868c11e76a03d0395793abde2e2026/fd9fd/entry465.webp 375w,\n/static/26868c11e76a03d0395793abde2e2026/e56aa/entry465.webp 750w,\n/static/26868c11e76a03d0395793abde2e2026/257a3/entry465.webp 1080w,\n/static/26868c11e76a03d0395793abde2e2026/296b8/entry465.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":900}}}}]},"markdownRemark":{"id":"1e6cfa2a-5b5d-5750-8621-d8715df48495","excerpt":"この記事では基本WordPressのコーディング規約を守ってコードを紹介しています。エスケープ処理なども含め、よくわからない方はこちらの記事も合わせて参考にしてください。 まずはWordPressの管理画面にメニューを作ろう！ メニューの作り方です。 function.php…","html":"<div class=\"msg-baloon\">\n<p><img src=\"/static/ecd737bbd9e6b99fd33fbd308f2b88e8/f836f/camille.jpg\">かみーゆ</p>\n<p>今回は管理画面でサイト共通の設定を追加し、さらに値をajax（jQuery）で保存します！</p>\n</div>\n<p>この記事では基本WordPressのコーディング規約を守ってコードを紹介しています。エスケープ処理なども含め、よくわからない方はこちらの記事も合わせて参考にしてください。</p>\n<a class=\"article-link\" href=\"/blogs/entry452/\">\n<section><div class=\"article-link__img\"><img alt=\"WordPress phpcsでコーディング規約を守るコード\" src=\"/static/4e7d7db8849ad47fcf44a549cf857b2a/2244e/entry452.jpg\" width=\"150\" height=\"113\" class=\"\"></div><div class=\"article-link__main\">\n<div class=\"article-link__main__title\">WordPress phpcsでコーディング規約を守るコード</div>\n<p class=\"description\">この記事はWordPressのコーディング規約をphpcs導入して入れたものの、エラー英語だしよくわかんないって･･･</p>\n<p>\n<time datetime=\"2021-04-058\">2021.04.05</time>\n</p>\n</div>\n</section></a>\n<h2 id=\"まずはwordpressの管理画面にメニューを作ろう！\">まずはWordPressの管理画面にメニューを作ろう！</h2>\n<p>メニューの作り方です。</p>\n<p>function.phpなどに追記するとメニューが追加されます。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">my_admin_menu</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">add_menu_page</span><span class=\"token punctuation\">(</span>\n\t\t<span class=\"token string single-quoted-string\">'My page name'</span><span class=\"token punctuation\">,</span><span class=\"token comment\">//管理画面のページのタイトルタグ</span>\n\t\t<span class=\"token string single-quoted-string\">'My page name'</span><span class=\"token punctuation\">,</span><span class=\"token comment\">//メニューのラベル</span>\n\t\t<span class=\"token string single-quoted-string\">'manage_options'</span><span class=\"token punctuation\">,</span><span class=\"token comment\">//権限。ユーザーレベルは非推奨</span>\n\t\t<span class=\"token string single-quoted-string\">'my_admin_menu'</span><span class=\"token punctuation\">,</span><span class=\"token comment\">//メニューのスラッグ</span>\n\t\t<span class=\"token string single-quoted-string\">'add_my_admin_menu'</span><span class=\"token punctuation\">,</span><span class=\"token comment\">//こいつが重要。メニューページを表示する際に実行される関数</span>\n\t\t<span class=\"token string single-quoted-string\">'dashicons-calendar-alt'</span><span class=\"token punctuation\">,</span><span class=\"token comment\">//メニューアイコン</span>\n\t\t<span class=\"token number\">20</span><span class=\"token comment\">//メニューの位置</span>\n\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'admin_menu'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'my_admin_menu'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>メニューアイコンは自作してもいいですが、WordPressにはあらかじめかなりの数が用意されているのでこちらを使うのが賢いかも。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.75949367088608%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAUBA//EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHur4ktVR//xAAaEAACAgMAAAAAAAAAAAAAAAAAFAECAxBB/9oACAEBAAEFAlMcyjURrrp//8QAFxEBAAMAAAAAAAAAAAAAAAAAAAEREv/aAAgBAwEBPwGmYf/EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/Aar/xAAaEAACAgMAAAAAAAAAAAAAAAAAARIyICGh/9oACAEBAAY/AmpvRZluYf/EABkQAQEBAAMAAAAAAAAAAAAAAAEAETFRwf/aAAgBAQABPyE0QeRk6+UYxh0SQMv/2gAMAwEAAgADAAAAEGD/AP/EABcRAAMBAAAAAAAAAAAAAAAAAAABEfD/2gAIAQMBAT8QnNmKz//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/EKW//8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBYXHR8P/aAAgBAQABPxCJfU6KPncQKdeHuF65nbW4DkcQBQVP/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e7141d3b341c61f910995153ca2458e0/81b7c/entry465-1.webp 158w,\n/static/e7141d3b341c61f910995153ca2458e0/6ea66/entry465-1.webp 315w,\n/static/e7141d3b341c61f910995153ca2458e0/8aab1/entry465-1.webp 630w,\n/static/e7141d3b341c61f910995153ca2458e0/d00b9/entry465-1.webp 800w\"\n              sizes=\"(max-width: 630px) 100vw, 630px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e7141d3b341c61f910995153ca2458e0/ff44c/entry465-1.jpg 158w,\n/static/e7141d3b341c61f910995153ca2458e0/a6688/entry465-1.jpg 315w,\n/static/e7141d3b341c61f910995153ca2458e0/828fb/entry465-1.jpg 630w,\n/static/e7141d3b341c61f910995153ca2458e0/4b190/entry465-1.jpg 800w\"\n            sizes=\"(max-width: 630px) 100vw, 630px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e7141d3b341c61f910995153ca2458e0/828fb/entry465-1.jpg\"\n            alt=\"メニューアイコンDashicons\"\n            title=\"メニューアイコンDashicons\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><a href=\"https://developer.wordpress.org/resource/dashicons/#heading\">Dashicons</a></p>\n<p>もしオリジナルが使いたいときはメニューアイコンを以下のように書き換えます。</p>\n<p>あとはプラグインなど格納されているフォルダーに格納しておけばOKです。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token function\">plugins_url</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'myplugin/images/icon.png'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></code></pre></div>\n<h2 id=\"管理画面で出力するhtmlコードなどを作成\">管理画面で出力するhtmlコードなどを作成</h2>\n<p>次に管理画面用のページを作っていきます。さっき設置した<code class=\"language-text\">add_my_admin_menu</code>（もちろん名前は任意）と関数としてページの内容を書いていきます。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">function add_my_admin_menu() {\n  ?>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>status<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token function\">esc_url</span><span class=\"token punctuation\">(</span> <span class=\"token function\">home_url</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'wp-admin'</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span>/admin.php?page=<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token function\">esc_html</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'my_admin_menu'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>POST<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>saveData<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    ここにコード\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>ページ共通の設定の場合はoptionに登録するのがオススメです。事前の<em>ここにコード</em>の部分へ、サイトごとの値登録に必要なコードを追記します。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>form-table<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">role</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>presentation<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>row<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>th</span><span class=\"token punctuation\">></span></span>サイトの基本情報<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>th</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>my-site-data-1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token function\">esc_html</span><span class=\"token punctuation\">(</span> <span class=\"token function\">get_option</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'my-site-data-1'</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">></span></span>\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token function\">wp_nonce_field</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'verified'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'verified_field'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button-primary<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">data-save</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>saveBtn<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>保存<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>同じWordPress内で共通の値を保村するときはoption系の関数が便利です。</p>\n<table>\n<thead>\n<tr>\n<th>関数名</th>\n<th>用途</th>\n<th>使い方</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><em>get_option</em></td>\n<td>そのサイト（テーマ）の独自の値を取得</td>\n<td><code class=\"language-text\">get_option(キー,値)</code></td>\n</tr>\n<tr>\n<td><em>update_option</em></td>\n<td>そのサイト（テーマ）の独自の値を更新・新規登録</td>\n<td><code class=\"language-text\">update_option(キー,値)</code></td>\n</tr>\n<tr>\n<td><em>delete_option</em></td>\n<td>そのサイト（テーマ）の独自の値を削除</td>\n<td><code class=\"language-text\">update_option(キー)</code></td>\n</tr>\n</tbody>\n</table>\n<p>ここでポイントなのが<code class=\"language-text\">wp_nonce_field</code>で、フォームデータを安全に送るためのWordPressの仕組みです。</p>\n<p>このフォームデータが、同サイトからの送られてきたかチェックしてくれます。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token function\">wp_nonce_field</span><span class=\"token punctuation\">(</span> 【値】<span class=\"token punctuation\">,</span> 【フィールド名】 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span></code></pre></div>\n<p>出力されるhtml。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>input type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span> id<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"【フィールド名】\"</span> name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"【フィールド名】\"</span> value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"xxxxxxxxx\"</span><span class=\"token operator\">></span></code></pre></div>\n<p>データの受け取り側にも処理を書きます。<br>同サイトからの送られてきたかどうかのチェックの仕方は<a href=\"#%E4%BF%9D%E5%AD%98%E5%87%A6%E7%90%86%E3%82%92%E3%81%99%E3%82%8B%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F\">保存処理をするコードを書く</a>の方をみてください。</p>\n<h2 id=\"ajax（jquery）で保存処理\">ajax（jQuery）で保存処理</h2>\n<p>ajax（非同期）で保存するためのコードを書きます。</p>\n<p>CRAD処理（データの登録・保存・更新とか削除）でajax（非同期）を使うと、従来のページ遷移する（リクエストを投げる）よりもユーザーが使い心地をライトに感じます。</p>\n<p>今回は<code class=\"language-text\">my-site-data-1</code>という名前の値を保存してみましょう。</p>\n<p>add_actionのフックはページごとに出し分けができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span>\n\t<span class=\"token string single-quoted-string\">'admin_footer-[ページ名]'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span>関数名<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>今回<code class=\"language-text\">add_my_admin_menu</code>という名前で作ったので[ページ名]のところを変えます。</p>\n<p>ページ名がわからない場合は、var_dumpで調べましょう。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">my_admin_menu</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token variable\">$hook</span> <span class=\"token operator\">=</span> <span class=\"token function\">add_menu_page</span><span class=\"token punctuation\">(</span>\n\t\t<span class=\"token string single-quoted-string\">'My page name'</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token string single-quoted-string\">'My page name'</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token string single-quoted-string\">'manage_options'</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token string single-quoted-string\">'my_admin_menu'</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token string single-quoted-string\">'add_my_admin_menu'</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token string single-quoted-string\">'dashicons-calendar-alt'</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token number\">20</span>\n\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$hook</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'admin_menu'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'my_admin_menu'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><small>※ 調べたらvar_dumpを削除するのを忘れずに。</small></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">add_action(\n\t'admin_footer-toplevel_page_add_my_admin_menulz_count_down_menu_page',\n\tfunction() {\n\t\t?>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n    <span class=\"token function\">jQuery</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ready</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">$</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">//IDsaveDataのフォームのデータを取得する。</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#saveData'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> fd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FormData</span><span class=\"token punctuation\">(</span> <span class=\"token keyword\">this</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        fd<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span> <span class=\"token string\">'action'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'save_data'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n          type<span class=\"token operator\">:</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span>\n          url<span class=\"token operator\">:</span> <span class=\"token string\">\"<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token function\">admin_url</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'admin-ajax.php'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span>\"</span><span class=\"token punctuation\">,</span>\n          dataType<span class=\"token operator\">:</span> <span class=\"token string\">'json'</span><span class=\"token punctuation\">,</span>\n          data<span class=\"token operator\">:</span> fd<span class=\"token punctuation\">,</span>\n          processData<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n          contentType<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">done</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data<span class=\"token punctuation\">,</span> textStatus<span class=\"token punctuation\">,</span> jqXHR</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.status'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;div class=\"notice notice-success is-dismissible\">&lt;p>&lt;strong>設定を保存しました。&lt;/strong>&lt;/p>&lt;button type=\"button\" class=\"notice-dismiss\">&lt;/button>&lt;/div>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fail</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.status'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;div class=\"notice notice-error is-dismissible\">&lt;p>&lt;strong>設定の保存を失敗しました。&lt;/strong>&lt;/p>&lt;button type=\"button\" class=\"notice-dismiss\">&lt;/button>&lt;/div>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'body'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'.status .notice-dismiss'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.status div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p><code class=\"language-text\">$('.status').html~</code>のコードは保存が後成功したか否かをお知らせする処理です。クラスstatusにhtmlを追加します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.126582278481013%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAACABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3KAH/8QAFRABAQAAAAAAAAAAAAAAAAAAARD/2gAIAQEAAQUCL//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABUQAQEAAAAAAAAAAAAAAAAAABAx/9oACAEBAAE/IYf/2gAMAwEAAgADAAAAEPAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGBAAAgMAAAAAAAAAAAAAAAAAAAERMVH/2gAIAQEAAT8QCFg7P//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/454550d97a7b3ccb80674e9f3299b432/81b7c/entry465-2.webp 158w,\n/static/454550d97a7b3ccb80674e9f3299b432/6ea66/entry465-2.webp 315w,\n/static/454550d97a7b3ccb80674e9f3299b432/8aab1/entry465-2.webp 630w,\n/static/454550d97a7b3ccb80674e9f3299b432/d00b9/entry465-2.webp 800w\"\n              sizes=\"(max-width: 630px) 100vw, 630px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/454550d97a7b3ccb80674e9f3299b432/ff44c/entry465-2.jpg 158w,\n/static/454550d97a7b3ccb80674e9f3299b432/a6688/entry465-2.jpg 315w,\n/static/454550d97a7b3ccb80674e9f3299b432/828fb/entry465-2.jpg 630w,\n/static/454550d97a7b3ccb80674e9f3299b432/4b190/entry465-2.jpg 800w\"\n            sizes=\"(max-width: 630px) 100vw, 630px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/454550d97a7b3ccb80674e9f3299b432/828fb/entry465-2.jpg\"\n            alt=\"メニューアイコンDashicons\"\n            title=\"メニューアイコンDashicons\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>追加した要素の削除処理。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'body'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'.status .notice-dismiss'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.status div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>これでWordPressらしい管理画面になりました！</p>\n<h2 id=\"保存処理をするコードを書く\">保存処理をするコードを書く</h2>\n<p>データを受け取って保存処理をします。</p>\n<p>WordPressにはajax用の<code class=\"language-text\">wp_ajax_save_data</code>という便利なフックがあります。</p>\n<p>前のコードで<code class=\"language-text\">fd.append( 'action', 'save_data' );</code>を指定したようにaction名は<code class=\"language-text\">save_data</code>で渡されます。</p>\n<p>同じ<code class=\"language-text\">save_data</code>という名前で関数を作ります。</p>\n<p><code class=\"language-text\">action</code>は必ず投げられる値ですが、保存する必要ないので除外します。</p>\n<p><code class=\"language-text\">wp_nonce_field</code>から、送信元の場所とデータ照合の値も送られてきます。</p>\n<p><code class=\"language-text\">varified_field</code>（データ照合）と<code class=\"language-text\">_wp_http_referer</code>（参照元）も保存する必要ないので項目から除外します。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'wp_ajax_save_data'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'save_data'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">save_data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'verified_field'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span> <span class=\"token function\">wp_verify_nonce</span><span class=\"token punctuation\">(</span> <span class=\"token function\">sanitize_text_field</span><span class=\"token punctuation\">(</span> <span class=\"token function\">wp_unslash</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'verified_field'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'verified'</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'action'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token string single-quoted-string\">'save_data'</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'action'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$_POST</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$key</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$value</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span> <span class=\"token variable\">$key</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'action'</span> <span class=\"token operator\">!==</span> <span class=\"token variable\">$key</span> <span class=\"token operator\">||</span> <span class=\"token string single-quoted-string\">'varified_field'</span> <span class=\"token operator\">!==</span> <span class=\"token variable\">$key</span> <span class=\"token operator\">||</span> <span class=\"token string single-quoted-string\">'_wp_http_referer'</span> <span class=\"token operator\">!==</span> <span class=\"token variable\">$key</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token function\">update_option</span><span class=\"token punctuation\">(</span> <span class=\"token function\">esc_html</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$key</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">esc_html</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$value</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token function\">delete_option</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$key</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token keyword\">echo</span> <span class=\"token function\">wp_json_encode</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'Succsess'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"#%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%81%A7%E5%87%BA%E5%8A%9B%E3%81%99%E3%82%8Bhtml%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AA%E3%81%A9%E3%82%92%E4%BD%9C%E6%88%90\">管理画面で出力するhtmlコードなどを作成</a>で追記したフィールド、<code class=\"language-text\">wp_nonce_field</code>のバリューが正しいか判断します。</p>\n<p>フィールドもなく、値もない場合は処理を終了します。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'verified_field'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span> <span class=\"token function\">wp_verify_nonce</span><span class=\"token punctuation\">(</span> <span class=\"token function\">sanitize_text_field</span><span class=\"token punctuation\">(</span> <span class=\"token function\">wp_unslash</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'verified_field'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'verified'</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"box\">\n<h4>プログラムがうまくいったかは必ずChrome Dev ToolのNetwokを確認しよう</h4>\n保存できたかどうかを確認する前に、ちゃんと思ったデータが送信されているかを確認しましょう。Chromeの開発者ツール（Dev Tool）からNetworkを使えば「post」データとして送信されていることが確認できます。\n</div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.34177215189873%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAcyBAv8A/8QAFxABAAMAAAAAAAAAAAAAAAAAABEhQf/aAAgBAQABBQKmS//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABYQAQEBAAAAAAAAAAAAAAAAAAEAYf/aAAgBAQABPyFdSiYn/9oADAMBAAIAAwAAABB4L//EABURAQEAAAAAAAAAAAAAAAAAAAEA/9oACAEDAQE/EIC//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAMAAwAAAAAAAAAAAAAAAQAhQRExkf/aAAgBAQABPxAnbfSMHDW7ACh9n//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f671e83a1a47757f0157ba582d669901/81b7c/entry465-3.webp 158w,\n/static/f671e83a1a47757f0157ba582d669901/6ea66/entry465-3.webp 315w,\n/static/f671e83a1a47757f0157ba582d669901/8aab1/entry465-3.webp 630w,\n/static/f671e83a1a47757f0157ba582d669901/d00b9/entry465-3.webp 800w\"\n              sizes=\"(max-width: 630px) 100vw, 630px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f671e83a1a47757f0157ba582d669901/ff44c/entry465-3.jpg 158w,\n/static/f671e83a1a47757f0157ba582d669901/a6688/entry465-3.jpg 315w,\n/static/f671e83a1a47757f0157ba582d669901/828fb/entry465-3.jpg 630w,\n/static/f671e83a1a47757f0157ba582d669901/4b190/entry465-3.jpg 800w\"\n            sizes=\"(max-width: 630px) 100vw, 630px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f671e83a1a47757f0157ba582d669901/828fb/entry465-3.jpg\"\n            alt=\"Chromeの開発者ツール（Dev Tool）\"\n            title=\"Chromeの開発者ツール（Dev Tool）\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><small>※レスポンスタブを開くと「Success」が返ってきています。</small>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.58227848101266%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAByIAH/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFRABAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQEAAT8hr//aAAwDAQACAAMAAAAQe+//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAxUf/aAAgBAQABPxBSRWapxdX3f//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/63f3a276bb0b66dfceab83c410c9d99a/81b7c/entry465-4.webp 158w,\n/static/63f3a276bb0b66dfceab83c410c9d99a/6ea66/entry465-4.webp 315w,\n/static/63f3a276bb0b66dfceab83c410c9d99a/8aab1/entry465-4.webp 630w,\n/static/63f3a276bb0b66dfceab83c410c9d99a/d00b9/entry465-4.webp 800w\"\n              sizes=\"(max-width: 630px) 100vw, 630px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/63f3a276bb0b66dfceab83c410c9d99a/ff44c/entry465-4.jpg 158w,\n/static/63f3a276bb0b66dfceab83c410c9d99a/a6688/entry465-4.jpg 315w,\n/static/63f3a276bb0b66dfceab83c410c9d99a/828fb/entry465-4.jpg 630w,\n/static/63f3a276bb0b66dfceab83c410c9d99a/4b190/entry465-4.jpg 800w\"\n            sizes=\"(max-width: 630px) 100vw, 630px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/63f3a276bb0b66dfceab83c410c9d99a/828fb/entry465-4.jpg\"\n            alt=\"Chromeの開発者ツール（Dev Tool）\"\n            title=\"Chromeの開発者ツール（Dev Tool）\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h2 id=\"まとめ・非同期処理だとユーサーもハッピー\">まとめ・非同期処理だとユーサーもハッピー</h2>\n<p>以上ざっくりですが、駆け足で管理画面のカスタマイズ方法、WordPressのもともとある機能のajax非同期処理でサイト全体をお伝えしました。</p>\n<p>書いておかないとすぐ忘れるのを防止する個人的なメモではありますが、皆さんのWoedPressカスタマイズの一助となれば幸いです。</p>\n<p>最後までお読みいただきありがとうございました。</p>","tableOfContents":"<ul>\n<li><a href=\"#%E3%81%BE%E3%81%9A%E3%81%AFwordpress%E3%81%AE%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%81%AB%E3%83%A1%E3%83%8B%E3%83%A5%E3%83%BC%E3%82%92%E4%BD%9C%E3%82%8D%E3%81%86%EF%BC%81\">まずはWordPressの管理画面にメニューを作ろう！</a></li>\n<li><a href=\"#%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2%E3%81%A7%E5%87%BA%E5%8A%9B%E3%81%99%E3%82%8Bhtml%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AA%E3%81%A9%E3%82%92%E4%BD%9C%E6%88%90\">管理画面で出力するhtmlコードなどを作成</a></li>\n<li><a href=\"#ajax%EF%BC%88jquery%EF%BC%89%E3%81%A7%E4%BF%9D%E5%AD%98%E5%87%A6%E7%90%86\">ajax（jQuery）で保存処理</a></li>\n<li><a href=\"#%E4%BF%9D%E5%AD%98%E5%87%A6%E7%90%86%E3%82%92%E3%81%99%E3%82%8B%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F\">保存処理をするコードを書く</a></li>\n<li><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81%E3%83%BB%E9%9D%9E%E5%90%8C%E6%9C%9F%E5%87%A6%E7%90%86%E3%81%A0%E3%81%A8%E3%83%A6%E3%83%BC%E3%82%B5%E3%83%BC%E3%82%82%E3%83%8F%E3%83%83%E3%83%94%E3%83%BC\">まとめ・非同期処理だとユーサーもハッピー</a></li>\n</ul>","frontmatter":{"title":"【WordPress】管理画面に独自メニューを追加して、ajax（非同期）で値を保存する","date":"2021.05.23","description":"WordPressでサイトごとの独自の値を登録できるようにしたいですよね？今回は管理画面のサイドバーにメニューを追加方法し独自の値を登録できるようにするためのページの作成方法を紹介します。登録方法はユーザビリティを考え、ajaxを使いました。よろしければご一読ください。","lead":["WordPressでサイトごとの独自の値を登録できるようにしたいですよね？","今回は管理画面のサイドバーにメニューを追加方法し独自の値を登録できるようにするためのページの作成方法を紹介します。登録方法はユーザビリティを考え、ajaxを使いました。","よろしければご一読ください。"],"hero":"2021/entry465.jpg","cateId":"cms","tags":["WordPress"],"pagetype":"blog","modifieddate":null}},"previous":{"fields":{"slug":"/blogs/entry463/"},"frontmatter":{"title":"カウントダウンタイマーをバニラJSでシンプルに実装"}},"next":{"fields":{"slug":"/blogs/entry466/"},"frontmatter":{"title":"【WordPress】GitHubリポジトリにコミットしたプラグインを自動更新可能にする"}}},"pageContext":{"id":"1e6cfa2a-5b5d-5750-8621-d8715df48495","previousPostId":"12f81e6b-77bc-5be5-b832-72c64363f371","nextPostId":"044f0cb4-98d3-5d4d-a5e6-93c9d22d8a6a","hero":"2021/entry465.jpg"}},"staticQueryHashes":["1145805751","2829560153","3000541721","3766793980"]}