{"data":{"site":{"siteMetadata":{"title":"銀ねこアトリエ"}},"allFile":{"edges":[{"node":{"name":"entry475","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/c54562085bca0c60e7c9a80b7acd3a29/88c96/entry475.jpg","srcSet":"/static/c54562085bca0c60e7c9a80b7acd3a29/15952/entry475.jpg 375w,\n/static/c54562085bca0c60e7c9a80b7acd3a29/cd750/entry475.jpg 750w,\n/static/c54562085bca0c60e7c9a80b7acd3a29/5caa2/entry475.jpg 1080w,\n/static/c54562085bca0c60e7c9a80b7acd3a29/88c96/entry475.jpg 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/c54562085bca0c60e7c9a80b7acd3a29/fd9fd/entry475.webp 375w,\n/static/c54562085bca0c60e7c9a80b7acd3a29/e56aa/entry475.webp 750w,\n/static/c54562085bca0c60e7c9a80b7acd3a29/257a3/entry475.webp 1080w,\n/static/c54562085bca0c60e7c9a80b7acd3a29/296b8/entry475.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":900}}}}]},"markdownRemark":{"id":"77afcb2c-7c11-5ed4-aef9-0606b430b374","excerpt":"はじめに。こんなお悩みがある方へ Googleドライブ内のあの書類どこ行ったけ？ ファイル名の書類が何個もある！どっちだっけ？ ドライブのフォルダー内が汚くてイライラ JavaScriptが分かって、Googleアカウントさえあればこのお悩みを解決できます。 今回はGoogle Apps Script（GAS…","html":"<h2 id=\"はじめに。こんなお悩みがある方へ\">はじめに。こんなお悩みがある方へ</h2>\n<ul>\n<li>Googleドライブ内のあの書類どこ行ったけ？</li>\n<li>ファイル名の書類が何個もある！どっちだっけ？</li>\n<li>ドライブのフォルダー内が汚くてイライラ</li>\n</ul>\n<p><br>JavaScriptが分かって、Googleアカウントさえあればこのお悩みを解決できます。</p>\n<p>今回はGoogle Apps Script（GAS）を使って、請求書など分類としては一緒だけど<strong>命名規則やファイル形式が違う書類を<em>スッキリ整理する方法</em></strong>を具体的に紹介していきます。</p>\n<div class=\"msg-baloon\">\n<p><img src=\"/static/ecd737bbd9e6b99fd33fbd308f2b88e8/f836f/camille.jpg\">かみーゆ</p>\n<p>人間ほど間違えるイキモノっていないよね？<br>だったらルールを決めてしまって、ルール通りにファイルを管理しよう！！</p>\n</div>\n<p>ちなみにフォルダー管理を自動化したい方はこちらの記事を参考に。</p>\n<a class=\"article-link\" href=\"/blogs/entry470/\">\n<section><div class=\"article-link__img\"><img alt=\"Google Apps Script（GAS） でスプシからドライブにフォルダー自動生成\" src=\"/static/250e1864a7205400c846e6381f082a1a/f836f/entry470.jpg\" width=\"150\" height=\"113\" class=\"\"></div><div class=\"article-link__main\">\n<div class=\"article-link__main__title\">Google Apps Script（GAS） でスプシからドライブにフォルダー自動生成</div>\n<p class=\"description\">GASを使ってスプレッドシートからGoogleドライブにフォルダーを自動追加する方法の紹介です･･･</p>\n<p>\n<time datetime=\"2021-06-08\">2021.06.08</time>\n</p>\n</div>\n</section>\n</a>\n<h3 id=\"スプシからファイルをアップロードしてドライブに保存するまでの大まかな作業の流れ\">スプシからファイルをアップロードしてドライブに保存するまでの大まかな作業の流れ</h3>\n<p>ファイルアップロード用のコードを書きます。手順としては以下の流れです。</p>\n<ol>\n<li><em>スプシを準備</em></li>\n<li><em>GASのプロジェクト作成</em></li>\n<li><em>アップロード用のモーダルパーツを作成（UI追加）</em></li>\n<li><em>\bバリデーション・保存するファイルのサイズやタイプを判定</em></li>\n<li>\b<a href=\"/blogs/entry476/\">Googleドライブでファイルを保存しリネーム（次回）</a></li>\n<li>\b<a href=\"/blogs/entry476/\">スプシにファイル情報を書き出す（次回）</a></li>\n<li>\b<a href=\"/blogs/entry476/\">メニュー操作で保存処理を常に実行できるようにする（次回）</a></li>\n</ol>\n<p><small>※ （次回）は次回の記事で紹介します。</small></p>\n<p><br><em>ファイルがフォルダーに格納されるイメージ</em></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">請求書/\n ├ invoice-00001.pdf\n ├ invoice-00002.png\n ├ invoice-00002.jpg\n │   ・・・\n └ invoice-00008.png</code></pre></div>\n<h2 id=\"スプシを準備\">スプシを準備</h2>\n<p>まずは1こ、スプシを準備します。スプシ名は今回<em>請求書管理</em>とかにしておきましょう。</p>\n<p>今回は案件ごとに管理するため、<em>請求書</em>と<em>データ</em>の2つのシートを用意します。</p>\n<h3 id=\"「データ」シートに案件名、顧客名、ステータスを登録しておく\">「データ」シートに案件名、顧客名、ステータスを登録しておく</h3>\n<p>データには「案件名」、「顧客名」、「ステータス」を登録しておきます。</p>\n<p>本来はシートを分けたほうがいいのですが、今回「ファイルをGoogleドライブに保存する方法のご紹介」なので、便宜上まとめています。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 144.30379746835442%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHtt0QAU86EAf/EABkQAQACAwAAAAAAAAAAAAAAABEAEAEgIf/aAAgBAQABBQIh3TFpf//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABUQAQEAAAAAAAAAAAAAAAAAAAEw/9oACAEBAAY/Amn/xAAbEAABBAMAAAAAAAAAAAAAAAABABARISAxof/aAAgBAQABPyHsjRBoMBT6YUt//9oADAMBAAIAAwAAABBwxzz/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAdEAEAAQQDAQAAAAAAAAAAAAABEQAQITFBgZHB/9oACAEBAAE/EBoh0gzp+UrKAZJ3YoOfb6bqCBME0NJjiuq//9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9d9a093ce18c281ef689907d9833cd18/81b7c/entry475-1.webp 158w,\n/static/9d9a093ce18c281ef689907d9833cd18/c85cb/entry475-1.webp 300w\"\n              sizes=\"(max-width: 300px) 100vw, 300px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9d9a093ce18c281ef689907d9833cd18/ff44c/entry475-1.jpg 158w,\n/static/9d9a093ce18c281ef689907d9833cd18/f93b5/entry475-1.jpg 300w\"\n            sizes=\"(max-width: 300px) 100vw, 300px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9d9a093ce18c281ef689907d9833cd18/f93b5/entry475-1.jpg\"\n            alt=\"案件管理のシートに案件名とIDを登録\"\n            title=\"案件管理のシートに案件名とIDを登録\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>C列に以下請求書のステータスを入力しておきます。</p>\n<ul>\n<li>請求書発行済</li>\n<li>請求中</li>\n<li>支払済</li>\n</ul>\n<h3 id=\"「請求書」シートに見出しなど登録\">「請求書」シートに見出しなど登録</h3>\n<p>「請求書」シートをつくり、一行目にid、案件名、顧客名、ステータス、請求日、支払日を見出しとして登録しておきます。</p>\n<p>「データの入力規則」から、データシートのC列（$C$2:$C）の値を条件に設定しておきます。無効なデータの場合に「<em>入力を拒否</em>」にチェックを入れておきます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.291139240506325%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECBAX/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAd1iJFUmf//EABcQAQADAAAAAAAAAAAAAAAAAAEAAyD/2gAIAQEAAQUCyWM//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQMBAT8BV//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABMSD/2gAIAQEABj8Cy5T/xAAaEAADAQADAAAAAAAAAAAAAAAAAREhEDFR/9oACAEBAAE/IXk9LxEdDLxiD//aAAwDAQACAAMAAAAQM/8A/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQMBAT8QS//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/EFf/xAAbEAEAAwEAAwAAAAAAAAAAAAABABExIVGBkf/aAAgBAQABPxAF1/UG8q/MOmVGrINCjWHr0hQ4e5//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2484c1a8180e4ada289159e7db70f074/81b7c/entry475-2.webp 158w,\n/static/2484c1a8180e4ada289159e7db70f074/c85cb/entry475-2.webp 300w\"\n              sizes=\"(max-width: 300px) 100vw, 300px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2484c1a8180e4ada289159e7db70f074/ff44c/entry475-2.jpg 158w,\n/static/2484c1a8180e4ada289159e7db70f074/f93b5/entry475-2.jpg 300w\"\n            sizes=\"(max-width: 300px) 100vw, 300px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2484c1a8180e4ada289159e7db70f074/f93b5/entry475-2.jpg\"\n            alt=\"案件管理のシートに案件名とIDを登録\"\n            title=\"案件管理のシートに案件名とIDを登録\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>これでシートの下準備は完成です！</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 350px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.41772151898735%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe3TSQf/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAVEAEBAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwKL/8QAGBABAAMBAAAAAAAAAAAAAAAAEQABECH/2gAIAQEAAT8hDtR0xojn/9oADAMBAAIAAwAAABDjz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAAICAQUAAAAAAAAAAAAAAAABETFRECFBcZH/2gAIAQEAAT8QcMCuGKx4yPt+i2jdDSI0/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1ecfd0268cc61df40a7f8747a306599d/81b7c/entry475-3.webp 158w,\n/static/1ecfd0268cc61df40a7f8747a306599d/6ea66/entry475-3.webp 315w,\n/static/1ecfd0268cc61df40a7f8747a306599d/a3432/entry475-3.webp 350w\"\n              sizes=\"(max-width: 350px) 100vw, 350px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1ecfd0268cc61df40a7f8747a306599d/ff44c/entry475-3.jpg 158w,\n/static/1ecfd0268cc61df40a7f8747a306599d/a6688/entry475-3.jpg 315w,\n/static/1ecfd0268cc61df40a7f8747a306599d/70ebb/entry475-3.jpg 350w\"\n            sizes=\"(max-width: 350px) 100vw, 350px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1ecfd0268cc61df40a7f8747a306599d/70ebb/entry475-3.jpg\"\n            alt=\"シートの下準備は完成\"\n            title=\"シートの下準備は完成\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h2 id=\"gasのプロジェクト作成\">GASのプロジェクト作成</h2>\n<p>Google Apps Script（GAS）のプロジェクトを作成します。</p>\n<p>先ほど作ったスプシから「メニュー」 > 「ツール」 > 「スクリプトエディタ」を開きます。</p>\n<p>このままだと左上のタイトルが「無題のプロジェクト」なっているので、そこをクリックしてプロジェクト名を管理上変更します。ここでは「請求書作成」としておきます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.69620253164557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEE/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABunHAD//EABgQAQEAAwAAAAAAAAAAAAAAAAIDARIg/9oACAEBAAEFApnZUhgjj//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABESD/2gAIAQEABj8Cg3c//8QAGRABAAIDAAAAAAAAAAAAAAAAAQBBESBR/9oACAEBAAE/IRN3yZKlKdf/2gAMAwEAAgADAAAAENgP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAIDAQAAAAAAAAAAAAAAARExABBBYf/aAAgBAQABPxBHEJcTWQQaIBF4g2Dqfdf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d46ec16eddd169d74facf616dcfc44d5/81b7c/entry475-5.webp 158w,\n/static/d46ec16eddd169d74facf616dcfc44d5/6ea66/entry475-5.webp 315w,\n/static/d46ec16eddd169d74facf616dcfc44d5/7f61c/entry475-5.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d46ec16eddd169d74facf616dcfc44d5/ff44c/entry475-5.jpg 158w,\n/static/d46ec16eddd169d74facf616dcfc44d5/a6688/entry475-5.jpg 315w,\n/static/d46ec16eddd169d74facf616dcfc44d5/066f9/entry475-5.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d46ec16eddd169d74facf616dcfc44d5/066f9/entry475-5.jpg\"\n            alt=\"プロジェクト名を請求書作成に変更\"\n            title=\"プロジェクト名を請求書作成に変更\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h3 id=\"chrome-v8-ランタイムを無効にする（2021年6月現在）\">Chrome V8 ランタイムを無効にする（2021年6月現在）</h3>\n<p>Chrome V8 ランタイムが有効だとファイルがアップロードできません。設定から、チェックを外しておきます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdy0gD//xAAWEAADAAAAAAAAAAAAAAAAAAAAESD/2gAIAQEAAQUCHP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGBABAQADAAAAAAAAAAAAAAAAEQEQICH/2gAIAQEAAT8h4hhK6f/aAAwDAQACAAMAAAAQsM//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgIDAAAAAAAAAAAAAAABABExcRBBUf/aAAgBAQABPxDJ0UxBmjbAFiOpR5K4/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/deff603fb6f3fd1534ad4f8f31864e65/81b7c/entry475-11.webp 158w,\n/static/deff603fb6f3fd1534ad4f8f31864e65/6ea66/entry475-11.webp 315w,\n/static/deff603fb6f3fd1534ad4f8f31864e65/7f61c/entry475-11.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/deff603fb6f3fd1534ad4f8f31864e65/ff44c/entry475-11.jpg 158w,\n/static/deff603fb6f3fd1534ad4f8f31864e65/a6688/entry475-11.jpg 315w,\n/static/deff603fb6f3fd1534ad4f8f31864e65/066f9/entry475-11.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/deff603fb6f3fd1534ad4f8f31864e65/066f9/entry475-11.jpg\"\n            alt=\"Chrome V8 ランタイムが有効のチェックを外しておく\"\n            title=\"Chrome V8 ランタイムが有効のチェックを外しておく\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>ただ、チェックを外すとテンプレートリテラルやletなど新しめのコードが書けなくなります。</p>\n<h2 id=\"アップロード用のモーダルパーツを作成（ui追加）\">アップロード用のモーダルパーツを作成（UI追加）</h2>\n<p>フォームアップロード用のHTMLファイルを追加します。追加の仕方はスクリプトエディタの左のメニュー、「ファイル」から「HTML」を選びます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.278481012658226%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAG8AD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAVEAEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAQABPyGP/9oADAMBAAIAAwAAABADz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABcQAQEBAQAAAAAAAAAAAAAAAAERAFH/2gAIAQEAAT8QZiOr11e7/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b6b19550d164948ffdfa662e73f87bf6/81b7c/entry475-6.webp 158w,\n/static/b6b19550d164948ffdfa662e73f87bf6/6ea66/entry475-6.webp 315w,\n/static/b6b19550d164948ffdfa662e73f87bf6/8aab1/entry475-6.webp 630w,\n/static/b6b19550d164948ffdfa662e73f87bf6/a70f5/entry475-6.webp 945w,\n/static/b6b19550d164948ffdfa662e73f87bf6/e89d6/entry475-6.webp 1155w\"\n              sizes=\"(max-width: 630px) 100vw, 630px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b6b19550d164948ffdfa662e73f87bf6/ff44c/entry475-6.jpg 158w,\n/static/b6b19550d164948ffdfa662e73f87bf6/a6688/entry475-6.jpg 315w,\n/static/b6b19550d164948ffdfa662e73f87bf6/828fb/entry475-6.jpg 630w,\n/static/b6b19550d164948ffdfa662e73f87bf6/0ede0/entry475-6.jpg 945w,\n/static/b6b19550d164948ffdfa662e73f87bf6/86556/entry475-6.jpg 1155w\"\n            sizes=\"(max-width: 630px) 100vw, 630px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b6b19550d164948ffdfa662e73f87bf6/828fb/entry475-6.jpg\"\n            alt=\"フォームアップロード用のHTMLファイルを追加\"\n            title=\"フォームアップロード用のHTMLファイルを追加\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>今回はファイル名を「upload」としておきました。これでUIパーツ用の「upload.html」ファイルができます。</p>\n<p>ファイル作成直後のデフォルトコードはこんな感じ。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>base</span> <span class=\"token attr-name\">target</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>_top<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span>\n</code></pre></div>\n<p>このフォームで入力した日付、案件、ファイルをサーバー側へ送信できるようにします。</p>\n<p>各パーツを表示するためのコードを書きます。</p>\n<p>案件のプルダウン用の部分は、シートからデータを取ってくるので後ほどコードを追加します。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>base</span> <span class=\"token attr-name\">target</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>_top<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://ssl.gstatic.com/docs/script/css/add-ons.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n        発行日：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>date<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>date<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n      プロジェクト名：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>project<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token comment\">&lt;!--項目は後で追加--></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n      ファイル：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>ファイルをアップロードする<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><small>※ ここではinputのtype=dateを使っていますが一部のブラウザで機能しません。Chromeを利用することを前提で進めています。</small></p>\n<p><br>モーダルを表示するため「コード.gs」に以下関数を追加。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">showModal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> output <span class=\"token operator\">=</span> HtmlService<span class=\"token punctuation\">.</span><span class=\"token function\">createTemplateFromFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'upload'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> output<span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>関数名が「showModal」になっているのを確認して実行します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 614px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.911392405063296%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAduQsD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAYEAEBAAMAAAAAAAAAAAAAAAARAQAQYf/aAAgBAQABPyGq4Xmv/9oADAMBAAIAAwAAABCID//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhYf/aAAgBAQABPxAOQMwTQK+OFnXu/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/12faa0a5f39552b109594855f00fc3e6/81b7c/entry475-12.webp 158w,\n/static/12faa0a5f39552b109594855f00fc3e6/6ea66/entry475-12.webp 315w,\n/static/12faa0a5f39552b109594855f00fc3e6/5316f/entry475-12.webp 614w\"\n              sizes=\"(max-width: 614px) 100vw, 614px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/12faa0a5f39552b109594855f00fc3e6/ff44c/entry475-12.jpg 158w,\n/static/12faa0a5f39552b109594855f00fc3e6/a6688/entry475-12.jpg 315w,\n/static/12faa0a5f39552b109594855f00fc3e6/9453e/entry475-12.jpg 614w\"\n            sizes=\"(max-width: 614px) 100vw, 614px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/12faa0a5f39552b109594855f00fc3e6/9453e/entry475-12.jpg\"\n            alt=\"権限\"\n            title=\"権限\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h4 id=\"権限の許可\">権限の許可</h4>\n<p>権限を求められるので、許可します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.9493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAEDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHu0KzJ/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAIRIP/aAAgBAQABBQKlxGP/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAAICFBkf/aAAgBAQAGPwKVrD//xAAbEAEAAgIDAAAAAAAAAAAAAAABABEQIUFR4f/aAAgBAQABPyEXiVwHdRNaq4cjL//aAAwDAQACAAMAAAAQM/8A/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/EK1//8QAFhEBAQEAAAAAAAAAAAAAAAAAABFh/9oACAECAQE/EE1//8QAHRABAAMAAgMBAAAAAAAAAAAAAQARITFBUWFxwf/aAAgBAQABPxAg4W3h1eQTpPpLHhINYT5CMvKmKWXKu59I/Z//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/500ca81d9c3d3ada6e8f8277732c0e26/81b7c/entry475-7.webp 158w,\n/static/500ca81d9c3d3ada6e8f8277732c0e26/c85cb/entry475-7.webp 300w\"\n              sizes=\"(max-width: 300px) 100vw, 300px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/500ca81d9c3d3ada6e8f8277732c0e26/ff44c/entry475-7.jpg 158w,\n/static/500ca81d9c3d3ada6e8f8277732c0e26/f93b5/entry475-7.jpg 300w\"\n            sizes=\"(max-width: 300px) 100vw, 300px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/500ca81d9c3d3ada6e8f8277732c0e26/f93b5/entry475-7.jpg\"\n            alt=\"権限\"\n            title=\"権限\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>左下の「詳細」を押して、「プロジェクト名（安全じゃないページ）に移動」をクリックします。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.78481012658228%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHZsFkE/8QAFxABAAMAAAAAAAAAAAAAAAAAAAESMf/aAAgBAQABBQKyMf/EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/AWf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAYEAEBAAMAAAAAAAAAAAAAAAABABEhwf/aAAgBAQABPyEVsHti/9oADAMBAAIAAwAAABB8D//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/EAE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhAAAgIDAAAAAAAAAAAAAAAAAREAMVGRof/aAAgBAQABPxBKumCCDZDtEydmf//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8cc819ab10ce1c82634a6a1a7b6b1128/81b7c/entry475-8.webp 158w,\n/static/8cc819ab10ce1c82634a6a1a7b6b1128/c85cb/entry475-8.webp 300w\"\n              sizes=\"(max-width: 300px) 100vw, 300px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8cc819ab10ce1c82634a6a1a7b6b1128/ff44c/entry475-8.jpg 158w,\n/static/8cc819ab10ce1c82634a6a1a7b6b1128/f93b5/entry475-8.jpg 300w\"\n            sizes=\"(max-width: 300px) 100vw, 300px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8cc819ab10ce1c82634a6a1a7b6b1128/f93b5/entry475-8.jpg\"\n            alt=\"権限\"\n            title=\"権限\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>あとはアクセスの許可をすればOK。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 160.75949367088606%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAgABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIBAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB9zGpYXmoUgf/xAAaEAACAwEBAAAAAAAAAAAAAAABEQAQIQJB/9oACAEBAAEFAjNr2iY6WlCclj//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAZEAACAwEAAAAAAAAAAAAAAAAAMQERIHH/2gAIAQEABj8CY8rFimOn/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARITFBURD/2gAIAQEAAT8hDd2gJ2hqPhIY6XCZMwA4QbPgAaLUO8B4Kn//2gAMAwEAAgADAAAAELwOjv/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8Qsdn/xAAYEQEAAwEAAAAAAAAAAAAAAAABABARIf/aAAgBAgEBPxBrImcZ/8QAHhABAQEAAgEFAAAAAAAAAAAAAREAITFxQWGBkdH/2gAIAQEAAT8QGgQvUuaUPad4pC1zPI2qOR2P5OVOx8bmgMeHn8yEJesuIE6yVLc5ZSwKvgxM6ZyX1v/Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bb7dda8610f36e441669f660747d3df8/81b7c/entry475-9.webp 158w,\n/static/bb7dda8610f36e441669f660747d3df8/ba381/entry475-9.webp 200w\"\n              sizes=\"(max-width: 200px) 100vw, 200px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bb7dda8610f36e441669f660747d3df8/ff44c/entry475-9.jpg 158w,\n/static/bb7dda8610f36e441669f660747d3df8/e07e9/entry475-9.jpg 200w\"\n            sizes=\"(max-width: 200px) 100vw, 200px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bb7dda8610f36e441669f660747d3df8/e07e9/entry475-9.jpg\"\n            alt=\"権限\"\n            title=\"権限\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>これでスプシ側にファイルアップロード用のフォーム（UI）が表示できるようになりました。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.79746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe9NCKP/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAADAAMAAAAAAAAAAAAAAAAAAREgUXH/2gAIAQEAAT8hi0LhMP/aAAwDAQACAAMAAAAQQw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAADAAIDAAAAAAAAAAAAAAAAAREQIVFhcf/aAAgBAQABPxCTqS+EtzVLqDTjFKf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/85ec3c2752ecbe8a70bf63b69db14cce/81b7c/entry475-10.webp 158w,\n/static/85ec3c2752ecbe8a70bf63b69db14cce/6ea66/entry475-10.webp 315w,\n/static/85ec3c2752ecbe8a70bf63b69db14cce/7f61c/entry475-10.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/85ec3c2752ecbe8a70bf63b69db14cce/ff44c/entry475-10.jpg 158w,\n/static/85ec3c2752ecbe8a70bf63b69db14cce/a6688/entry475-10.jpg 315w,\n/static/85ec3c2752ecbe8a70bf63b69db14cce/066f9/entry475-10.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/85ec3c2752ecbe8a70bf63b69db14cce/066f9/entry475-10.jpg\"\n            alt=\"アップロード用のUI完成\"\n            title=\"アップロード用のUI完成\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h3 id=\"値がgas（サーバー側）で受け取れるかチェック\">値がGAS（サーバー側）で受け取れるかチェック</h3>\n<p>フォームの値がGAS（サーバー側）に送れるかチェックします。</p>\n<p>ボタンのコードを書き換えます。<br>\n<code class=\"language-text\">google.script.run.関数名</code>でGAS側にデータを送信できます。</p>\n<p>ボタンの親タグである<code class=\"language-text\">form</code>タグのデータを送信したいので引数を<code class=\"language-text\">this.parentNode</code>とします。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\">google<span class=\"token punctuation\">.</span>script<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">.</span><span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span> <span class=\"token punctuation\">></span></span>ファイルをアップロードする<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>さらに「コード.js」側にも<code class=\"language-text\">sendForm</code>関数を追加し、データの取得を確認します。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">form</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>関数「showModal」を実行し、スプレットシート側でファイルや日付を入力し、「アップロード」ボタンをクリックします。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.51898734177216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3aAD/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFxABAAMAAAAAAAAAAAAAAAAAAREg4f/aAAgBAQABPyFWct//2gAMAwEAAgADAAAAEHAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGRABAQEBAQEAAAAAAAAAAAAAAQARITFR/9oACAEBAAE/EBcOnw1HTybbSW//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7ffa7d3359ba144b28f7e31619389adc/81b7c/entry475-13.webp 158w,\n/static/7ffa7d3359ba144b28f7e31619389adc/6ea66/entry475-13.webp 315w,\n/static/7ffa7d3359ba144b28f7e31619389adc/7f61c/entry475-13.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7ffa7d3359ba144b28f7e31619389adc/ff44c/entry475-13.jpg 158w,\n/static/7ffa7d3359ba144b28f7e31619389adc/a6688/entry475-13.jpg 315w,\n/static/7ffa7d3359ba144b28f7e31619389adc/066f9/entry475-13.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7ffa7d3359ba144b28f7e31619389adc/066f9/entry475-13.jpg\"\n            alt=\"アップロード用のUI完成\"\n            title=\"アップロード用のUI完成\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>左メニューの「<em>実行数</em>」から最新の関数「sendForm」を確認します。値が取得できていたらOK！</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 450px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.46835443037975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe6rSFj/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAACAgMAAAAAAAAAAAAAAAAAIQERIFFh/9oACAEBAAE/IWXPB6w//9oADAMBAAIAAwAAABBjD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAQADAQEAAAAAAAAAAAAAAAEAETGREP/aAAgBAQABPxAQ4TGjqN3HYZ7/AP/Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1e578d187ce5a581d12943f36dd15f1e/81b7c/entry475-14.webp 158w,\n/static/1e578d187ce5a581d12943f36dd15f1e/6ea66/entry475-14.webp 315w,\n/static/1e578d187ce5a581d12943f36dd15f1e/8626f/entry475-14.webp 450w\"\n              sizes=\"(max-width: 450px) 100vw, 450px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1e578d187ce5a581d12943f36dd15f1e/ff44c/entry475-14.jpg 158w,\n/static/1e578d187ce5a581d12943f36dd15f1e/a6688/entry475-14.jpg 315w,\n/static/1e578d187ce5a581d12943f36dd15f1e/20e5d/entry475-14.jpg 450w\"\n            sizes=\"(max-width: 450px) 100vw, 450px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1e578d187ce5a581d12943f36dd15f1e/20e5d/entry475-14.jpg\"\n            alt=\"entry475 14\"\n            title=\"entry475 14\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h3 id=\"日付のデフォルト値と案件一覧のプルダウンを追加するコードを書く\">日付のデフォルト値と案件一覧のプルダウンを追加するコードを書く</h3>\n<p><code class=\"language-text\">showModal</code>にコードを追記します。</p>\n<p>日付のデフォルト値を追加します。今日にします。値はゼロパティングで<code class=\"language-text\">0000-00-00</code>年は4桁、月と日は2桁になるように調整します。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//省略</span>\n<span class=\"token keyword\">const</span> output <span class=\"token operator\">=</span> HtmlService<span class=\"token punctuation\">.</span><span class=\"token function\">createTemplateFromFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'upload'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//元々あるコード</span>\n<span class=\"token comment\">//省略</span>\n<span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\noutput<span class=\"token punctuation\">.</span>date <span class=\"token operator\">=</span> date<span class=\"token punctuation\">.</span><span class=\"token function\">getFullYear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'-'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getMonth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'-'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span> <span class=\"token operator\">+</span> date<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//省略</span></code></pre></div>\n<p><small>※ JSの月を取得するgetMonthメソッドは0始まりなので1プラスする必要があります。</small></p>\n<p><br>案件名一覧をスプシから取得します。データのA列です。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 144.30379746835442%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHtt0QAU86EAf/EABkQAQACAwAAAAAAAAAAAAAAABEAEAEgIf/aAAgBAQABBQIh3TFpf//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABUQAQEAAAAAAAAAAAAAAAAAAAEw/9oACAEBAAY/Amn/xAAbEAABBAMAAAAAAAAAAAAAAAABABARISAxof/aAAgBAQABPyHsjRBoMBT6YUt//9oADAMBAAIAAwAAABBwxzz/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAdEAEAAQQDAQAAAAAAAAAAAAABEQAQITFBgZHB/9oACAEBAAE/EBoh0gzp+UrKAZJ3YoOfb6bqCBME0NJjiuq//9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9d9a093ce18c281ef689907d9833cd18/81b7c/entry475-1.webp 158w,\n/static/9d9a093ce18c281ef689907d9833cd18/c85cb/entry475-1.webp 300w\"\n              sizes=\"(max-width: 300px) 100vw, 300px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9d9a093ce18c281ef689907d9833cd18/ff44c/entry475-1.jpg 158w,\n/static/9d9a093ce18c281ef689907d9833cd18/f93b5/entry475-1.jpg 300w\"\n            sizes=\"(max-width: 300px) 100vw, 300px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9d9a093ce18c281ef689907d9833cd18/f93b5/entry475-1.jpg\"\n            alt=\"案件管理のシートに案件名とIDを登録\"\n            title=\"案件管理のシートに案件名とIDを登録\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//省略</span>\n<span class=\"token keyword\">const</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//元々あるコード</span>\n<span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'データ'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//省略</span>\n<span class=\"token keyword\">const</span> projectsLastRow <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\noutput<span class=\"token punctuation\">.</span>projects <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> projectsLastRow <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//省略</span></code></pre></div>\n<p>取得したい列の最終行を取得し、一気に<code class=\"language-text\">getValues</code>メソッドでシートのデータを一気に取得します。</p>\n<p><small>※ getValueとgetValuesがあるので間違えないように注意してください。</small></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">シート<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>行の始まり<span class=\"token punctuation\">,</span> 取得したい列<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nシート名<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>取得したい行の先頭<span class=\"token punctuation\">,</span> 取得したい列の先頭<span class=\"token punctuation\">,</span> <span class=\"token function\">行数</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">,</span>列数<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">getValues</code>で取得した値は2次元配列になります。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token constant\">A2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">A3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">A4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>HTML側で値を出力します。<a href=\"/blogs/entry459/\">EJSちっく</a>な書き方です。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n  発行日：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>date<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>date<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>&lt;?= date?><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\nプロジェクト名：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>project<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token prolog\">&lt;?= projects.forEach(function(option) { ?></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>&lt;?= option[0] ?><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token prolog\">&lt;?= option[0] ?></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token prolog\">&lt;? }); ?></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>これでフォーム上でGASから取得した値が表示できるようになりました！！</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.88607594936708%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe7qAg//xAAWEAADAAAAAAAAAAAAAAAAAAAQESD/2gAIAQEAAQUChj//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAYEAEAAwEAAAAAAAAAAAAAAAABABARIf/aAAgBAQABPyFXeUzaLP/aAAwDAQACAAMAAAAQM8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAADAAMBAAAAAAAAAAAAAAAAARExQWGB/9oACAEBAAE/EEoS8SE7p+mRMI6Juz//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/34d84b7fa5566e918bebd698020f081c/81b7c/entry475-15.webp 158w,\n/static/34d84b7fa5566e918bebd698020f081c/6ea66/entry475-15.webp 315w,\n/static/34d84b7fa5566e918bebd698020f081c/7f61c/entry475-15.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/34d84b7fa5566e918bebd698020f081c/ff44c/entry475-15.jpg 158w,\n/static/34d84b7fa5566e918bebd698020f081c/a6688/entry475-15.jpg 315w,\n/static/34d84b7fa5566e918bebd698020f081c/066f9/entry475-15.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/34d84b7fa5566e918bebd698020f081c/066f9/entry475-15.jpg\"\n            alt=\"entry475 15\"\n            title=\"entry475 15\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h2 id=\"バリデーション。保存するファイルのサイズやタイプを制限\">バリデーション。保存するファイルのサイズやタイプを制限</h2>\n<p>なんでもポンポンアップロードされても困るので、ファイルのアップロードできるサイズと種類を制限します。</p>\n<p>合わせて\bファイルがない時もフォーム送信できないようにしておきます。</p>\n<p>今回はHTML側のJSで制御します。</p>\n<h3 id=\"初期状態で送信ボタンを押せないようにしておく\">初期状態で送信ボタンを押せないようにしておく</h3>\n<p>ボタンに<em>name属性</em>と<em>disbled属性</em>を付与します。初期状態では<code class=\"language-text\">disbled=true</code>をセットし、ボタンを押せないようにしておきます。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\">google<span class=\"token punctuation\">.</span>script<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">.</span><span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span> <span class=\"token attr-name\">disabled</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>true</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>send<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>アップロード<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h3 id=\"アップロードファイルに制限をかける\">アップロードファイルに制限をかける</h3>\n<p>ファイルのinputタグに<em>onchange属性</em>と関数<code class=\"language-text\">fileChange</code>を追加します。</p>\n<p>値が変わった時に判定を入れ、処理します。</p>\n<p><code class=\"language-text\">fileChange</code>の詳細は<code class=\"language-text\">script</code>タグ内に記述します。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\nファイル：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onchange</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">fileChange</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n省略\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">function</span> <span class=\"token function\">fileChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pdf'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token operator\">||</span> e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jpeg'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token operator\">||</span> e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'png'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'size'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      e<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">.</span>disabled <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'適切なファイルをアップロードしてください。'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      e<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><code class=\"language-text\">要素.files[0]</code>でファイル情報が取れます。今回は<code class=\"language-text\">type</code>と<code class=\"language-text\">size</code>の値を判定します。</p>\n<h4 id=\"ファイルアップロードの条件\">ファイルアップロードの条件</h4>\n<table>\n<thead>\n<tr>\n<th>種類</th>\n<th>条件</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><em>サイズ</em></td>\n<td>10Mバイト以下（1000000バイト）</td>\n</tr>\n<tr>\n<td><em>タイプ</em></td>\n<td>MIMEタイプが「pdf」、「png」、「jpg」のみ</td>\n</tr>\n</tbody>\n</table>\n<p>それ以外は警告文を出力し、<code class=\"language-text\">value</code>に格納されたファイル情報も削除します。</p>\n<p><br>ボタンの二度押し防止処理を入れます。<code class=\"language-text\">onclick</code>に直書きしていた関数を外に出します。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">sendData</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span> <span class=\"token attr-name\">disabled</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>true</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>send<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>アップロード<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>クリック後<code class=\"language-text\">didabled=true</code>でクリックができない状態にした上で、サーバーにデータ送信します。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sendData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  e<span class=\"token punctuation\">.</span>disabled <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  google<span class=\"token punctuation\">.</span>script<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">.</span><span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"box\">\n<h4>name属性の値と関数名が被らないように気をつける</h4>\nname属性の値と関数名が一緒だと関数が動かないことがあります。関数とname属性が被らないように気をつけましょう。\n</div>\n<h3 id=\"データの取得を確認\">データの取得を確認</h3>\n<p>GAS側（サーバー側）でデータを受け取れたか確認します。</p>\n<p><code class=\"language-text\">sendForm</code>には<code class=\"language-text\">console.log</code>を仕込んだままになっているので、そのまま使います。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">form</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>実行数を確認します。フォームから飛んできた値が取得できましたね！！\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.050632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3QUH/8QAFhAAAwAAAAAAAAAAAAAAAAAAABAR/9oACAEBAAEFAlD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAVEAEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAQABPyGIh//aAAwDAQACAAMAAAAQ8A//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAABBAMAAAAAAAAAAAAAAAARAAEhkUFhcf/aAAgBAQABPxARm0zSJna6Wv/Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e3b45849d73f941ec012a477b1c22596/81b7c/entry476-1.webp 158w,\n/static/e3b45849d73f941ec012a477b1c22596/6ea66/entry476-1.webp 315w,\n/static/e3b45849d73f941ec012a477b1c22596/e88ff/entry476-1.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e3b45849d73f941ec012a477b1c22596/ff44c/entry476-1.jpg 158w,\n/static/e3b45849d73f941ec012a477b1c22596/a6688/entry476-1.jpg 315w,\n/static/e3b45849d73f941ec012a477b1c22596/b4294/entry476-1.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e3b45849d73f941ec012a477b1c22596/b4294/entry476-1.jpg\"\n            alt=\"entry476 1\"\n            title=\"entry476 1\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h2 id=\"ここまでの全ソースはこちら\">ここまでの全ソースはこちら</h2>\n<h3 id=\"gas\">GAS</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/**\n * スプシ側にUI表示\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">showModal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'データ'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> output <span class=\"token operator\">=</span> HtmlService<span class=\"token punctuation\">.</span><span class=\"token function\">createTemplateFromFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'upload'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//カスタマー取得</span>\n  <span class=\"token keyword\">const</span> projectsLastRow <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> projects <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> projectsLastRow<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  output<span class=\"token punctuation\">.</span>projects <span class=\"token operator\">=</span> projects<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//デフォルトの日付</span>\n  <span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  output<span class=\"token punctuation\">.</span>date <span class=\"token operator\">=</span> date<span class=\"token punctuation\">.</span><span class=\"token function\">getFullYear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'-'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getMonth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span> <span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> <span class=\"token string\">'-'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span> <span class=\"token operator\">+</span> date<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> output<span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * スプシのフォームからの値の受け取り\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">form</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"uploadhtml\">upload.html</h3>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>base</span> <span class=\"token attr-name\">target</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>_top<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://ssl.gstatic.com/docs/script/css/add-ons.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n          発行日：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>date<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>date<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>&lt;?= date?><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n        プロジェクト名：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>project<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          <span class=\"token prolog\">&lt;?= projects.forEach(function(option) { ?></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>&lt;?= option[0] ?><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token prolog\">&lt;?= option[0] ?></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token prolog\">&lt;? }); ?></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n        ファイル：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onchange</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">fileChange</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">/></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">sendData</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span> <span class=\"token attr-name\">disabled</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>true</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>send<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>action<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>アップロード<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n      <span class=\"token keyword\">function</span> <span class=\"token function\">fileChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pdf'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token operator\">||</span>e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jpeg'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token operator\">||</span>e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'png'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'size'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">)</span>\n          e<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">.</span>disabled <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'適切なファイルをアップロードしてください。'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          e<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">function</span> <span class=\"token function\">sendData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        e<span class=\"token punctuation\">.</span>disabled <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n        google<span class=\"token punctuation\">.</span>script<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">.</span><span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2 id=\"まとめ・uiを作るところまでは意外とカンタン\">まとめ・UIを作るところまでは意外とカンタン</h2>\n<p>こんな便利な機能をタダで使わせてくれるなんてGoogleは神かと思いますw</p>\n<p>一度作ってしまえば長く使えます！GASで仕事を効率化して、しっかり本業に集中しましょう！！</p>\n<p>続きもありますのでぜひ合わせてお読みいただき、効率化ライフを満喫してください！</p>\n<h3 id=\"続きの記事も合わせてお読みください\">続きの記事も合わせてお読みください</h3>\n<p>次は実際ドライブに保存し、ファイルの詳細を自動でスプシに追記します。</p>\n<a class=\"article-link\" href=\"/blogs/entry476/\">\n<section><div class=\"article-link__img\"><img alt=\"事例で紹介【GAS】スプシからファイルアップロードし、ドライブに保存・保存編\" src=\"/static/b4bf1409820c6b3c49db0802a47b85d1/f836f/entry476.jpg\" width=\"150\" height=\"113\" class=\"\"></div><div class=\"article-link__main\">\n<div class=\"article-link__main__title\">事例で紹介【GAS】スプシからファイルアップロードし、ドライブに保存・保存編</div>\n<p class=\"description\">プログラミングで自動化してヒューマンエラーやルールのブレをを減らしたい！Google Apps Scriptを使ってスプシ（Googleスプレッドシート）から･･･</p>\n<p>\n<time datetime=\"2021-06-24\">2021.06.24</time>\n</p>\n</div>\n</section>\n</a>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB%E3%80%82%E3%81%93%E3%82%93%E3%81%AA%E3%81%8A%E6%82%A9%E3%81%BF%E3%81%8C%E3%81%82%E3%82%8B%E6%96%B9%E3%81%B8\">はじめに。こんなお悩みがある方へ</a></p>\n<ul>\n<li><a href=\"#%E3%82%B9%E3%83%97%E3%82%B7%E3%81%8B%E3%82%89%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89%E3%81%97%E3%81%A6%E3%83%89%E3%83%A9%E3%82%A4%E3%83%96%E3%81%AB%E4%BF%9D%E5%AD%98%E3%81%99%E3%82%8B%E3%81%BE%E3%81%A7%E3%81%AE%E5%A4%A7%E3%81%BE%E3%81%8B%E3%81%AA%E4%BD%9C%E6%A5%AD%E3%81%AE%E6%B5%81%E3%82%8C\">スプシからファイルをアップロードしてドライブに保存するまでの大まかな作業の流れ</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%82%B9%E3%83%97%E3%82%B7%E3%82%92%E6%BA%96%E5%82%99\">スプシを準備</a></p>\n<ul>\n<li><a href=\"#%E3%80%8C%E3%83%87%E3%83%BC%E3%82%BF%E3%80%8D%E3%82%B7%E3%83%BC%E3%83%88%E3%81%AB%E6%A1%88%E4%BB%B6%E5%90%8D%E3%80%81%E9%A1%A7%E5%AE%A2%E5%90%8D%E3%80%81%E3%82%B9%E3%83%86%E3%83%BC%E3%82%BF%E3%82%B9%E3%82%92%E7%99%BB%E9%8C%B2%E3%81%97%E3%81%A6%E3%81%8A%E3%81%8F\">「データ」シートに案件名、顧客名、ステータスを登録しておく</a></li>\n<li><a href=\"#%E3%80%8C%E8%AB%8B%E6%B1%82%E6%9B%B8%E3%80%8D%E3%82%B7%E3%83%BC%E3%83%88%E3%81%AB%E8%A6%8B%E5%87%BA%E3%81%97%E3%81%AA%E3%81%A9%E7%99%BB%E9%8C%B2\">「請求書」シートに見出しなど登録</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#gas%E3%81%AE%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E4%BD%9C%E6%88%90\">GASのプロジェクト作成</a></p>\n<ul>\n<li><a href=\"#chrome-v8-%E3%83%A9%E3%83%B3%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%92%E7%84%A1%E5%8A%B9%E3%81%AB%E3%81%99%E3%82%8B%EF%BC%882021%E5%B9%B46%E6%9C%88%E7%8F%BE%E5%9C%A8%EF%BC%89\">Chrome V8 ランタイムを無効にする（2021年6月現在）</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89%E7%94%A8%E3%81%AE%E3%83%A2%E3%83%BC%E3%83%80%E3%83%AB%E3%83%91%E3%83%BC%E3%83%84%E3%82%92%E4%BD%9C%E6%88%90%EF%BC%88ui%E8%BF%BD%E5%8A%A0%EF%BC%89\">アップロード用のモーダルパーツを作成（UI追加）</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#%E6%A8%A9%E9%99%90%E3%81%AE%E8%A8%B1%E5%8F%AF\">権限の許可</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E5%80%A4%E3%81%8Cgas%EF%BC%88%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E5%81%B4%EF%BC%89%E3%81%A7%E5%8F%97%E3%81%91%E5%8F%96%E3%82%8C%E3%82%8B%E3%81%8B%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF\">値がGAS（サーバー側）で受け取れるかチェック</a></p>\n</li>\n<li>\n<p><a href=\"#%E6%97%A5%E4%BB%98%E3%81%AE%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E5%80%A4%E3%81%A8%E6%A1%88%E4%BB%B6%E4%B8%80%E8%A6%A7%E3%81%AE%E3%83%97%E3%83%AB%E3%83%80%E3%82%A6%E3%83%B3%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F\">日付のデフォルト値と案件一覧のプルダウンを追加するコードを書く</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%83%90%E3%83%AA%E3%83%87%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%80%82%E4%BF%9D%E5%AD%98%E3%81%99%E3%82%8B%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%82%B5%E3%82%A4%E3%82%BA%E3%82%84%E3%82%BF%E3%82%A4%E3%83%97%E3%82%92%E5%88%B6%E9%99%90\">バリデーション。保存するファイルのサイズやタイプを制限</a></p>\n<ul>\n<li>\n<p><a href=\"#%E5%88%9D%E6%9C%9F%E7%8A%B6%E6%85%8B%E3%81%A7%E9%80%81%E4%BF%A1%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%92%E6%8A%BC%E3%81%9B%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%97%E3%81%A6%E3%81%8A%E3%81%8F\">初期状態で送信ボタンを押せないようにしておく</a></p>\n</li>\n<li>\n<p><a href=\"#%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E5%88%B6%E9%99%90%E3%82%92%E3%81%8B%E3%81%91%E3%82%8B\">アップロードファイルに制限をかける</a></p>\n<ul>\n<li><a href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89%E3%81%AE%E6%9D%A1%E4%BB%B6\">ファイルアップロードの条件</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%8F%96%E5%BE%97%E3%82%92%E7%A2%BA%E8%AA%8D\">データの取得を確認</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%81%93%E3%81%93%E3%81%BE%E3%81%A7%E3%81%AE%E5%85%A8%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AF%E3%81%93%E3%81%A1%E3%82%89\">ここまでの全ソースはこちら</a></p>\n<ul>\n<li><a href=\"#gas\">GAS</a></li>\n<li><a href=\"#uploadhtml\">upload.html</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81%E3%83%BBui%E3%82%92%E4%BD%9C%E3%82%8B%E3%81%A8%E3%81%93%E3%82%8D%E3%81%BE%E3%81%A7%E3%81%AF%E6%84%8F%E5%A4%96%E3%81%A8%E3%82%AB%E3%83%B3%E3%82%BF%E3%83%B3\">まとめ・UIを作るところまでは意外とカンタン</a></p>\n<ul>\n<li><a href=\"#%E7%B6%9A%E3%81%8D%E3%81%AE%E8%A8%98%E4%BA%8B%E3%82%82%E5%90%88%E3%82%8F%E3%81%9B%E3%81%A6%E3%81%8A%E8%AA%AD%E3%81%BF%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84\">続きの記事も合わせてお読みください</a></li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"【GAS】スプシからファイルアップロードし、ドライブに保存・UI編","date":"2021.06.24","description":"プログラミングで自動化してヒューマンエラーを減らしたい！Google Apps Scriptを使うとスプシ（Googleスプレッドシート）からドライブへリネームしたファイルを保存したり、保存したファイル情報をスプシに自動で記録しておくことができます。今回は、1.スプシ上にフォーム（UI）を表示、2.スプシの値をフォーム側に出力、3.ファイルのタイプや容量制限するコードを紹介します。","lead":["プログラミングで自動化してヒューマンエラーを減らしたい！","Google Apps Scriptを使うとスプシ（Googleスプレッドシート）からドライブへリネームしたファイルを保存したり、保存したファイル情報をスプシに自動で記録しておくことができます。","今回は、1.スプシ上にフォーム（UI）を表示、2.スプシの値をフォーム側に出力、3.ファイルのタイプや容量制限するコードを紹介します。"],"hero":"2021/entry475.jpg","cateId":"web-developer","tags":["GAS","JavaScript"],"pagetype":"blog","modifieddate":null}},"previous":{"fields":{"slug":"/blogs/entry474/"},"frontmatter":{"title":"【GA4】 Analytics と Google タグマネージャーを連携（画像解説28枚アリ）"}},"next":{"fields":{"slug":"/blogs/entry476/"},"frontmatter":{"title":"【GAS】 スプシにファイルアップロード機能をつけてドライブに保存・保存編"}}},"pageContext":{"id":"77afcb2c-7c11-5ed4-aef9-0606b430b374","previousPostId":"eff6bfb7-0116-58fe-a00c-b4a2472f7d41","nextPostId":"ee30adcb-d44d-57f8-828e-631fc053a236","hero":"2021/entry475.jpg"}}