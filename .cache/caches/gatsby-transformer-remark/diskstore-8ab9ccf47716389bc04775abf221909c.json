{"expireTime":9007200880808505000,"key":"transformer-remark-markdown-html-ast-15cd99f8ce3199d075fdac5187605257-gatsby-remark-imagesgatsby-remark-autolink-headersgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{"id":"そもそも、管理画面側で入力項目を必須にする必要はない"},"children":[{"type":"text","value":"そもそも、管理画面側で入力項目を必須にする必要はない","position":{"start":{"line":1,"column":4,"offset":3},"end":{"line":1,"column":30,"offset":29}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":30,"offset":29}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ウェブ制作でプライバシーポリシーが重要な昨今、プライバシーポリシーへの同意ってめちゃ大事です。\n単純にプライバシーポリシーに同意するという項目にチェックを入れてなかった場合に、送信できないようにしたかったのですが contact form 7 では必須項目でのエラーメッセージは全て一緒です。","position":{"start":{"line":2,"column":1,"offset":30},"end":{"line":3,"column":99,"offset":176}}}],"position":{"start":{"line":2,"column":1,"offset":30},"end":{"line":3,"column":99,"offset":176}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ちょっとユーザーに対して優しくないのでチェックがない場合エラーメッセージを変更しようと考えました。","position":{"start":{"line":5,"column":1,"offset":178},"end":{"line":5,"column":50,"offset":227}}}],"position":{"start":{"line":5,"column":1,"offset":178},"end":{"line":5,"column":50,"offset":227}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ズバリ、最初から管理画面で","position":{"start":{"line":7,"column":1,"offset":229},"end":{"line":7,"column":14,"offset":242}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"必須にせず、エラーメッセージをコントロール","position":{"start":{"line":7,"column":16,"offset":244},"end":{"line":7,"column":37,"offset":265}}}],"position":{"start":{"line":7,"column":14,"offset":242},"end":{"line":7,"column":39,"offset":267}}},{"type":"text","value":"するだけ。","position":{"start":{"line":7,"column":39,"offset":267},"end":{"line":7,"column":44,"offset":272}}}],"position":{"start":{"line":7,"column":1,"offset":229},"end":{"line":7,"column":44,"offset":272}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"fuctions.php に add_filter で wpcf7_validate にフックするコードを書けば OK。","position":{"start":{"line":9,"column":1,"offset":274},"end":{"line":9,"column":61,"offset":334}}}],"position":{"start":{"line":9,"column":1,"offset":274},"end":{"line":9,"column":61,"offset":334}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"以下のコードの例は、checkboxです。","position":{"start":{"line":11,"column":1,"offset":336},"end":{"line":11,"column":22,"offset":357}}}],"position":{"start":{"line":11,"column":1,"offset":336},"end":{"line":11,"column":22,"offset":357}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">// contact form 7 バリデーション追加</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">wpcf7_validate_customize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$tags</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$tags</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$tag</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//タグの種類 input・textareaなど</span>\n        <span class=\"token variable\">$type</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$tag</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// name属性</span>\n        <span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$tag</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$post</span> <span class=\"token operator\">=</span> <span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token function\">strtr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$type</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'checkbox'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span> <span class=\"token operator\">==</span> <span class=\"token string single-quoted-string\">'agreement'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\">// 指定のname属性のバリデーションに任意のメッセージを追加</span>\n                <span class=\"token variable\">$result</span><span class=\"token operator\">-></span><span class=\"token function\">invalidate</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'プライバシーポリシーに同意してください。'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>    <span class=\"token keyword\">return</span> <span class=\"token variable\">$result</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_filter</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'wpcf7_validate'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'wpcf7_validate_customize'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":12,"column":1,"offset":358},"end":{"line":31,"column":4,"offset":984}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"以上です。","position":{"start":{"line":32,"column":1,"offset":985},"end":{"line":32,"column":6,"offset":990}}}],"position":{"start":{"line":32,"column":1,"offset":985},"end":{"line":32,"column":6,"offset":990}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":33,"column":1,"offset":991}}}}