{"expireTime":9007200880805370000,"key":"transformer-remark-markdown-html-ast-e17ef15ad0a96f6a3828cec4a6cb33ba-gatsby-remark-imagesgatsby-remark-autolink-headersgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<custom>","position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":9,"offset":8}}},{"type":"raw","value":"</custom>","position":{"start":{"line":1,"column":9,"offset":8},"end":{"line":1,"column":18,"offset":17}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":18,"offset":17}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"スプシからファイルをアップロードしてドライブに保存するまでざっくり"},"children":[{"type":"text","value":"スプシからファイルをアップロードしてドライブに保存するまでざっくり","position":{"start":{"line":2,"column":4,"offset":21},"end":{"line":2,"column":37,"offset":54}}}],"position":{"start":{"line":2,"column":1,"offset":18},"end":{"line":2,"column":37,"offset":54}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"msg-baloon\">\n<p><img src=\"/static/ecd737bbd9e6b99fd33fbd308f2b88e8/f836f/camille.jpg\">かみーゆ</p>\n<p>この記事は「人のやる作業を減らしたい」、「書類を管理するためにルールを厳格に守りたい」、「個人で会社や仕事を切り盛りしている」方にオススメです。</p>\n</div>","position":{"start":{"line":3,"column":1,"offset":55},"end":{"line":6,"column":7,"offset":248}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"この記事は、","position":{"start":{"line":8,"column":1,"offset":250},"end":{"line":8,"column":7,"offset":256}}},{"type":"element","tagName":"a","properties":{"href":"%22/blogs/entry475/"},"children":[{"type":"text","value":"【GAS】スプシからファイルアップロードし、ドライブに保存する・UI編","position":{"start":{"line":8,"column":8,"offset":257},"end":{"line":8,"column":43,"offset":292}}}],"position":{"start":{"line":8,"column":7,"offset":256},"end":{"line":8,"column":63,"offset":312}}},{"type":"text","value":"の続編です。","position":{"start":{"line":8,"column":63,"offset":312},"end":{"line":8,"column":69,"offset":318}}}],"position":{"start":{"line":8,"column":1,"offset":250},"end":{"line":8,"column":69,"offset":318}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ファイルアップロード用のコードを書きます。手順としては以下の流れです。","position":{"start":{"line":10,"column":1,"offset":320},"end":{"line":10,"column":36,"offset":355}}}],"position":{"start":{"line":10,"column":1,"offset":320},"end":{"line":10,"column":36,"offset":355}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"スプシを準備（済）","position":{"start":{"line":12,"column":4,"offset":360},"end":{"line":12,"column":13,"offset":369}}}],"position":{"start":{"line":12,"column":1,"offset":357},"end":{"line":12,"column":13,"offset":369}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"GASのプロジェクト作成（済）","position":{"start":{"line":13,"column":4,"offset":373},"end":{"line":13,"column":19,"offset":388}}}],"position":{"start":{"line":13,"column":1,"offset":370},"end":{"line":13,"column":19,"offset":388}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"アップロード用のモーダルパーツを作成（UI追加）（済）","position":{"start":{"line":14,"column":4,"offset":392},"end":{"line":14,"column":31,"offset":419}}}],"position":{"start":{"line":14,"column":1,"offset":389},"end":{"line":14,"column":31,"offset":419}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\bバリデーションで保存するファイルのサイズやタイプを判定（済）","position":{"start":{"line":15,"column":4,"offset":423},"end":{"line":15,"column":35,"offset":454}}}],"position":{"start":{"line":15,"column":1,"offset":420},"end":{"line":15,"column":35,"offset":454}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"\bGoogleドライブでファイルを保存しリネーム","position":{"start":{"line":16,"column":5,"offset":459},"end":{"line":16,"column":29,"offset":483}}}],"position":{"start":{"line":16,"column":4,"offset":458},"end":{"line":16,"column":30,"offset":484}}}],"position":{"start":{"line":16,"column":1,"offset":455},"end":{"line":16,"column":30,"offset":484}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\b","position":{"start":{"line":17,"column":4,"offset":488},"end":{"line":17,"column":5,"offset":489}}},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"スプシにファイル情報を書き出す","position":{"start":{"line":17,"column":6,"offset":490},"end":{"line":17,"column":21,"offset":505}}}],"position":{"start":{"line":17,"column":5,"offset":489},"end":{"line":17,"column":22,"offset":506}}}],"position":{"start":{"line":17,"column":1,"offset":485},"end":{"line":17,"column":22,"offset":506}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\b","position":{"start":{"line":18,"column":4,"offset":510},"end":{"line":18,"column":5,"offset":511}}},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"メニュー操作で保存処理を常に実行できるようにする","position":{"start":{"line":18,"column":6,"offset":512},"end":{"line":18,"column":30,"offset":536}}}],"position":{"start":{"line":18,"column":5,"offset":511},"end":{"line":18,"column":31,"offset":537}}}],"position":{"start":{"line":18,"column":1,"offset":507},"end":{"line":18,"column":31,"offset":537}}},{"type":"text","value":"\n"}],"position":{"start":{"line":12,"column":1,"offset":357},"end":{"line":18,"column":31,"offset":537}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<small>","position":{"start":{"line":21,"column":1,"offset":540},"end":{"line":21,"column":8,"offset":547}}},{"type":"text","value":"※ （済）は前回の記事で紹介しています。","position":{"start":{"line":21,"column":8,"offset":547},"end":{"line":21,"column":28,"offset":567}}},{"type":"raw","value":"</small>","position":{"start":{"line":21,"column":28,"offset":567},"end":{"line":21,"column":36,"offset":575}}}],"position":{"start":{"line":21,"column":1,"offset":540},"end":{"line":21,"column":36,"offset":575}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"1 ~ 4を確認したい方は前回の記事をお読みください。","position":{"start":{"line":23,"column":1,"offset":577},"end":{"line":23,"column":28,"offset":604}}}],"position":{"start":{"line":23,"column":1,"offset":577},"end":{"line":23,"column":28,"offset":604}}},{"type":"text","value":"\n"},{"type":"raw","value":"<a class=\"article-link\" href=\"/blogs/entry475/\">\n<section><div class=\"article-link__img\"><img alt=\"【GAS】スプシからファイルアップロードし、ドライブに保存・UI編\" src=\"/static/c54562085bca0c60e7c9a80b7acd3a29/f836f/entry475.jpg\" width=\"150\" height=\"113\" class=\"\"></div><div class=\"article-link__main\">\n<div class=\"article-link__main__title\">【GAS】スプシからファイルアップロードし、ドライブに保存する・UI編</div>\n<p class=\"description\">プログラミングで自動化してヒューマンエラーやルールのブレをを減らしたい！Google Apps Scriptを使ってスプシ（Googleスプレッドシート）から･･･</p>\n<p>\n<time datetime=\"2021-06-24\">2021.06.24</time>\n</p>\n</div>\n</section>\n</a>","position":{"start":{"line":25,"column":1,"offset":606},"end":{"line":34,"column":5,"offset":1147}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"請求書の整理を例にとって進めていきます。","position":{"start":{"line":36,"column":1,"offset":1149},"end":{"line":36,"column":21,"offset":1169}}}],"position":{"start":{"line":36,"column":1,"offset":1149},"end":{"line":36,"column":21,"offset":1169}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<br>","position":{"start":{"line":38,"column":1,"offset":1171},"end":{"line":38,"column":5,"offset":1175}}},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"ファイルがフォルダーに格納されるイメージ","position":{"start":{"line":38,"column":6,"offset":1176},"end":{"line":38,"column":26,"offset":1196}}}],"position":{"start":{"line":38,"column":5,"offset":1175},"end":{"line":38,"column":27,"offset":1197}}}],"position":{"start":{"line":38,"column":1,"offset":1171},"end":{"line":38,"column":27,"offset":1197}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">請求書/\n ├ invoice-00001.pdf\n ├ invoice-00002.png\n ├ invoice-00002.jpg\n │   ・・・\n └ invoice-00008.png</code></pre></div>","position":{"start":{"line":39,"column":1,"offset":1198},"end":{"line":46,"column":4,"offset":1303}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"googleドライブにファイルを格納する"},"children":[{"type":"text","value":"Googleドライブにファイルを格納する","position":{"start":{"line":49,"column":4,"offset":1309},"end":{"line":49,"column":24,"offset":1329}}}],"position":{"start":{"line":49,"column":1,"offset":1306},"end":{"line":49,"column":24,"offset":1329}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ファイルを格納するフォルダーを作ってコードを書いていきましょ！","position":{"start":{"line":50,"column":1,"offset":1330},"end":{"line":50,"column":32,"offset":1361}}}],"position":{"start":{"line":50,"column":1,"offset":1330},"end":{"line":50,"column":32,"offset":1361}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"請求書を格納するフォルダーを作る"},"children":[{"type":"text","value":"請求書を格納するフォルダーを作る","position":{"start":{"line":52,"column":5,"offset":1367},"end":{"line":52,"column":21,"offset":1383}}}],"position":{"start":{"line":52,"column":1,"offset":1363},"end":{"line":52,"column":21,"offset":1383}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"請求書を格納するためのフォルダーをGoogleドライブ上に作成します。","position":{"start":{"line":53,"column":1,"offset":1384},"end":{"line":53,"column":36,"offset":1419}}}],"position":{"start":{"line":53,"column":1,"offset":1384},"end":{"line":53,"column":36,"offset":1419}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"今回はフォルダー名を","position":{"start":{"line":55,"column":1,"offset":1421},"end":{"line":55,"column":11,"offset":1431}}},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"請求書","position":{"start":{"line":55,"column":12,"offset":1432},"end":{"line":55,"column":15,"offset":1435}}}],"position":{"start":{"line":55,"column":11,"offset":1431},"end":{"line":55,"column":16,"offset":1436}}},{"type":"text","value":"としました。IDをメモっておきます。URLのfolders/以降がIDです。","position":{"start":{"line":55,"column":16,"offset":1436},"end":{"line":55,"column":54,"offset":1474}}}],"position":{"start":{"line":55,"column":1,"offset":1421},"end":{"line":55,"column":54,"offset":1474}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">https://drive.google.com/drive/u/0/folders/【ID】</code>","position":{"start":{"line":57,"column":1,"offset":1476},"end":{"line":57,"column":50,"offset":1525}}}],"position":{"start":{"line":57,"column":1,"offset":1476},"end":{"line":57,"column":50,"offset":1525}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.69620253164557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHciwEHD//EABgQAAMBAQAAAAAAAAAAAAAAAAACEgEg/9oACAEBAAEFAoUlcJXj/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEyIP/aAAgBAQAGPwKUSiVj/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAEQwREx8f/aAAgBAQABPyFYKBrUnMh6j//aAAwDAQACAAMAAAAQIM//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgIDAAAAAAAAAAAAAAABABEQIXGRof/aAAgBAQABPxBIvpy2IHGDF+PBHYgUan//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e1866b7bf83bd645b065ac062cda7559/81b7c/entry475-4.webp 158w,\n/static/e1866b7bf83bd645b065ac062cda7559/6ea66/entry475-4.webp 315w,\n/static/e1866b7bf83bd645b065ac062cda7559/e88ff/entry475-4.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e1866b7bf83bd645b065ac062cda7559/ff44c/entry475-4.jpg 158w,\n/static/e1866b7bf83bd645b065ac062cda7559/a6688/entry475-4.jpg 315w,\n/static/e1866b7bf83bd645b065ac062cda7559/b4294/entry475-4.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e1866b7bf83bd645b065ac062cda7559/b4294/entry475-4.jpg\"\n            alt=\"folders/以降がID\"\n            title=\"folders/以降がID\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>","position":{"start":{"line":59,"column":1,"offset":1527},"end":{"line":59,"column":50,"offset":1576}}}],"position":{"start":{"line":59,"column":1,"offset":1527},"end":{"line":59,"column":50,"offset":1576}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"ファイルを格納するコード"},"children":[{"type":"text","value":"ファイルを格納するコード","position":{"start":{"line":61,"column":5,"offset":1582},"end":{"line":61,"column":17,"offset":1594}}}],"position":{"start":{"line":61,"column":1,"offset":1578},"end":{"line":61,"column":17,"offset":1594}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"/blogs/entry470/"},"children":[{"type":"text","value":"【GAS】スプシからファイルアップロードし、ドライブに保存する・UI編","position":{"start":{"line":62,"column":2,"offset":1596},"end":{"line":62,"column":37,"offset":1631}}}],"position":{"start":{"line":62,"column":1,"offset":1595},"end":{"line":62,"column":56,"offset":1650}}},{"type":"text","value":"で作った関数","position":{"start":{"line":62,"column":56,"offset":1650},"end":{"line":62,"column":62,"offset":1656}}},{"type":"raw","value":"<code class=\"language-text\">sendForm</code>","position":{"start":{"line":62,"column":62,"offset":1656},"end":{"line":62,"column":72,"offset":1666}}},{"type":"text","value":"を書き換えます。ファイルを取得し、フォルダーに格納するまでのコードです。","position":{"start":{"line":62,"column":72,"offset":1666},"end":{"line":62,"column":108,"offset":1702}}}],"position":{"start":{"line":62,"column":1,"offset":1595},"end":{"line":62,"column":108,"offset":1702}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">form</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> folder <span class=\"token operator\">=</span> DriveApp<span class=\"token punctuation\">.</span><span class=\"token function\">getFolderById</span><span class=\"token punctuation\">(</span>【フォルダー<span class=\"token constant\">ID</span>】<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> doc <span class=\"token operator\">=</span> folder<span class=\"token punctuation\">.</span><span class=\"token function\">createFile</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":63,"column":1,"offset":1703},"end":{"line":72,"column":4,"offset":1877}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"ファイルをリネームする"},"children":[{"type":"text","value":"ファイルをリネームする","position":{"start":{"line":74,"column":5,"offset":1883},"end":{"line":74,"column":16,"offset":1894}}}],"position":{"start":{"line":74,"column":1,"offset":1879},"end":{"line":74,"column":16,"offset":1894}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ファイルを管理用のIDでリネームします。","position":{"start":{"line":75,"column":1,"offset":1895},"end":{"line":75,"column":21,"offset":1915}}}],"position":{"start":{"line":75,"column":1,"offset":1895},"end":{"line":75,"column":21,"offset":1915}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"今回は請求書なので","position":{"start":{"line":77,"column":1,"offset":1917},"end":{"line":77,"column":10,"offset":1926}}},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"invoice + -（ハイフン） + 五桁の数字","position":{"start":{"line":77,"column":11,"offset":1927},"end":{"line":77,"column":36,"offset":1952}}}],"position":{"start":{"line":77,"column":10,"offset":1926},"end":{"line":77,"column":37,"offset":1953}}},{"type":"text","value":"としました。","position":{"start":{"line":77,"column":37,"offset":1953},"end":{"line":77,"column":43,"offset":1959}}}],"position":{"start":{"line":77,"column":1,"offset":1917},"end":{"line":77,"column":43,"offset":1959}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">invoice-00001</code></pre></div>","position":{"start":{"line":79,"column":1,"offset":1961},"end":{"line":81,"column":4,"offset":1982}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ID生成のコードはこちらです。スプシに登録された請求書数からIDを作っていきます。","position":{"start":{"line":83,"column":1,"offset":1984},"end":{"line":83,"column":42,"offset":2025}}}],"position":{"start":{"line":83,"column":1,"offset":1984},"end":{"line":83,"column":42,"offset":2025}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token keyword\">const</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> accounting <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'請求書'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> num <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> fileName <span class=\"token operator\">=</span> <span class=\"token string\">'invoice-'</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0000\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":85,"column":1,"offset":2027},"end":{"line":90,"column":4,"offset":2361}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()</code>","position":{"start":{"line":91,"column":1,"offset":2362},"end":{"line":91,"column":58,"offset":2419}}},{"type":"text","value":"は2行以上連続でセルに値がないと取得できません。","position":{"start":{"line":91,"column":58,"offset":2419},"end":{"line":91,"column":82,"offset":2443}}}],"position":{"start":{"line":91,"column":1,"offset":2362},"end":{"line":91,"column":82,"offset":2443}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ファイルが未格納の場合は","position":{"start":{"line":93,"column":1,"offset":2445},"end":{"line":93,"column":13,"offset":2457}}},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"1","position":{"start":{"line":93,"column":14,"offset":2458},"end":{"line":93,"column":15,"offset":2459}}}],"position":{"start":{"line":93,"column":13,"offset":2457},"end":{"line":93,"column":16,"offset":2460}}},{"type":"text","value":"にしておきます。","position":{"start":{"line":93,"column":16,"offset":2460},"end":{"line":93,"column":24,"offset":2468}}}],"position":{"start":{"line":93,"column":1,"offset":2445},"end":{"line":93,"column":24,"offset":2468}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">(</span>accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":94,"column":1,"offset":2469},"end":{"line":96,"column":4,"offset":2612}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"生成したIDでリネームします。","position":{"start":{"line":97,"column":1,"offset":2613},"end":{"line":97,"column":16,"offset":2628}}}],"position":{"start":{"line":97,"column":1,"offset":2613},"end":{"line":97,"column":16,"offset":2628}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">setName</code>","position":{"start":{"line":99,"column":1,"offset":2630},"end":{"line":99,"column":10,"offset":2639}}},{"type":"text","value":"でファイル名を変更できます。保存が終了したら","position":{"start":{"line":99,"column":10,"offset":2639},"end":{"line":99,"column":32,"offset":2661}}},{"type":"raw","value":"<code class=\"language-text\">Browser.msgBox</code>","position":{"start":{"line":99,"column":32,"offset":2661},"end":{"line":99,"column":48,"offset":2677}}},{"type":"text","value":"を使ってメッセージボックスを表示します。","position":{"start":{"line":99,"column":48,"offset":2677},"end":{"line":99,"column":68,"offset":2697}}}],"position":{"start":{"line":99,"column":1,"offset":2630},"end":{"line":99,"column":68,"offset":2697}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">form</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> folder <span class=\"token operator\">=</span> DriveApp<span class=\"token punctuation\">.</span><span class=\"token function\">getFolderById</span><span class=\"token punctuation\">(</span>【フォルダー<span class=\"token constant\">ID</span>】<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> accounting <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'請求書'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> num <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> fileName <span class=\"token operator\">=</span> <span class=\"token string\">'invoice-'</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0000\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> doc <span class=\"token operator\">=</span> folder<span class=\"token punctuation\">.</span><span class=\"token function\">createFile</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    doc<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Browser<span class=\"token punctuation\">.</span><span class=\"token function\">msgBox</span><span class=\"token punctuation\">(</span><span class=\"token string\">'新しい請求書「'</span> <span class=\"token operator\">+</span> fileName <span class=\"token operator\">+</span> <span class=\"token string\">\"」を保存しました\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":100,"column":1,"offset":2698},"end":{"line":115,"column":4,"offset":3283}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"実行すると権限を求められるので許可します。許可の仕方が分からない方は前回の記事","position":{"start":{"line":117,"column":1,"offset":3285},"end":{"line":117,"column":40,"offset":3324}}},{"type":"element","tagName":"a","properties":{"href":"/blogs/entry475/#%E6%A8%A9%E9%99%90%E3%81%AE%E8%A8%B1%E5%8F%AF"},"children":[{"type":"text","value":"権限の許可","position":{"start":{"line":117,"column":41,"offset":3325},"end":{"line":117,"column":46,"offset":3330}}}],"position":{"start":{"line":117,"column":40,"offset":3324},"end":{"line":117,"column":71,"offset":3355}}},{"type":"text","value":"を参考にしてください。","position":{"start":{"line":117,"column":71,"offset":3355},"end":{"line":117,"column":82,"offset":3366}}}],"position":{"start":{"line":117,"column":1,"offset":3285},"end":{"line":117,"column":82,"offset":3366}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"処理が終わると","position":{"start":{"line":119,"column":1,"offset":3368},"end":{"line":119,"column":8,"offset":3375}}},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"新しい請求書「invoice-xxxxx」を保存しました","position":{"start":{"line":119,"column":9,"offset":3376},"end":{"line":119,"column":37,"offset":3404}}}],"position":{"start":{"line":119,"column":8,"offset":3375},"end":{"line":119,"column":38,"offset":3405}}},{"type":"text","value":"と表示されます。","position":{"start":{"line":119,"column":38,"offset":3405},"end":{"line":119,"column":46,"offset":3413}}}],"position":{"start":{"line":119,"column":1,"offset":3368},"end":{"line":119,"column":46,"offset":3413}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.79746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF1vJkWAf/EABsQAAEEAwAAAAAAAAAAAAAAAAEAAgMQBBIU/9oACAEBAAEFAseJsi5mUCVsa//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAEFAQAAAAAAAAAAAAAAAAABEBExQZH/2gAIAQEABj8CWcN61lq3/8QAGxABAAICAwAAAAAAAAAAAAAAAQAxECFRceH/2gAIAQEAAT8hA30pjx4gUjpj62P/2gAMAwEAAgADAAAAEEAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAIDAQAAAAAAAAAAAAAAAQARECExwf/aAAgBAQABPxBHLUDR25RcCx3fbCUffj//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a794e9eee35d121f52fd9bdb95a65ab7/81b7c/entry476-2.webp 158w,\n/static/a794e9eee35d121f52fd9bdb95a65ab7/6ea66/entry476-2.webp 315w,\n/static/a794e9eee35d121f52fd9bdb95a65ab7/7f61c/entry476-2.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a794e9eee35d121f52fd9bdb95a65ab7/ff44c/entry476-2.jpg 158w,\n/static/a794e9eee35d121f52fd9bdb95a65ab7/a6688/entry476-2.jpg 315w,\n/static/a794e9eee35d121f52fd9bdb95a65ab7/066f9/entry476-2.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a794e9eee35d121f52fd9bdb95a65ab7/066f9/entry476-2.jpg\"\n            alt=\"実行結果\"\n            title=\"実行結果\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>","position":{"start":{"line":121,"column":1,"offset":3415},"end":{"line":121,"column":41,"offset":3455}}}],"position":{"start":{"line":121,"column":1,"offset":3415},"end":{"line":121,"column":41,"offset":3455}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"リネームされたファイルがちゃんと指定されたGoogleドライブのフォルダー内に格納されます。","position":{"start":{"line":123,"column":1,"offset":3457},"end":{"line":123,"column":47,"offset":3503}}}],"position":{"start":{"line":123,"column":1,"offset":3457},"end":{"line":123,"column":47,"offset":3503}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.35443037974683%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAQAF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3kSmP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAAIDAQAAAAAAAAAAAAAAABARAAFRgf/aAAgBAQABPyHkVYEf/9oADAMBAAIAAwAAABAzD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAAICAwAAAAAAAAAAAAAAABEhARAAUYH/2gAIAQEAAT8QgJMMUdRsJ5f/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/62f335ba5866ef0cbf4726ab79fe40ae/81b7c/entry476-3.webp 158w,\n/static/62f335ba5866ef0cbf4726ab79fe40ae/6ea66/entry476-3.webp 315w,\n/static/62f335ba5866ef0cbf4726ab79fe40ae/7f61c/entry476-3.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/62f335ba5866ef0cbf4726ab79fe40ae/ff44c/entry476-3.jpg 158w,\n/static/62f335ba5866ef0cbf4726ab79fe40ae/a6688/entry476-3.jpg 315w,\n/static/62f335ba5866ef0cbf4726ab79fe40ae/066f9/entry476-3.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/62f335ba5866ef0cbf4726ab79fe40ae/066f9/entry476-3.jpg\"\n            alt=\"リネームされたファイルがちゃんと保存されます\"\n            title=\"リネームされたファイルがちゃんと保存されます\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>","position":{"start":{"line":125,"column":1,"offset":3505},"end":{"line":125,"column":59,"offset":3563}}}],"position":{"start":{"line":125,"column":1,"offset":3505},"end":{"line":125,"column":59,"offset":3563}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"できた！！","position":{"start":{"line":127,"column":1,"offset":3565},"end":{"line":127,"column":6,"offset":3570}}}],"position":{"start":{"line":127,"column":1,"offset":3565},"end":{"line":127,"column":6,"offset":3570}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"msg-baloon\">\n<p><img src=\"/static/ecd737bbd9e6b99fd33fbd308f2b88e8/f836f/camille.jpg\">かみーゆ</p>\n<p>ドライブには同じ名前のファイルがアップロードできますよね？<br>ファイル名を自動でつけると重複することがないので、後々困らずにすみますよ！</p>\n</div>","position":{"start":{"line":129,"column":1,"offset":3572},"end":{"line":132,"column":7,"offset":3763}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"スプシにファイル情報を書き出す"},"children":[{"type":"text","value":"スプシにファイル情報を書き出す","position":{"start":{"line":134,"column":4,"offset":3768},"end":{"line":134,"column":19,"offset":3783}}}],"position":{"start":{"line":134,"column":1,"offset":3765},"end":{"line":134,"column":19,"offset":3783}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ファイル以外のデータも取得します。","position":{"start":{"line":135,"column":1,"offset":3784},"end":{"line":135,"column":18,"offset":3801}}}],"position":{"start":{"line":135,"column":1,"offset":3784},"end":{"line":135,"column":18,"offset":3801}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">;</span><span class=\"token comment\">//ファイルデータ</span>\n<span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">;</span><span class=\"token comment\">//日時データ</span>\n<span class=\"token keyword\">const</span> project <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>project<span class=\"token punctuation\">;</span><span class=\"token comment\">//プロジェクト名</span>\n<span class=\"token keyword\">var</span> client <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//顧客名。あとで値を取得します</span></code></pre></div>","position":{"start":{"line":137,"column":1,"offset":3803},"end":{"line":142,"column":4,"offset":3948}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"顧客名はデータシートからデータを引っ張ってきて照合します。","position":{"start":{"line":143,"column":1,"offset":3949},"end":{"line":143,"column":30,"offset":3978}}}],"position":{"start":{"line":143,"column":1,"offset":3949},"end":{"line":143,"column":30,"offset":3978}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'データ'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> projectsLastRow <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//最終行を取得</span>\n<span class=\"token keyword\">const</span> clients <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> projectsLastRow<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//プロジェクトと顧客の列のみ取得</span>\n\n<span class=\"token comment\">//プロジェクト名から顧客名を割り出す</span>\n<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token keyword\">in</span> clients<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>clients<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> project<span class=\"token punctuation\">)</span> client <span class=\"token operator\">=</span> clients<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":145,"column":1,"offset":3980},"end":{"line":154,"column":4,"offset":4336}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"それぞれデータができたら、シートに出力します。","position":{"start":{"line":155,"column":1,"offset":4337},"end":{"line":155,"column":24,"offset":4360}}}],"position":{"start":{"line":155,"column":1,"offset":4337},"end":{"line":155,"column":24,"offset":4360}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">'=HYPERLINK(\"'</span> <span class=\"token operator\">+</span> doc<span class=\"token punctuation\">.</span><span class=\"token function\">getUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\",\"'</span> <span class=\"token operator\">+</span> fileName <span class=\"token operator\">+</span> <span class=\"token string\">'\")'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">'請求書発行済'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":156,"column":1,"offset":4361},"end":{"line":162,"column":4,"offset":4680}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"実行するとこんな感じになります。","position":{"start":{"line":163,"column":1,"offset":4681},"end":{"line":163,"column":17,"offset":4697}}}],"position":{"start":{"line":163,"column":1,"offset":4681},"end":{"line":163,"column":17,"offset":4697}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.848101265822784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3AUH/8QAFRABAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQEAAQUCj//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABkQAAIDAQAAAAAAAAAAAAAAAAABETFRYf/aAAgBAQABPyFYSI4ij//aAAwDAQACAAMAAAAQ8A//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhUWH/2gAIAQEAAT8QEMVxSenYhmif/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/28dbfb5f4dccf2df552377da9e2738b3/81b7c/entry476-4.webp 158w,\n/static/28dbfb5f4dccf2df552377da9e2738b3/6ea66/entry476-4.webp 315w,\n/static/28dbfb5f4dccf2df552377da9e2738b3/e88ff/entry476-4.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/28dbfb5f4dccf2df552377da9e2738b3/ff44c/entry476-4.jpg 158w,\n/static/28dbfb5f4dccf2df552377da9e2738b3/a6688/entry476-4.jpg 315w,\n/static/28dbfb5f4dccf2df552377da9e2738b3/b4294/entry476-4.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/28dbfb5f4dccf2df552377da9e2738b3/b4294/entry476-4.jpg\"\n            alt=\"スプシの書き出し\"\n            title=\"スプシの書き出し\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>","position":{"start":{"line":165,"column":1,"offset":4699},"end":{"line":165,"column":45,"offset":4743}}}],"position":{"start":{"line":165,"column":1,"offset":4699},"end":{"line":165,"column":45,"offset":4743}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"msg-baloon\">\n<p><img src=\"/static/ecd737bbd9e6b99fd33fbd308f2b88e8/f836f/camille.jpg\">かみーゆ</p>\n<p>請求書などのファイルを一元管理！<br>IDのリンクからファイルに飛べるので、ファイルをいちいちドライブで探す必要がなくなりますヨ！</p>\n</div>","position":{"start":{"line":167,"column":1,"offset":4745},"end":{"line":170,"column":7,"offset":4932}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"sendformのすべてのコード"},"children":[{"type":"text","value":"sendFormのすべてのコード","position":{"start":{"line":172,"column":4,"offset":4937},"end":{"line":172,"column":20,"offset":4953}}}],"position":{"start":{"line":172,"column":1,"offset":4934},"end":{"line":172,"column":20,"offset":4953}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ファイルをリネームしてドライブに保存し、スプシに書き出すまでの処理です。","position":{"start":{"line":173,"column":1,"offset":4954},"end":{"line":173,"column":37,"offset":4990}}}],"position":{"start":{"line":173,"column":1,"offset":4954},"end":{"line":173,"column":37,"offset":4990}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/**\n * スプシのフォームからの値の受け取り、リネーム後、スプシに詳細を追記\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">form</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> folder <span class=\"token operator\">=</span> DriveApp<span class=\"token punctuation\">.</span><span class=\"token function\">getFolderById</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>フォルダー<span class=\"token constant\">ID</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//ファイルを取得したら。</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> accounting <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'請求書'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> num <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> fileName <span class=\"token operator\">=</span> <span class=\"token string\">'invoice-'</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0000\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">5</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> doc <span class=\"token operator\">=</span> folder<span class=\"token punctuation\">.</span><span class=\"token function\">createFile</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    doc<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Browser<span class=\"token punctuation\">.</span><span class=\"token function\">msgBox</span><span class=\"token punctuation\">(</span><span class=\"token string\">'新しい請求書「'</span> <span class=\"token operator\">+</span> fileName <span class=\"token operator\">+</span> <span class=\"token string\">\"」を保存しました\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//スプシに書き出すデータ</span>\n    <span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> project <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>project<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> client <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'データ'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> projectsLastRow <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> clients <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> projectsLastRow<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token keyword\">in</span> clients<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>clients<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> project<span class=\"token punctuation\">)</span> client <span class=\"token operator\">=</span> clients<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">//スプシに書き出し</span>\n    accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">'=HYPERLINK(\"'</span><span class=\"token operator\">+</span>doc<span class=\"token punctuation\">.</span><span class=\"token function\">getUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">'\",\"'</span><span class=\"token operator\">+</span>fileName<span class=\"token operator\">+</span><span class=\"token string\">'\")'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">'請求書発行済'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    accounting<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    Browser<span class=\"token punctuation\">.</span><span class=\"token function\">msgBox</span><span class=\"token punctuation\">(</span><span class=\"token string\">'保存できませんでした'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":174,"column":1,"offset":4991},"end":{"line":215,"column":4,"offset":6440}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"メニューから操作して保存処理を常に実行できるようにする"},"children":[{"type":"text","value":"メニューから操作して保存処理を常に実行できるようにする","position":{"start":{"line":217,"column":4,"offset":6445},"end":{"line":217,"column":31,"offset":6472}}}],"position":{"start":{"line":217,"column":1,"offset":6442},"end":{"line":217,"column":31,"offset":6472}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"メニューを表示するための関数を","position":{"start":{"line":219,"column":1,"offset":6474},"end":{"line":219,"column":16,"offset":6489}}},{"type":"raw","value":"<code class=\"language-text\">コード.gs</code>","position":{"start":{"line":219,"column":16,"offset":6489},"end":{"line":219,"column":24,"offset":6497}}},{"type":"text","value":"（GAS）に追記します。","position":{"start":{"line":219,"column":24,"offset":6497},"end":{"line":219,"column":36,"offset":6509}}}],"position":{"start":{"line":219,"column":1,"offset":6474},"end":{"line":219,"column":36,"offset":6509}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">functionName</code>","position":{"start":{"line":221,"column":1,"offset":6511},"end":{"line":221,"column":15,"offset":6525}}},{"type":"text","value":"に前回","position":{"start":{"line":221,"column":15,"offset":6525},"end":{"line":221,"column":18,"offset":6528}}},{"type":"element","tagName":"a","properties":{"href":"/blogs/entry475"},"children":[{"type":"text","value":"【GAS】スプシからファイルアップロードし、ドライブに保存・UI編","position":{"start":{"line":221,"column":19,"offset":6529},"end":{"line":221,"column":52,"offset":6562}}}],"position":{"start":{"line":221,"column":18,"offset":6528},"end":{"line":221,"column":70,"offset":6580}}},{"type":"text","value":"で作った、フォームをスプシ上に出力するための関数","position":{"start":{"line":221,"column":70,"offset":6580},"end":{"line":221,"column":94,"offset":6604}}},{"type":"raw","value":"<code class=\"language-text\">showMdal</code>","position":{"start":{"line":221,"column":94,"offset":6604},"end":{"line":221,"column":104,"offset":6614}}},{"type":"text","value":"をセットします。","position":{"start":{"line":221,"column":104,"offset":6614},"end":{"line":221,"column":112,"offset":6622}}}],"position":{"start":{"line":221,"column":1,"offset":6511},"end":{"line":221,"column":112,"offset":6622}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/**\n * メニューの出力\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">setMenu</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> menu <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>name<span class=\"token operator\">:</span> <span class=\"token string\">\"請求書を発行する\"</span><span class=\"token punctuation\">,</span> functionName<span class=\"token operator\">:</span> <span class=\"token string\">\"showModal\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addMenu</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"請求書の管理\"</span><span class=\"token punctuation\">,</span> menu<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":223,"column":1,"offset":6624},"end":{"line":233,"column":4,"offset":6811}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">setMenu</code>","position":{"start":{"line":235,"column":1,"offset":6813},"end":{"line":235,"column":10,"offset":6822}}},{"type":"text","value":"を実行します。\n","position":{"start":{"line":235,"column":10,"offset":6822},"end":{"line":236,"column":1,"offset":6830}}},{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.0506329113924%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHuTSKD/8QAFxAAAwEAAAAAAAAAAAAAAAAAABARQf/aAAgBAQABBQLVCL//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAADAAMAAAAAAAAAAAAAAAAAAREQUXH/2gAIAQEAAT8hYSjKcInWP//aAAwDAQACAAMAAAAQHO//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPxBH/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8Qqv/EABsQAQADAQADAAAAAAAAAAAAAAEAETEhUWFx/9oACAEBAAE/EMHjWRkUXtluS3uN9T7AGwynwT//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/24d5935140a73cc05a40b59f63214b27/81b7c/entry476-5.webp 158w,\n/static/24d5935140a73cc05a40b59f63214b27/6ea66/entry476-5.webp 315w,\n/static/24d5935140a73cc05a40b59f63214b27/b0a15/entry476-5.webp 500w\"\n              sizes=\"(max-width: 500px) 100vw, 500px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/24d5935140a73cc05a40b59f63214b27/ff44c/entry476-5.jpg 158w,\n/static/24d5935140a73cc05a40b59f63214b27/a6688/entry476-5.jpg 315w,\n/static/24d5935140a73cc05a40b59f63214b27/41099/entry476-5.jpg 500w\"\n            sizes=\"(max-width: 500px) 100vw, 500px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/24d5935140a73cc05a40b59f63214b27/41099/entry476-5.jpg\"\n            alt=\"関数をセットし、実行\"\n            title=\"関数をセットし、実行\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>","position":{"start":{"line":236,"column":1,"offset":6830},"end":{"line":236,"column":47,"offset":6876}}}],"position":{"start":{"line":235,"column":1,"offset":6813},"end":{"line":236,"column":47,"offset":6876}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"スプシ側で確認するとちゃんとメニューができました！！\n","position":{"start":{"line":238,"column":1,"offset":6878},"end":{"line":239,"column":1,"offset":6905}}},{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.708860759493675%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd2sJg//xAAWEAADAAAAAAAAAAAAAAAAAAAAECH/2gAIAQEAAQUCKv/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAAMAAAAAAAAAAAAAAAAAAAAQMf/aAAgBAQAGPwIq/8QAGRAAAwADAAAAAAAAAAAAAAAAAAEhMUGB/9oACAEBAAE/IeirI1Wz/9oADAMBAAIAAwAAABDzz//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEBAQEBAQAAAAAAAAAAAAABEQAhYXH/2gAIAQEAAT8QsGr3BqITtcDHV93/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d4cfe647244ad4ee16a9c52e16740df5/81b7c/entry476-6.webp 158w,\n/static/d4cfe647244ad4ee16a9c52e16740df5/c85cb/entry476-6.webp 300w\"\n              sizes=\"(max-width: 300px) 100vw, 300px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d4cfe647244ad4ee16a9c52e16740df5/ff44c/entry476-6.jpg 158w,\n/static/d4cfe647244ad4ee16a9c52e16740df5/f93b5/entry476-6.jpg 300w\"\n            sizes=\"(max-width: 300px) 100vw, 300px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d4cfe647244ad4ee16a9c52e16740df5/f93b5/entry476-6.jpg\"\n            alt=\"関数をセットし、実行\"\n            title=\"関数をセットし、実行\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>","position":{"start":{"line":239,"column":1,"offset":6905},"end":{"line":239,"column":47,"offset":6951}}}],"position":{"start":{"line":238,"column":1,"offset":6878},"end":{"line":239,"column":47,"offset":6951}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"常にメニューをスプシ側で表示する"},"children":[{"type":"text","value":"常にメニューをスプシ側で表示する","position":{"start":{"line":241,"column":5,"offset":6957},"end":{"line":241,"column":21,"offset":6973}}}],"position":{"start":{"line":241,"column":1,"offset":6953},"end":{"line":241,"column":21,"offset":6973}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"トリガーから「トリガーを追加」を選びます。","position":{"start":{"line":243,"column":1,"offset":6975},"end":{"line":243,"column":22,"offset":6996}}}],"position":{"start":{"line":243,"column":1,"offset":6975},"end":{"line":243,"column":22,"offset":6996}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 450px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.75949367088608%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAUBAgP/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAXxOZcVmp//EABgQAAIDAAAAAAAAAAAAAAAAAAECAyAx/9oACAEBAAEFAqYFncj/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEv/aAAgBAgEBPwFL/8QAFhABAQEAAAAAAAAAAAAAAAAAARAg/9oACAEBAAY/AsLP/8QAGhAAAgIDAAAAAAAAAAAAAAAAAREAMRAhkf/aAAgBAQABPyFS9PJKa04yEjk//9oADAMBAAIAAwAAABCz/wD/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8QS6//xAAVEQEBAAAAAAAAAAAAAAAAAAABAP/aAAgBAgEBPxCWX//EABwQAQACAgMBAAAAAAAAAAAAAAEAETFBEFGRof/aAAgBAQABPxARv5BEgKZKiJ15xWEArVuIrO6wn//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b7980c82bf37a889bc381741dec5c77b/81b7c/entry476-7.webp 158w,\n/static/b7980c82bf37a889bc381741dec5c77b/6ea66/entry476-7.webp 315w,\n/static/b7980c82bf37a889bc381741dec5c77b/8626f/entry476-7.webp 450w\"\n              sizes=\"(max-width: 450px) 100vw, 450px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b7980c82bf37a889bc381741dec5c77b/ff44c/entry476-7.jpg 158w,\n/static/b7980c82bf37a889bc381741dec5c77b/a6688/entry476-7.jpg 315w,\n/static/b7980c82bf37a889bc381741dec5c77b/20e5d/entry476-7.jpg 450w\"\n            sizes=\"(max-width: 450px) 100vw, 450px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b7980c82bf37a889bc381741dec5c77b/20e5d/entry476-7.jpg\"\n            alt=\"entry476 7\"\n            title=\"entry476 7\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>","position":{"start":{"line":245,"column":1,"offset":6998},"end":{"line":245,"column":37,"offset":7034}}}],"position":{"start":{"line":245,"column":1,"offset":6998},"end":{"line":245,"column":37,"offset":7034}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"関数に","position":{"start":{"line":247,"column":1,"offset":7036},"end":{"line":247,"column":4,"offset":7039}}},{"type":"raw","value":"<code class=\"language-text\">setMenu</code>","position":{"start":{"line":247,"column":4,"offset":7039},"end":{"line":247,"column":13,"offset":7048}}},{"type":"text","value":"をセット。あとは、デフォルトのままで大丈夫です。","position":{"start":{"line":247,"column":13,"offset":7048},"end":{"line":247,"column":37,"offset":7072}}}],"position":{"start":{"line":247,"column":1,"offset":7036},"end":{"line":247,"column":37,"offset":7072}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.46835443037975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIDBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHsTWGRMXSDMD//xAAcEAEAAQQDAAAAAAAAAAAAAAACAAEDETESITL/2gAIAQEAAQUCJOOJjJydS5s+Yuq//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAGhABAAIDAQAAAAAAAAAAAAAAAQAQITEykf/aAAgBAQAGPwIwTk8miFl//8QAHxAAAgEDBQEAAAAAAAAAAAAAAAEREDGhIUFRYXGB/9oACAEBAAE/IekS2IyJJCtODCVLPhgUWxP1yf/aAAwDAQACAAMAAAAQs8cA/8QAFhEAAwAAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/EKj/xAAWEQADAAAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8QrP/EACEQAQABAgUFAAAAAAAAAAAAAAEAEUEQMVFhcSGRsdHw/9oACAEBAAE/EE1uO6cRoCrvR6hEdYEuyw3u0Mp8m7CZdvjAAEqlepc6z//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3dd569c08d9c4c5b66d847c72cd18925/81b7c/entry476-8.webp 158w,\n/static/3dd569c08d9c4c5b66d847c72cd18925/6ea66/entry476-8.webp 315w,\n/static/3dd569c08d9c4c5b66d847c72cd18925/b0a15/entry476-8.webp 500w\"\n              sizes=\"(max-width: 500px) 100vw, 500px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3dd569c08d9c4c5b66d847c72cd18925/ff44c/entry476-8.jpg 158w,\n/static/3dd569c08d9c4c5b66d847c72cd18925/a6688/entry476-8.jpg 315w,\n/static/3dd569c08d9c4c5b66d847c72cd18925/41099/entry476-8.jpg 500w\"\n            sizes=\"(max-width: 500px) 100vw, 500px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3dd569c08d9c4c5b66d847c72cd18925/41099/entry476-8.jpg\"\n            alt=\"entry476 8\"\n            title=\"entry476 8\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>","position":{"start":{"line":249,"column":1,"offset":7074},"end":{"line":249,"column":37,"offset":7110}}}],"position":{"start":{"line":249,"column":1,"offset":7074},"end":{"line":249,"column":37,"offset":7110}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"これでスプシ起動時にメニューが表示され、いつでもファイルをアップロードできるようになりました。","position":{"start":{"line":251,"column":1,"offset":7112},"end":{"line":251,"column":48,"offset":7159}}}],"position":{"start":{"line":251,"column":1,"offset":7112},"end":{"line":251,"column":48,"offset":7159}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.56962025316456%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHuW0wolEBf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQABBQIf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwIf/8QAGhABAAIDAQAAAAAAAAAAAAAAAQARECExUf/aAAgBAQABPyENcCUvkQvYM6Qoj2Wy8f/aAAwDAQACAAMAAAAQYA9A/8QAFhEAAwAAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/ECP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAbEAADAQADAQAAAAAAAAAAAAAAAREhMUFR8P/aAAgBAQABPxBipfXCLMXNfA/pF20SCd46EREocwvQr0es/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8da89153174e98fff4ff461cf2161dee/81b7c/entry476-9.webp 158w,\n/static/8da89153174e98fff4ff461cf2161dee/6ea66/entry476-9.webp 315w,\n/static/8da89153174e98fff4ff461cf2161dee/8aab1/entry476-9.webp 630w,\n/static/8da89153174e98fff4ff461cf2161dee/d00b9/entry476-9.webp 800w\"\n              sizes=\"(max-width: 630px) 100vw, 630px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8da89153174e98fff4ff461cf2161dee/ff44c/entry476-9.jpg 158w,\n/static/8da89153174e98fff4ff461cf2161dee/a6688/entry476-9.jpg 315w,\n/static/8da89153174e98fff4ff461cf2161dee/828fb/entry476-9.jpg 630w,\n/static/8da89153174e98fff4ff461cf2161dee/4b190/entry476-9.jpg 800w\"\n            sizes=\"(max-width: 630px) 100vw, 630px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8da89153174e98fff4ff461cf2161dee/828fb/entry476-9.jpg\"\n            alt=\"リネームされたファイルがちゃんと保存されます\"\n            title=\"リネームされたファイルがちゃんと保存されます\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>","position":{"start":{"line":253,"column":1,"offset":7161},"end":{"line":253,"column":59,"offset":7219}}}],"position":{"start":{"line":253,"column":1,"offset":7161},"end":{"line":253,"column":59,"offset":7219}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"まとめ・gasはやっぱり便利じゃわー（広島弁）"},"children":[{"type":"text","value":"まとめ・GASはやっぱり便利じゃわー（広島弁）","position":{"start":{"line":255,"column":4,"offset":7224},"end":{"line":255,"column":27,"offset":7247}}}],"position":{"start":{"line":255,"column":1,"offset":7221},"end":{"line":255,"column":27,"offset":7247}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"今回は前回のアップロードフォームのパーツ表示に続き、ファイルにバリデーションをかけてアップロードし、スプシにデータを書き出す方法をご紹介しました。","position":{"start":{"line":256,"column":1,"offset":7248},"end":{"line":256,"column":74,"offset":7321}}}],"position":{"start":{"line":256,"column":1,"offset":7248},"end":{"line":256,"column":74,"offset":7321}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"msg-baloon\">\n<p><img src=\"/static/ecd737bbd9e6b99fd33fbd308f2b88e8/f836f/camille.jpg\">かみーゆ</p>\n<p>普段の事務作業を少しでも減らしたくてGASを使ってみたら便利だったのでこの記事を書きました</p>\n</div>","position":{"start":{"line":258,"column":1,"offset":7323},"end":{"line":261,"column":7,"offset":7489}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"フォルダー自動生成に関しては、こちらの記事を参考に！","position":{"start":{"line":263,"column":1,"offset":7491},"end":{"line":263,"column":27,"offset":7517}}}],"position":{"start":{"line":263,"column":1,"offset":7491},"end":{"line":263,"column":27,"offset":7517}}},{"type":"text","value":"\n"},{"type":"raw","value":"<a class=\"article-link\" href=\"/blogs/entry470/\">\n<section><div class=\"article-link__img\"><img alt=\"Google Apps Script（GAS） でスプシからドライブにフォルダー自動生成\" src=\"/static/250e1864a7205400c846e6381f082a1a/f836f/entry470.jpg\" width=\"150\" height=\"113\" class=\"\"></div><div class=\"article-link__main\">\n<div class=\"article-link__main__title\">Google Apps Script（GAS） でスプシからドライブにフォルダー自動生成</div>\n<p class=\"description\">GASを使ってスプレッドシートからGoogleドライブにフォルダーを自動追加する方法の紹介です･･･</p>\n<p>\n<time datetime=\"2021-06-08\">2021.06.08</time>\n</p>\n</div>\n</section>\n</a>","position":{"start":{"line":265,"column":1,"offset":7519},"end":{"line":274,"column":5,"offset":8048}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"皆さんの事務作業軽減の一助となれば幸いです。","position":{"start":{"line":276,"column":1,"offset":8050},"end":{"line":276,"column":23,"offset":8072}}}],"position":{"start":{"line":276,"column":1,"offset":8050},"end":{"line":276,"column":23,"offset":8072}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"最後までお読みいただきありがとうございました。","position":{"start":{"line":278,"column":1,"offset":8074},"end":{"line":278,"column":24,"offset":8097}}}],"position":{"start":{"line":278,"column":1,"offset":8074},"end":{"line":278,"column":24,"offset":8097}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":280,"column":1,"offset":8099}}}}