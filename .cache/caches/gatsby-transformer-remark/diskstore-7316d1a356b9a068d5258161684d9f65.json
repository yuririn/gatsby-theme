{"expireTime":9007200880801112000,"key":"transformer-remark-markdown-html-9e8009aeda28ceb1bc13ebdc7a2ed591-gatsby-remark-imagesgatsby-remark-autolink-headersgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":"<h3 id=\"この記事の対象\">この記事の対象</h3>\n<ul>\n<li>WordPressを少し改造したり、カスタマイズできる</li>\n<li>WordPressでブログをカスタマイズしたい</li>\n<li>HTMLやCSSがわかる</li>\n</ul>\n<div class=\"msg-baloon\">\n<p><img src=\"/static/ecd737bbd9e6b99fd33fbd308f2b88e8/f836f/camille.jpg\">かみーゆ</p>\n<p>簡単な実装から順番に紹介していきます！！！</p>\n</div>\n<h2 id=\"ショートコードの作り方\">ショートコードの作り方</h2>\n<p>ショートタグは投稿でphpの代わりに使えるワードプレス専用のタグです。</p>\n<p><a href=\"https://wpdocs.osdn.jp/%E3%82%B7%E3%83%A7%E3%83%BC%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89_API\">ショートコードAPI</a></p>\n<p>変数や関数が使えるのでとっても便利です。</p>\n<p>たとえば、サイトのURLのショートタグを作りたいときのコードの書き方はこんな感じ。functions.phpに追記するだけです。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">home_url</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$home</span> <span class=\"token operator\">=</span> <span class=\"token function\">esc_url</span><span class=\"token punctuation\">(</span> <span class=\"token function\">home_url</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$home</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_shortcode</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'URL'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'home_url'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">add_shortcode</code>関数でショートコードとして呼び出すことができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token function\">add_shortcode</span><span class=\"token punctuation\">(</span>ショートコード名<span class=\"token punctuation\">,</span> 関数<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>投稿記事内にショートコードを利用できるようになります。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>[URL]<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>トップページ<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h3 id=\"ヘビーに使うバナーをショートコードとして登録し呼び出す\">ヘビーに使うバナーをショートコードとして登録し呼び出す</h3>\n<p>バナーやコンバージョンエリアを呼び出すのに便利です。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">banner</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$banner</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'&lt;div>'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$banner</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;a href=\"'</span> <span class=\"token operator\">.</span> <span class=\"token function\">esc_url</span><span class=\"token punctuation\">(</span> <span class=\"token function\">home_url</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'/campaign/\">'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$banner</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;img src=\"'</span> <span class=\"token operator\">.</span> <span class=\"token function\">esc_url</span><span class=\"token punctuation\">(</span> <span class=\"token function\">get_bloginfo</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'template_url'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'\" alt=\"キャンペーンバナー\" width=\"700\" heigth=\"250\">'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$banner</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;/img>'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$banner</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;div>'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token variable\">$banner</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_shortcode</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'banner'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'banner'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>記事内でバナー表示したいところに追加します。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">キャンペーンやってるよ！！\n[banner]</code></pre></div>\n<h2 id=\"ショートコードに引数を使って値を追加する\">ショートコードに引数を使って値を追加する</h2>\n<p>次はショートコードに値（引数）を追加する方法です。</p>\n<p>現在は<code class=\"language-text\">extract</code>を使う方法は推奨されてません。</p>\n<p>先ほどのバナーのショートコードを改造してみます。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">banner</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$atts</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$atts</span> <span class=\"token operator\">=</span> <span class=\"token function\">shortcode_atts</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n      <span class=\"token comment\">//取得したい値のキー</span>\n      <span class=\"token string single-quoted-string\">'page'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string single-quoted-string\">'src'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token variable\">$atts</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string single-quoted-string\">'banner'</span><span class=\"token comment\">//ショートコード名</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token variable\">$banner</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'&lt;div>'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//同じサイト内のスラッグなど</span>\n  <span class=\"token variable\">$banner</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;a href=\"'</span> <span class=\"token operator\">.</span> <span class=\"token function\">esc_url</span><span class=\"token punctuation\">(</span> <span class=\"token function\">home_url</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$atts</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'page'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'/'</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'\">'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$banner</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;img src=\"'</span> <span class=\"token operator\">.</span> <span class=\"token function\">esc_url</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$atts</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'src'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'\" alt=\"キャンペーンバナー\" width=\"700\" heigth=\"250\">'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$banner</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;/a>'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$banner</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;div>'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token variable\">$banner</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_shortcode</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'banner'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'banner'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>これで画像とリンク先を差し替えることができるようになります。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">[banner page=\"campaign2\" src=\"https://hogehoge.com/images/banner.png\"]</code></pre></div>\n<h2 id=\"ショートコード内に文を入れる\">ショートコード内に文を入れる</h2>\n<p>ショートとタグの中に文も追加できます。</p>\n<p>カンタンなものでこんな装飾もできますし、吹き出し装飾なんかも作れます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2459dcfdfd6c00e865ef437bf7138ef9/4b190/entry211-1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.88607594936709%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAEABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAG6AD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAWEAADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQEAAT8hKv/aAAwDAQACAAMAAAAQeC//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAACAgMAAAAAAAAAAAAAAAAAARExYXHB/9oACAEBAAE/EFc9NENzg//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2459dcfdfd6c00e865ef437bf7138ef9/81b7c/entry211-1.webp 158w,\n/static/2459dcfdfd6c00e865ef437bf7138ef9/6ea66/entry211-1.webp 315w,\n/static/2459dcfdfd6c00e865ef437bf7138ef9/8aab1/entry211-1.webp 630w,\n/static/2459dcfdfd6c00e865ef437bf7138ef9/d00b9/entry211-1.webp 800w\"\n              sizes=\"(max-width: 630px) 100vw, 630px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2459dcfdfd6c00e865ef437bf7138ef9/ff44c/entry211-1.jpg 158w,\n/static/2459dcfdfd6c00e865ef437bf7138ef9/a6688/entry211-1.jpg 315w,\n/static/2459dcfdfd6c00e865ef437bf7138ef9/828fb/entry211-1.jpg 630w,\n/static/2459dcfdfd6c00e865ef437bf7138ef9/4b190/entry211-1.jpg 800w\"\n            sizes=\"(max-width: 630px) 100vw, 630px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2459dcfdfd6c00e865ef437bf7138ef9/828fb/entry211-1.jpg\"\n            alt=\"実装例\"\n            title=\"実装例\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">box</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$atts</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$content</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$atts</span> <span class=\"token operator\">=</span> <span class=\"token function\">shortcode_atts</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n      <span class=\"token comment\">//取得したい値のキー</span>\n      <span class=\"token comment\">//デフォルト値を入れておいてあげても○</span>\n      <span class=\"token string single-quoted-string\">'label'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token variable\">$atts</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string single-quoted-string\">'box'</span><span class=\"token comment\">//ショートコード名</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token variable\">$box</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'&lt;div class=\"box\">'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$box</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;h2>'</span><span class=\"token operator\">.</span> <span class=\"token function\">esc_html</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$atts</span><span class=\"token punctuation\">[</span> <span class=\"token string single-quoted-string\">'label'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/h2>'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//同じサイト内のスラッグなど</span>\n  <span class=\"token variable\">$box</span> <span class=\"token operator\">.=</span> <span class=\"token variable\">$content</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$box</span> <span class=\"token operator\">.=</span> <span class=\"token string single-quoted-string\">'&lt;div>'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token variable\">$box</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">add_shortcode</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'box'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'box'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">[box label=\"ポイント\"]ここに文章が入ります[/box]</code></pre></div>\n<h3 id=\"コンテンツだけ追加したいとき\">コンテンツだけ追加したいとき</h3>\n<p>コンテンツだけ追加したいときは、第一引数を<code class=\"language-text\">null</code>か<code class=\"language-text\">''</code>あたりにしておきます。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">box</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$atts</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$content</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'&lt;div>'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$content</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'&lt;/div>'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"ショートコードの入れ子\">ショートコードの入れ子</h2>\n<p>ショートコードは装飾にめっちゃ便利ですが、入れ子にしたいこともあります。</p>\n<p>そんなときは<code class=\"language-text\">shortcode_unautop</code>と<code class=\"language-text\">do_shortcode</code>を使います。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">box</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$atts</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$content</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$content</span> <span class=\"token operator\">=</span> <span class=\"token function\">do_shortcode</span><span class=\"token punctuation\">(</span> <span class=\"token function\">shortcode_unautop</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$content</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//省略</span>\n  <span class=\"token keyword\">return</span> <span class=\"token variable\">$box</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>先ほど作ったショートコードを例にとると、装飾の中にショートコードを含めることができるようになります。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">[box label=\"ポイント\"]\nただいまキャンペーン中です。\n[banner]\n[/box]</code></pre></div>\n<h2 id=\"そのほか、ショートコードで便利なtips\">そのほか、ショートコードで便利なTips</h2>\n<p>そのほかショートコードで便利な方法がいくつかあるので、まとめておきます。</p>\n<h3 id=\"テンプレート内（phpファイル内）で呼び出す\">テンプレート内（phpファイル内）で呼び出す</h3>\n<p>テンプレート内では<code class=\"language-text\">do_shortcode</code>関数を使って呼び出します。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">echo</span> <span class=\"token function\">do_shortcode</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'[box]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"ショートコードを取り除く\">ショートコードを取り除く</h3>\n<p>逆にサイトの説明などにショートコードが抜き出しで出てしまうことがあります。そんなときは<code class=\"language-text\">strip_shortcodes</code>でショートコードが取り除けます。</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token function\">strip_shortcodes</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$content</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"まとめ\">まとめ</h2>\n<p>ショートコードはうまく使うと超便利！装飾の幅も広がり記事やページがめっちゃ華やかになります。</p>\n<p>ただ、テーマの乗り換えをするときに使えないショートコードなども出てきた後々大変にはなることもありますので、メンテナンス性を考えて、うまく利用しましょう！</p>\n<p>皆さんのコーディングライフの一助となれば幸いです。</p>\n<p>今回も最後までお読みいただきありがとうございました。</p>"}