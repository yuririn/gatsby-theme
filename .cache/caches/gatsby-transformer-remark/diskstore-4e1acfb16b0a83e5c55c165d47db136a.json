{"expireTime":9007200880805350000,"key":"transformer-remark-markdown-html-809b1785b55949849051311b6d50406a-gatsby-remark-imagesgatsby-remark-autolink-headersgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":"<h2 id=\"今までのgatsbyの記事と注意点\">今までのGatsbyの記事と注意点</h2>\n<p>現在ここまで記載しています。<br>\n制作するまでを目標にUPしていくので順を追ったらGatsbyサイトが作れると思います。</p>\n<ol>\n<li><a href=\"/blogs/entry401/\">インストールからNetlifyデプロイまで</a></li>\n<li>投稿ページの充実と画像の方法（←イマココ）</li>\n<li><a href=\"/blogs/entry408/\">ブログ記事、カテゴリー、タグ一覧の出力</a></li>\n<li><a href=\"/blogs/entry410/\">プラグインを利用して目次出力</a></li>\n<li><a href=\"/blogs/entry413/\">プラグインナシで一覧にページネーション実装</a></li>\n<li><a href=\"/blogs/entry416/\">個別ページテンプレート作成</a></li>\n<li><a href=\"/blogs/entry418/\">プラグインHelmetでSEO調整</a></li>\n<li><a href=\"/blogs/entry421/\">CSSコンポーネントでオリジナルページを作ろう！！</a></li>\n<li><a href=\"/blogs/entry430/\">関連記事一覧出力</a></li>\n</ol>\n<h3 id=\"このシリーズではテーマgatsby-starter-blogを改造します\">このシリーズではテーマGatsby Starter Blogを改造します</h3>\n<p>この記事は一番メジャーなテンプレート、 Gatsby Starter Blogを改造しています。同じテーマでないと動かない可能性があります。</p>\n<p>各種設定を変更していきましょう。</p>\n<h2 id=\"記事と記事中の画像などの格納フォルダーを変更\">記事と記事中の画像などの格納フォルダーを変更</h2>\n<p>デフォルトでは、記事内本文に表示したい画像であればマークダウンファイルと同じblogフォルダーに格納すれば大丈夫です。</p>\n<p>私は今公開されているサイトにディレクトリー構造をできるだけ近づけるため、以下のように設置しました。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">プロジェクト/\n  └ content/\n    └ blog/ あとで名前変更\n      └ blogs/\n      ├ imgages/\n      ├ 個別のページ\n      └ blogs/\n        └ 各ブログ記事</code></pre></div>\n<p>gatsby-config.jsの<code class=\"language-text\">gatsby-theme-blog</code>の<code class=\"language-text\">basepath</code>を<code class=\"language-text\">blogs</code>から<code class=\"language-text\">/posts</code>変更します。<br>\ngatsby-config.jsはプロジェクトをインストールした直下にあります。<br>\nblogの下にblogsがあるのは気持ち悪いので。。。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-theme-blog</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      basePath<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/blog</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>を以下に変更。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-theme-blog</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      basePath<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/posts</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>ディレクトリー名もpostsに変更します。</p>\n<p>さらに、ファイルの格納場所の名前の変更も忘れずに。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-source-filesystem</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    path<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/content/blog</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">blog</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-source-filesystem</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    path<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/content/assets</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">assets</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  省略</code></pre></div>\n<p>を以下に変更。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-source-filesystem</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    path<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/content/posts</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">posts</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-source-filesystem</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    path<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/content/assets</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">assets</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  省略</code></pre></div>\n<h2 id=\"frontmatterを設計し投稿する。\">frontmatterを設計し投稿する。</h2>\n<p>記事ごとに必要なタイトルなどの項目を設計します。</p>\n<p>ここで適当に設計したら多分あとで泣きをみます。</p>\n<p>後々何が出力したいかよく考えて作成しましょう。</p>\n<div class=\"gatsby-highlight\" data-language=\"md\"><pre class=\"language-md\"><code class=\"language-md\"><span class=\"token front-matter-block\"><span class=\"token punctuation\">---</span>\n<span class=\"token font-matter yaml language-yaml\">title: テスト投稿\ndate: 2020-11-26\ndescription: この記事はテスト投稿です</span>\n<span class=\"token punctuation\">---</span></span></code></pre></div>\n<p>デフォルトではこんなものだと思いますので、アイキャッチ（hero）、投稿の種類（pagetype）も追加します。<br>\nちなみに私のブログでは<strong>categoryは1つ、タグは複数OK</strong>というルールがあります。</p>\n<p>ルールが煩雑だと記事も破綻しますので。</p>\n<div class=\"gatsby-highlight\" data-language=\"md\"><pre class=\"language-md\"><code class=\"language-md\"><span class=\"token front-matter-block\"><span class=\"token punctuation\">---</span>\n<span class=\"token font-matter yaml language-yaml\">title: テスト投稿\ndate: 2020-11-26\npagetype: blog\nhero: entry321.jpg\ndescription: この記事はテスト投稿です</span>\n<span class=\"token punctuation\">---</span></span></code></pre></div>\n<p>適当に作ったら、content/posts/blogs/ディレクトリー内に格納してください。</p>\n<h2 id=\"出力するテンプレートを改造する\">出力するテンプレートを改造する</h2>\n<p>次に、出力するテンプレートを改造します。<br>\nテンプレートはsrc/templetes/内のblog-post.jsです。</p>\n<p>このテンプレートはlayout（骨格）、bio（執筆者情報）、seo（SEO関連）から構成されいます。</p>\n<p>今回は19 ~ 36行目の<code class=\"language-text\">article</code>の部分のメイン部分だけ出力を変えてみます。</p>\n<h3 id=\"アイキャッチの出力\">アイキャッチの出力</h3>\n<p>アイキャッチが反映できるようにします。</p>\n<p>私は記事とはアイキャッチを分けているので、Image用コンポーネントを新たに作って利用します。\nsrc/components直下にimage.jsファイルを作成します。</p>\n<p>デフォルトで入っているgatsby-imageを改造しました。</p>\n<p>環境に応じて<a href=\"https://ja.wikipedia.org/wiki/WebP\">WabP</a>などに画像が最適化されて表示がクソ早いです。</p>\n<p>惚れてまうやろ。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> StaticQuery<span class=\"token punctuation\">,</span> graphql <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'gatsby'</span>\n<span class=\"token keyword\">import</span> Img <span class=\"token keyword\">from</span> <span class=\"token string\">'gatsby-image'</span>\n\n<span class=\"token comment\">// 画像ファイルパスをプロパティに取るようなコンポーネントを定義</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> filename <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n\n  <span class=\"token comment\">// ページじゃないコンポーネントでもGraphQLが使えるように</span>\n  <span class=\"token comment\">// StaticQueryタグを使う</span>\n  <span class=\"token operator\">&lt;</span>StaticQuery\n\n    <span class=\"token comment\">// GraphQLのクエリ引数には何も指定しない！</span>\n    query<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    query {\n      images: allFile {\n      edges {\n        node {\n        relativePath\n        name\n        childImageSharp {\n          sizes(maxWidth: 800) {\n          ...GatsbyImageSharpSizes\n          }\n        }\n        }\n      }\n      }\n    }\n    </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 全画像情報がdataに代入されている</span>\n    render<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token comment\">// 指定した画像ファイルパス（コンポーネントのプロパティ）と</span>\n      <span class=\"token comment\">// 一致するgatsby-image用の情報を取得</span>\n      <span class=\"token keyword\">const</span> image <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>images<span class=\"token punctuation\">.</span>edges<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> n<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>relativePath<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>image<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span>\n\n      <span class=\"token comment\">// Imgタグでgatsby-imageで最適化された画像を表示する</span>\n      <span class=\"token keyword\">const</span> imageSizes <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>childImageSharp<span class=\"token punctuation\">.</span>sizes\n\n      <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Img fluid<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>imageSizes<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>丸パクらせていただきました。ありがとうございます。</p>\n<p>参考サイト:<a href=\"https://takumon.com/simple-gatsby-image-wrapper\">パスを渡せばgatsby-imageで画像を表示してくれるコンポーネントの作成方法</a></p>\n<p>次にsrc/templetes/内のblog-post.jsに作ったコンポーネントをインポートします。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> Image <span class=\"token keyword\">from</span> <span class=\"token string\">\"../components/image\"</span></code></pre></div>\n<p>const BlogPostTemplate ~ 以下にサムネを追加したいところにコードを追加します。<br>\n主にはheader内を変更します。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>header<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>h1 itemProp<span class=\"token operator\">=</span><span class=\"token string\">\"headline\"</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>header<span class=\"token operator\">></span></code></pre></div>\n<p>const BlogPostTemplate のHTMLの部分ですが、全体的にはこんな感じ。</p>\n<p>もしサムネがないときはダミー画像を表示します。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">BlogPostTemplate</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> data<span class=\"token punctuation\">,</span> location <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> post <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>markdownRemark\n  <span class=\"token keyword\">const</span> siteTitle <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>site<span class=\"token punctuation\">.</span>siteMetadata<span class=\"token operator\">?.</span>title <span class=\"token operator\">||</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Title</span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> previous<span class=\"token punctuation\">,</span> next <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> data\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">,</span> description<span class=\"token punctuation\">,</span> hero<span class=\"token punctuation\">,</span> date <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>frontmatter <span class=\"token comment\">//追加</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Layout location<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>location<span class=\"token punctuation\">}</span> title<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>siteTitle<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n\n      <span class=\"token operator\">&lt;</span><span class=\"token constant\">SEO</span>\n        title<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span>\n        description<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>description <span class=\"token operator\">||</span> post<span class=\"token punctuation\">.</span>excerpt<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>article\n        itemScope\n        itemType<span class=\"token operator\">=</span><span class=\"token string\">\"http://schema.org/Article\"</span>\n      <span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>header<span class=\"token operator\">></span>\n\n          <span class=\"token operator\">&lt;</span>h1 itemProp<span class=\"token operator\">=</span><span class=\"token string\">\"headline\"</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>date<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n            <span class=\"token punctuation\">{</span>hero <span class=\"token operator\">?</span>\n              <span class=\"token operator\">&lt;</span>Image filename<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>hero<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n            <span class=\"token operator\">:</span> <span class=\"token operator\">&lt;</span>Image filename<span class=\"token operator\">=</span><span class=\"token string\">\"dummy.png\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>header<span class=\"token operator\">></span>\n          <span class=\"token operator\">~</span> 以下省略<span class=\"token operator\">~</span></code></pre></div>\n<p>アイキャッチ、ダミー画像はcontent/assets/ディレクトリーに格納しておきます。</p>\n<p>次にクエリを修正します。</p>\n<p>69行目くらいにある、<code class=\"language-text\">export const pageQuery = graphql</code>を探してください。</p>\n<p>ここにQraphQLの実行文があります。</p>\n<p>idが正しい場合、同じMDファイルを読み込んでHTMLにパースしています。\nQraphQLはクエリ言語なので、MDファイルのfrontmatter(---で囲んだ部分)の設定もここから読み取ることができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token function\">markdownRemark</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> eq<span class=\"token operator\">:</span> $id <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    id\n    <span class=\"token function\">excerpt</span><span class=\"token punctuation\">(</span>pruneLength<span class=\"token operator\">:</span> <span class=\"token number\">160</span><span class=\"token punctuation\">)</span>\n    html\n    frontmatter <span class=\"token punctuation\">{</span>\n      title\n      <span class=\"token function\">date</span><span class=\"token punctuation\">(</span>formatString<span class=\"token operator\">:</span> <span class=\"token string\">\"MMMM DD, YYYY\"</span><span class=\"token punctuation\">)</span>\n      description\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>クエリにheroを足し、ついでに日本人からするとなじみのない日付のフォーマットも変えてしまいます。\nYYYY年MM月DD日と変更することも可能です。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token function\">markdownRemark</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> eq<span class=\"token operator\">:</span> $id <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    id\n    <span class=\"token function\">excerpt</span><span class=\"token punctuation\">(</span>pruneLength<span class=\"token operator\">:</span> <span class=\"token number\">160</span><span class=\"token punctuation\">)</span>\n    html\n    frontmatter <span class=\"token punctuation\">{</span>\n      title\n      <span class=\"token function\">date</span><span class=\"token punctuation\">(</span>formatString<span class=\"token operator\">:</span> <span class=\"token string\">\"YYYY.MM.DD\"</span><span class=\"token punctuation\">)</span>\n      description\n      hero\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>アイキャッチ画像が表示されるようになったのではないでしょうか？</p>\n<h2 id=\"オリジナルプロフィールコンポーネントを作成\">オリジナルプロフィールコンポーネントを作成</h2>\n<p>Imageコンポーネントはどこでも使えます。<br>\nせっかくなので、プロフィール用のコンポーネントを作ってみましょう！<br>\nsrc/components内にprofile.jsを作ります。</p>\n<p>リンクタグも使いたいので<code class=\"language-text\">gatsby</code>からLinkも呼び出します。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Link <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"gatsby\"</span>\n<span class=\"token keyword\">import</span> Image <span class=\"token keyword\">from</span> <span class=\"token string\">\"../components/image\"</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">profile</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>section <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"c-profile p-section\"</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>h2 <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"c-heading--lg\"</span><span class=\"token operator\">></span>管理人について<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"c-profile__img u-mblg\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Image filename<span class=\"token operator\">=</span><span class=\"token string\">\"my-profile.jpg\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"c-profile__content\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"u-mblg c-editArea\"</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>p <span class=\"token operator\">></span>「銀ねこアトリエ」へようこそ！フロントエンドエンジニアのかみーゆです。<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>ul<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>li<span class=\"token operator\">></span>日本でフロントエンドを中心に約<span class=\"token number\">10</span>年Web制作<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>li<span class=\"token operator\">></span><span class=\"token number\">2019</span>年<span class=\"token number\">4</span>月「MacBook Pro とスーツケースだけで生きていこう」と、セブ島に移住<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>li<span class=\"token operator\">></span>セブ島に転職してエンジニア講師<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>li<span class=\"token operator\">></span>オフショア開発担当者<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>li<span class=\"token operator\">></span>疲れたので辞めてプータロー<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>li<span class=\"token operator\">></span><span class=\"token function\">人生の充電中でセブ島ライフを満喫</span><span class=\"token punctuation\">(</span>イマココ<span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ul<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>好きな人といるだけでパワースポット！今は大好きな仲間と消耗しない働き方をするために計画中。\n            <span class=\"token number\">13</span>歳の頃から「好きなように生きて好きなように死ぬ」が人生の<span class=\"token constant\">KPI</span>。<span class=\"token operator\">&lt;</span>br <span class=\"token operator\">/</span><span class=\"token operator\">></span>「楽しいか」、「かっこいいか」でやることを判断・取捨択一しています。好きなものは肉とビール。<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>p <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"u-text-center\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/about\"</span> <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"p-btn--detail\"</span><span class=\"token operator\">></span>About Me<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>section <span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> profile\n</code></pre></div>\n<p>あとはお好きなところに作ったコンポーネントをインポートしてタグを追記してください。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> Profile <span class=\"token keyword\">from</span> <span class=\"token string\">\"../components/profile\"</span>\n\n省略\n\n<span class=\"token operator\">&lt;</span>Profile <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n省略</code></pre></div>\n<h3 id=\"css。。。記事の移行なのでcssを改めて書くのは面倒。。。\">CSS。。。記事の移行なのでCSSを改めて書くのは面倒。。。</h3>\n<p>私の場合は今回記事の以降なのでCSSのためのコンポーネントを改めて書くのはスーパー面倒です。</p>\n<p>なのでサクッと既存のCSSを読み込ませました。</p>\n<p>モジュール化といえどやっぱりインラインCSSには抵抗があります。。。</p>\n<p>私は各ページさほど変化なく作っており、しかもCSSはワンソース化しているのでそのまま読み込ませることにしました。</p>\n<p>src直下のgatsby-browser.jsを以下のように書き換えました。<br>\nリセットCSSをコメントアウトし、style.cssの中身を書き換えました。</p>\n<p>必要あればこちらにCSSファイルをを追記してください。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// normalize CSS across browsers</span>\n<span class=\"token comment\">// import \"./src/normalize.css\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"./src/style.css\"</span></code></pre></div>\n<h2 id=\"まとめ\">まとめ</h2>\n<p>いかがでしたか？</p>\n<p>これで画像ファイルをテンプレート、mdファイルかかわらず読み込めるようになったと思います。</p>\n<p>ちなみにまだ反映してませんが、現在92記事終わりました。。</p>\n<p>すでに実装できている項目は以下です。</p>\n<ul>\n<li>ヘッダーフッター出し分け</li>\n<li>一覧（記事全体、カテゴリー、タグ）</li>\n<li>ページネーション</li>\n<li>関連記事</li>\n<li>OGP出力</li>\n<li>人気記事</li>\n<li>外部リンクを別ウィンドウで開く</li>\n</ul>\n<p>順次更新してきますね！<br>\nページネーションはなぜか知らんけど、プラグインなしで実装する羽目になりました。</p>\n<p>もう1個重要な機能を実装したのですが忘れましたw</p>\n<p>こんな記事ですが皆さんのコーディングライフの一助となれば幸いです。</p>\n<p>最後までお読みいただきありがとうございました。</p>"}