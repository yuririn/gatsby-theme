{"expireTime":9007200880805334000,"key":"transformer-remark-markdown-html-fb4fb4a3930a0665f859ea30cc306b80-gatsby-remark-imagesgatsby-remark-autolink-headersgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":"<h2 id=\"結論、アップグレードすれば良い\">結論、アップグレードすれば良い</h2>\n<p>まあ、concrete5 8.2 系以上は早い話アップグレードすれば大丈夫です。<br>\nconcrete5の最新版を落としてきて、以下ファイルを上書きするだけでオッケーです。</p>\n<ul>\n<li>composer.json</li>\n<li>composer.lock</li>\n<li>/concrete</li>\n</ul>\n<p>くれぐれも言いますが、concrete5 をカスタマイズする時は絶対/concrete内をカスタマイズしてはいけません。このフォルダはコアで汚染されると大ごとです。\n/application 内にカスタマイズしたいファイルやディレクトリなどをコピーしてカスタマイズして置くとオーバーライドされます。</p>\n<p>ただ、自作のブロックやコントローラがきちんと新しいバージョンで動くか不安ですよね。concrete5 は WordPress みたくリファレンスがもりもりあるわけではありませんので、困ったときは私はコンクリートファイブジャパンの代表・菱川さんのブログか、本家のリファレンス(English)か、Katzさんのブログを参考にしています。<br>\nたまにググりきれない時は、致し方なくコア(concreteディレクトリ内)を漁って作っていることもあります。<br>\nなので、オラオラとカスタマイズした自分のサイトが下手したら動かなくなるかもしれないので、容易にアップグレードというわけには行きません。</p>\n<h3 id=\"現サイトのデータを落としてきて、ローカルに構築\">現サイトのデータを落としてきて、ローカルに構築</h3>\n<p>Vagrant で php7.2 環境でインストールするとやはり以下のエラー。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(E_COMPILE_ERROR)\nCannot use Concrete\\Core\\Foundation\\Object as Object because 'Object' is a special class name</code></pre></div>\n<p>なので、一旦 Vagrant の php を 7.1 ダウングレードして、concrete5 をアップグレード。<br>\nconcrete5 を 8.4系（現時点の最新）にアップグレード。<br>\nVagrant の php を 7.2 にアップグレードして確認。</p>\n<p>問題なく、アップグレードできました。ほ。</p>\n<h2 id=\"まとめ\">まとめ</h2>\n<p>concrete5 8系をお使いの方で、レンサバのセキュリティ問題で php が突然アップグレードして私のようにびっくりしている人、困っている人もいると思います。<br>\n解決方法はアップグレードのみです。<br>\nカスタマイズ入れている人、特殊なテーマ・ブロックを使っている人は慎重にやった方がいいとは思います。<br>\n参考にしていただければと思います。<br>\n最後まで、お読みいただきありがとうございました。</p>\n<h2 id=\"追記--php72-の-count-の取り扱いに注意\">追記 : php7.2 の count() の取り扱いに注意</h2>\n<p>数日経つと、サイトにエラー出で表示されとらんやん笑</p>\n<p>あとで調べて見ると、php7.2の count() の取り扱いが変わっているそう。<br>\n結構これで判定しているところあるからやばいね笑</p>\n<p><a href=\"https://qiita.com/masaki-ogawa/items/1671d110b2286ececd09\">PHP7.2のcountにハマった話</a></p>\n<p>今更だけど、もっと型に厳格にコード書かないといけないなと反省しました。</p>"}