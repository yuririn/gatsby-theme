{"expireTime":9007200880808118000,"key":"transformer-remark-markdown-ast-139642773acd928c16b53450b0ba921c-gatsby-remark-imagesgatsby-remark-autolink-headersgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"heading","depth":2,"children":[{"type":"text","value":"はじめに。こんなお悩みがある方へ","position":{"start":{"line":1,"column":4,"offset":3},"end":{"line":1,"column":20,"offset":19}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":20,"offset":19}},"data":{"id":"はじめに。こんなお悩みがある方へ","htmlAttributes":{"id":"はじめに。こんなお悩みがある方へ"},"hProperties":{"id":"はじめに。こんなお悩みがある方へ"}}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Googleドライブ内のあの書類どこ行ったけ？","position":{"start":{"line":3,"column":3,"offset":23},"end":{"line":3,"column":26,"offset":46}}}],"position":{"start":{"line":3,"column":3,"offset":23},"end":{"line":3,"column":26,"offset":46}}}],"position":{"start":{"line":3,"column":1,"offset":21},"end":{"line":3,"column":26,"offset":46}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"ファイル名の書類が何個もある！どっちだっけ？","position":{"start":{"line":4,"column":3,"offset":49},"end":{"line":4,"column":25,"offset":71}}}],"position":{"start":{"line":4,"column":3,"offset":49},"end":{"line":4,"column":25,"offset":71}}}],"position":{"start":{"line":4,"column":1,"offset":47},"end":{"line":4,"column":25,"offset":71}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"ドライブのフォルダー内が汚くてイライラ","position":{"start":{"line":5,"column":3,"offset":74},"end":{"line":5,"column":22,"offset":93}}}],"position":{"start":{"line":5,"column":3,"offset":74},"end":{"line":5,"column":22,"offset":93}}}],"position":{"start":{"line":5,"column":1,"offset":72},"end":{"line":5,"column":22,"offset":93}}}],"position":{"start":{"line":3,"column":1,"offset":21},"end":{"line":5,"column":22,"offset":93}}},{"type":"paragraph","children":[{"type":"html","value":"<br>","position":{"start":{"line":7,"column":1,"offset":95},"end":{"line":7,"column":5,"offset":99}}},{"type":"text","value":"JavaScriptが分かって、Googleアカウントさえあればこのお悩みを解決できます。","position":{"start":{"line":7,"column":5,"offset":99},"end":{"line":7,"column":50,"offset":144}}}],"position":{"start":{"line":7,"column":1,"offset":95},"end":{"line":7,"column":50,"offset":144}}},{"type":"paragraph","children":[{"type":"text","value":"今回はGoogle Apps Script（GAS）を使って、請求書など分類としては一緒だけど","position":{"start":{"line":9,"column":1,"offset":146},"end":{"line":9,"column":48,"offset":193}}},{"type":"strong","children":[{"type":"text","value":"命名規則やファイル形式が違う書類を","position":{"start":{"line":9,"column":50,"offset":195},"end":{"line":9,"column":67,"offset":212}}},{"type":"emphasis","children":[{"type":"text","value":"スッキリ整理する方法","position":{"start":{"line":9,"column":68,"offset":213},"end":{"line":9,"column":78,"offset":223}}}],"position":{"start":{"line":9,"column":67,"offset":212},"end":{"line":9,"column":79,"offset":224}}}],"position":{"start":{"line":9,"column":48,"offset":193},"end":{"line":9,"column":81,"offset":226}}},{"type":"text","value":"を具体的に紹介していきます。","position":{"start":{"line":9,"column":81,"offset":226},"end":{"line":9,"column":95,"offset":240}}}],"position":{"start":{"line":9,"column":1,"offset":146},"end":{"line":9,"column":95,"offset":240}}},{"type":"html","value":"<div class=\"msg-baloon\">\n<p><img src=\"/static/ecd737bbd9e6b99fd33fbd308f2b88e8/f836f/camille.jpg\">かみーゆ</p>\n<p>人間ほど間違えるイキモノっていないよね？<br>だったらルールを決めてしまって、ルール通りにファイルを管理しよう！！</p>\n</div>","position":{"start":{"line":11,"column":1,"offset":242},"end":{"line":14,"column":7,"offset":421}}},{"type":"paragraph","children":[{"type":"text","value":"ちなみにフォルダー管理を自動化したい方はこちらの記事を参考に。","position":{"start":{"line":16,"column":1,"offset":423},"end":{"line":16,"column":32,"offset":454}}}],"position":{"start":{"line":16,"column":1,"offset":423},"end":{"line":16,"column":32,"offset":454}}},{"type":"html","value":"<a class=\"article-link\" href=\"/blogs/entry470/\">\n<section><div class=\"article-link__img\"><img alt=\"Google Apps Script（GAS） でスプシからドライブにフォルダー自動生成\" src=\"/static/250e1864a7205400c846e6381f082a1a/f836f/entry470.jpg\" width=\"150\" height=\"113\" class=\"\"></div><div class=\"article-link__main\">\n<div class=\"article-link__main__title\">Google Apps Script（GAS） でスプシからドライブにフォルダー自動生成</div>\n<p class=\"description\">GASを使ってスプレッドシートからGoogleドライブにフォルダーを自動追加する方法の紹介です･･･</p>\n<p>\n<time datetime=\"2021-06-08\">2021.06.08</time>\n</p>\n</div>\n</section>\n</a>","position":{"start":{"line":18,"column":1,"offset":456},"end":{"line":27,"column":5,"offset":985}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"スプシからファイルをアップロードしてドライブに保存するまでの大まかな作業の流れ","position":{"start":{"line":30,"column":5,"offset":992},"end":{"line":30,"column":44,"offset":1031}}}],"position":{"start":{"line":30,"column":1,"offset":988},"end":{"line":30,"column":44,"offset":1031}},"data":{"id":"スプシからファイルをアップロードしてドライブに保存するまでの大まかな作業の流れ","htmlAttributes":{"id":"スプシからファイルをアップロードしてドライブに保存するまでの大まかな作業の流れ"},"hProperties":{"id":"スプシからファイルをアップロードしてドライブに保存するまでの大まかな作業の流れ"}}},{"type":"paragraph","children":[{"type":"text","value":"ファイルアップロード用のコードを書きます。手順としては以下の流れです。","position":{"start":{"line":31,"column":1,"offset":1032},"end":{"line":31,"column":36,"offset":1067}}}],"position":{"start":{"line":31,"column":1,"offset":1032},"end":{"line":31,"column":36,"offset":1067}}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"スプシを準備","position":{"start":{"line":33,"column":5,"offset":1073},"end":{"line":33,"column":11,"offset":1079}}}],"position":{"start":{"line":33,"column":4,"offset":1072},"end":{"line":33,"column":12,"offset":1080}}}],"position":{"start":{"line":33,"column":4,"offset":1072},"end":{"line":33,"column":12,"offset":1080}}}],"position":{"start":{"line":33,"column":1,"offset":1069},"end":{"line":33,"column":12,"offset":1080}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"GASのプロジェクト作成","position":{"start":{"line":34,"column":5,"offset":1085},"end":{"line":34,"column":17,"offset":1097}}}],"position":{"start":{"line":34,"column":4,"offset":1084},"end":{"line":34,"column":18,"offset":1098}}}],"position":{"start":{"line":34,"column":4,"offset":1084},"end":{"line":34,"column":18,"offset":1098}}}],"position":{"start":{"line":34,"column":1,"offset":1081},"end":{"line":34,"column":18,"offset":1098}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"アップロード用のモーダルパーツを作成（UI追加）","position":{"start":{"line":35,"column":5,"offset":1103},"end":{"line":35,"column":29,"offset":1127}}}],"position":{"start":{"line":35,"column":4,"offset":1102},"end":{"line":35,"column":30,"offset":1128}}}],"position":{"start":{"line":35,"column":4,"offset":1102},"end":{"line":35,"column":30,"offset":1128}}}],"position":{"start":{"line":35,"column":1,"offset":1099},"end":{"line":35,"column":30,"offset":1128}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"\bバリデーション・保存するファイルのサイズやタイプを判定","position":{"start":{"line":36,"column":5,"offset":1133},"end":{"line":36,"column":33,"offset":1161}}}],"position":{"start":{"line":36,"column":4,"offset":1132},"end":{"line":36,"column":34,"offset":1162}}}],"position":{"start":{"line":36,"column":4,"offset":1132},"end":{"line":36,"column":34,"offset":1162}}}],"position":{"start":{"line":36,"column":1,"offset":1129},"end":{"line":36,"column":34,"offset":1162}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"\b","position":{"start":{"line":37,"column":4,"offset":1166},"end":{"line":37,"column":5,"offset":1167}}},{"type":"link","title":null,"url":"/blogs/entry476/","children":[{"type":"text","value":"Googleドライブでファイルを保存しリネーム（次回）","position":{"start":{"line":37,"column":6,"offset":1168},"end":{"line":37,"column":33,"offset":1195}}}],"position":{"start":{"line":37,"column":5,"offset":1167},"end":{"line":37,"column":52,"offset":1214}}}],"position":{"start":{"line":37,"column":4,"offset":1166},"end":{"line":37,"column":52,"offset":1214}}}],"position":{"start":{"line":37,"column":1,"offset":1163},"end":{"line":37,"column":52,"offset":1214}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"\b","position":{"start":{"line":38,"column":4,"offset":1218},"end":{"line":38,"column":5,"offset":1219}}},{"type":"link","title":null,"url":"/blogs/entry476/","children":[{"type":"text","value":"スプシにファイル情報を書き出す（次回）","position":{"start":{"line":38,"column":6,"offset":1220},"end":{"line":38,"column":25,"offset":1239}}}],"position":{"start":{"line":38,"column":5,"offset":1219},"end":{"line":38,"column":44,"offset":1258}}}],"position":{"start":{"line":38,"column":4,"offset":1218},"end":{"line":38,"column":44,"offset":1258}}}],"position":{"start":{"line":38,"column":1,"offset":1215},"end":{"line":38,"column":44,"offset":1258}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"\b","position":{"start":{"line":39,"column":4,"offset":1262},"end":{"line":39,"column":5,"offset":1263}}},{"type":"link","title":null,"url":"/blogs/entry476/","children":[{"type":"text","value":"メニュー操作で保存処理を常に実行できるようにする（次回）","position":{"start":{"line":39,"column":6,"offset":1264},"end":{"line":39,"column":34,"offset":1292}}}],"position":{"start":{"line":39,"column":5,"offset":1263},"end":{"line":39,"column":53,"offset":1311}}}],"position":{"start":{"line":39,"column":4,"offset":1262},"end":{"line":39,"column":53,"offset":1311}}}],"position":{"start":{"line":39,"column":1,"offset":1259},"end":{"line":39,"column":53,"offset":1311}}}],"position":{"start":{"line":33,"column":1,"offset":1069},"end":{"line":39,"column":53,"offset":1311}}},{"type":"paragraph","children":[{"type":"html","value":"<small>","position":{"start":{"line":41,"column":1,"offset":1313},"end":{"line":41,"column":8,"offset":1320}}},{"type":"text","value":"※ （次回）は次回の記事で紹介します。","position":{"start":{"line":41,"column":8,"offset":1320},"end":{"line":41,"column":27,"offset":1339}}},{"type":"html","value":"</small>","position":{"start":{"line":41,"column":27,"offset":1339},"end":{"line":41,"column":35,"offset":1347}}}],"position":{"start":{"line":41,"column":1,"offset":1313},"end":{"line":41,"column":35,"offset":1347}}},{"type":"paragraph","children":[{"type":"html","value":"<br>","position":{"start":{"line":43,"column":1,"offset":1349},"end":{"line":43,"column":5,"offset":1353}}},{"type":"emphasis","children":[{"type":"text","value":"ファイルがフォルダーに格納されるイメージ","position":{"start":{"line":43,"column":6,"offset":1354},"end":{"line":43,"column":26,"offset":1374}}}],"position":{"start":{"line":43,"column":5,"offset":1353},"end":{"line":43,"column":27,"offset":1375}}}],"position":{"start":{"line":43,"column":1,"offset":1349},"end":{"line":43,"column":27,"offset":1375}}},{"type":"html","lang":null,"meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">請求書/\n ├ invoice-00001.pdf\n ├ invoice-00002.png\n ├ invoice-00002.jpg\n │   ・・・\n └ invoice-00008.png</code></pre></div>","position":{"start":{"line":44,"column":1,"offset":1376},"end":{"line":51,"column":4,"offset":1481}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"スプシを準備","position":{"start":{"line":53,"column":4,"offset":1486},"end":{"line":53,"column":10,"offset":1492}}}],"position":{"start":{"line":53,"column":1,"offset":1483},"end":{"line":53,"column":10,"offset":1492}},"data":{"id":"スプシを準備","htmlAttributes":{"id":"スプシを準備"},"hProperties":{"id":"スプシを準備"}}},{"type":"paragraph","children":[{"type":"text","value":"まずは1こ、スプシを準備します。スプシ名は今回","position":{"start":{"line":54,"column":1,"offset":1493},"end":{"line":54,"column":24,"offset":1516}}},{"type":"emphasis","children":[{"type":"text","value":"請求書管理","position":{"start":{"line":54,"column":25,"offset":1517},"end":{"line":54,"column":30,"offset":1522}}}],"position":{"start":{"line":54,"column":24,"offset":1516},"end":{"line":54,"column":31,"offset":1523}}},{"type":"text","value":"とかにしておきましょう。","position":{"start":{"line":54,"column":31,"offset":1523},"end":{"line":54,"column":43,"offset":1535}}}],"position":{"start":{"line":54,"column":1,"offset":1493},"end":{"line":54,"column":43,"offset":1535}}},{"type":"paragraph","children":[{"type":"text","value":"今回は案件ごとに管理するため、","position":{"start":{"line":56,"column":1,"offset":1537},"end":{"line":56,"column":16,"offset":1552}}},{"type":"emphasis","children":[{"type":"text","value":"請求書","position":{"start":{"line":56,"column":17,"offset":1553},"end":{"line":56,"column":20,"offset":1556}}}],"position":{"start":{"line":56,"column":16,"offset":1552},"end":{"line":56,"column":21,"offset":1557}}},{"type":"text","value":"と","position":{"start":{"line":56,"column":21,"offset":1557},"end":{"line":56,"column":22,"offset":1558}}},{"type":"emphasis","children":[{"type":"text","value":"データ","position":{"start":{"line":56,"column":23,"offset":1559},"end":{"line":56,"column":26,"offset":1562}}}],"position":{"start":{"line":56,"column":22,"offset":1558},"end":{"line":56,"column":27,"offset":1563}}},{"type":"text","value":"の2つのシートを用意します。","position":{"start":{"line":56,"column":27,"offset":1563},"end":{"line":56,"column":41,"offset":1577}}}],"position":{"start":{"line":56,"column":1,"offset":1537},"end":{"line":56,"column":41,"offset":1577}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"「データ」シートに案件名、顧客名、ステータスを登録しておく","position":{"start":{"line":58,"column":5,"offset":1583},"end":{"line":58,"column":34,"offset":1612}}}],"position":{"start":{"line":58,"column":1,"offset":1579},"end":{"line":58,"column":34,"offset":1612}},"data":{"id":"「データ」シートに案件名、顧客名、ステータスを登録しておく","htmlAttributes":{"id":"「データ」シートに案件名、顧客名、ステータスを登録しておく"},"hProperties":{"id":"「データ」シートに案件名、顧客名、ステータスを登録しておく"}}},{"type":"paragraph","children":[{"type":"text","value":"データには「案件名」、「顧客名」、「ステータス」を登録しておきます。","position":{"start":{"line":59,"column":1,"offset":1613},"end":{"line":59,"column":35,"offset":1647}}}],"position":{"start":{"line":59,"column":1,"offset":1613},"end":{"line":59,"column":35,"offset":1647}}},{"type":"paragraph","children":[{"type":"text","value":"本来はシートを分けたほうがいいのですが、今回「ファイルをGoogleドライブに保存する方法のご紹介」なので、便宜上まとめています。","position":{"start":{"line":61,"column":1,"offset":1649},"end":{"line":61,"column":66,"offset":1714}}}],"position":{"start":{"line":61,"column":1,"offset":1649},"end":{"line":61,"column":66,"offset":1714}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-1.jpg","alt":"案件管理のシートに案件名とIDを登録","position":{"start":{"line":63,"column":1,"offset":1716},"end":{"line":63,"column":55,"offset":1770}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 144.30379746835442%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHtt0QAU86EAf/EABkQAQACAwAAAAAAAAAAAAAAABEAEAEgIf/aAAgBAQABBQIh3TFpf//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABUQAQEAAAAAAAAAAAAAAAAAAAEw/9oACAEBAAY/Amn/xAAbEAABBAMAAAAAAAAAAAAAAAABABARISAxof/aAAgBAQABPyHsjRBoMBT6YUt//9oADAMBAAIAAwAAABBwxzz/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAdEAEAAQQDAQAAAAAAAAAAAAABEQAQITFBgZHB/9oACAEBAAE/EBoh0gzp+UrKAZJ3YoOfb6bqCBME0NJjiuq//9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9d9a093ce18c281ef689907d9833cd18/81b7c/entry475-1.webp 158w,\n/static/9d9a093ce18c281ef689907d9833cd18/c85cb/entry475-1.webp 300w\"\n              sizes=\"(max-width: 300px) 100vw, 300px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9d9a093ce18c281ef689907d9833cd18/ff44c/entry475-1.jpg 158w,\n/static/9d9a093ce18c281ef689907d9833cd18/f93b5/entry475-1.jpg 300w\"\n            sizes=\"(max-width: 300px) 100vw, 300px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9d9a093ce18c281ef689907d9833cd18/f93b5/entry475-1.jpg\"\n            alt=\"案件管理のシートに案件名とIDを登録\"\n            title=\"案件管理のシートに案件名とIDを登録\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":63,"column":1,"offset":1716},"end":{"line":63,"column":55,"offset":1770}}},{"type":"paragraph","children":[{"type":"text","value":"C列に以下請求書のステータスを入力しておきます。","position":{"start":{"line":65,"column":1,"offset":1772},"end":{"line":65,"column":25,"offset":1796}}}],"position":{"start":{"line":65,"column":1,"offset":1772},"end":{"line":65,"column":25,"offset":1796}}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"請求書発行済","position":{"start":{"line":67,"column":3,"offset":1800},"end":{"line":67,"column":9,"offset":1806}}}],"position":{"start":{"line":67,"column":3,"offset":1800},"end":{"line":67,"column":9,"offset":1806}}}],"position":{"start":{"line":67,"column":1,"offset":1798},"end":{"line":67,"column":9,"offset":1806}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"請求中","position":{"start":{"line":68,"column":3,"offset":1809},"end":{"line":68,"column":6,"offset":1812}}}],"position":{"start":{"line":68,"column":3,"offset":1809},"end":{"line":68,"column":6,"offset":1812}}}],"position":{"start":{"line":68,"column":1,"offset":1807},"end":{"line":68,"column":6,"offset":1812}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"支払済","position":{"start":{"line":69,"column":3,"offset":1815},"end":{"line":69,"column":6,"offset":1818}}}],"position":{"start":{"line":69,"column":3,"offset":1815},"end":{"line":69,"column":6,"offset":1818}}}],"position":{"start":{"line":69,"column":1,"offset":1813},"end":{"line":69,"column":6,"offset":1818}}}],"position":{"start":{"line":67,"column":1,"offset":1798},"end":{"line":69,"column":6,"offset":1818}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"「請求書」シートに見出しなど登録","position":{"start":{"line":71,"column":5,"offset":1824},"end":{"line":71,"column":21,"offset":1840}}}],"position":{"start":{"line":71,"column":1,"offset":1820},"end":{"line":71,"column":21,"offset":1840}},"data":{"id":"「請求書」シートに見出しなど登録","htmlAttributes":{"id":"「請求書」シートに見出しなど登録"},"hProperties":{"id":"「請求書」シートに見出しなど登録"}}},{"type":"paragraph","children":[{"type":"text","value":"「請求書」シートをつくり、一行目にid、案件名、顧客名、ステータス、請求日、支払日を見出しとして登録しておきます。","position":{"start":{"line":72,"column":1,"offset":1841},"end":{"line":72,"column":58,"offset":1898}}}],"position":{"start":{"line":72,"column":1,"offset":1841},"end":{"line":72,"column":58,"offset":1898}}},{"type":"paragraph","children":[{"type":"text","value":"「データの入力規則」から、データシートのC列（$C$2:$C）の値を条件に設定しておきます。無効なデータの場合に「","position":{"start":{"line":74,"column":1,"offset":1900},"end":{"line":74,"column":58,"offset":1957}}},{"type":"emphasis","children":[{"type":"text","value":"入力を拒否","position":{"start":{"line":74,"column":59,"offset":1958},"end":{"line":74,"column":64,"offset":1963}}}],"position":{"start":{"line":74,"column":58,"offset":1957},"end":{"line":74,"column":65,"offset":1964}}},{"type":"text","value":"」にチェックを入れておきます。","position":{"start":{"line":74,"column":65,"offset":1964},"end":{"line":74,"column":80,"offset":1979}}}],"position":{"start":{"line":74,"column":1,"offset":1900},"end":{"line":74,"column":80,"offset":1979}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-2.jpg","alt":"案件管理のシートに案件名とIDを登録","position":{"start":{"line":76,"column":1,"offset":1981},"end":{"line":76,"column":55,"offset":2035}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.291139240506325%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECBAX/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAd1iJFUmf//EABcQAQADAAAAAAAAAAAAAAAAAAEAAyD/2gAIAQEAAQUCyWM//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQMBAT8BV//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABMSD/2gAIAQEABj8Cy5T/xAAaEAADAQADAAAAAAAAAAAAAAAAAREhEDFR/9oACAEBAAE/IXk9LxEdDLxiD//aAAwDAQACAAMAAAAQM/8A/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQMBAT8QS//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/EFf/xAAbEAEAAwEAAwAAAAAAAAAAAAABABExIVGBkf/aAAgBAQABPxAF1/UG8q/MOmVGrINCjWHr0hQ4e5//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2484c1a8180e4ada289159e7db70f074/81b7c/entry475-2.webp 158w,\n/static/2484c1a8180e4ada289159e7db70f074/c85cb/entry475-2.webp 300w\"\n              sizes=\"(max-width: 300px) 100vw, 300px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2484c1a8180e4ada289159e7db70f074/ff44c/entry475-2.jpg 158w,\n/static/2484c1a8180e4ada289159e7db70f074/f93b5/entry475-2.jpg 300w\"\n            sizes=\"(max-width: 300px) 100vw, 300px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2484c1a8180e4ada289159e7db70f074/f93b5/entry475-2.jpg\"\n            alt=\"案件管理のシートに案件名とIDを登録\"\n            title=\"案件管理のシートに案件名とIDを登録\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":76,"column":1,"offset":1981},"end":{"line":76,"column":55,"offset":2035}}},{"type":"paragraph","children":[{"type":"text","value":"これでシートの下準備は完成です！","position":{"start":{"line":78,"column":1,"offset":2037},"end":{"line":78,"column":17,"offset":2053}}}],"position":{"start":{"line":78,"column":1,"offset":2037},"end":{"line":78,"column":17,"offset":2053}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-3.jpg","alt":"シートの下準備は完成","position":{"start":{"line":80,"column":1,"offset":2055},"end":{"line":80,"column":47,"offset":2101}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 350px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.41772151898735%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe3TSQf/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAVEAEBAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwKL/8QAGBABAAMBAAAAAAAAAAAAAAAAEQABECH/2gAIAQEAAT8hDtR0xojn/9oADAMBAAIAAwAAABDjz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAAICAQUAAAAAAAAAAAAAAAABETFRECFBcZH/2gAIAQEAAT8QcMCuGKx4yPt+i2jdDSI0/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1ecfd0268cc61df40a7f8747a306599d/81b7c/entry475-3.webp 158w,\n/static/1ecfd0268cc61df40a7f8747a306599d/6ea66/entry475-3.webp 315w,\n/static/1ecfd0268cc61df40a7f8747a306599d/a3432/entry475-3.webp 350w\"\n              sizes=\"(max-width: 350px) 100vw, 350px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1ecfd0268cc61df40a7f8747a306599d/ff44c/entry475-3.jpg 158w,\n/static/1ecfd0268cc61df40a7f8747a306599d/a6688/entry475-3.jpg 315w,\n/static/1ecfd0268cc61df40a7f8747a306599d/70ebb/entry475-3.jpg 350w\"\n            sizes=\"(max-width: 350px) 100vw, 350px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1ecfd0268cc61df40a7f8747a306599d/70ebb/entry475-3.jpg\"\n            alt=\"シートの下準備は完成\"\n            title=\"シートの下準備は完成\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":80,"column":1,"offset":2055},"end":{"line":80,"column":47,"offset":2101}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"GASのプロジェクト作成","position":{"start":{"line":82,"column":4,"offset":2106},"end":{"line":82,"column":16,"offset":2118}}}],"position":{"start":{"line":82,"column":1,"offset":2103},"end":{"line":82,"column":16,"offset":2118}},"data":{"id":"gasのプロジェクト作成","htmlAttributes":{"id":"gasのプロジェクト作成"},"hProperties":{"id":"gasのプロジェクト作成"}}},{"type":"paragraph","children":[{"type":"text","value":"Google Apps Script（GAS）のプロジェクトを作成します。","position":{"start":{"line":83,"column":1,"offset":2119},"end":{"line":83,"column":38,"offset":2156}}}],"position":{"start":{"line":83,"column":1,"offset":2119},"end":{"line":83,"column":38,"offset":2156}}},{"type":"paragraph","children":[{"type":"text","value":"先ほど作ったスプシから「メニュー」 > 「ツール」 > 「スクリプトエディタ」を開きます。","position":{"start":{"line":85,"column":1,"offset":2158},"end":{"line":85,"column":46,"offset":2203}}}],"position":{"start":{"line":85,"column":1,"offset":2158},"end":{"line":85,"column":46,"offset":2203}}},{"type":"paragraph","children":[{"type":"text","value":"このままだと左上のタイトルが「無題のプロジェクト」なっているので、そこをクリックしてプロジェクト名を管理上変更します。ここでは「請求書作成」としておきます。","position":{"start":{"line":87,"column":1,"offset":2205},"end":{"line":87,"column":79,"offset":2283}}}],"position":{"start":{"line":87,"column":1,"offset":2205},"end":{"line":87,"column":79,"offset":2283}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-5.jpg","alt":"プロジェクト名を請求書作成に変更","position":{"start":{"line":89,"column":1,"offset":2285},"end":{"line":89,"column":53,"offset":2337}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.69620253164557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEE/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABunHAD//EABgQAQEAAwAAAAAAAAAAAAAAAAIDARIg/9oACAEBAAEFApnZUhgjj//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABESD/2gAIAQEABj8Cg3c//8QAGRABAAIDAAAAAAAAAAAAAAAAAQBBESBR/9oACAEBAAE/IRN3yZKlKdf/2gAMAwEAAgADAAAAENgP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAIDAQAAAAAAAAAAAAAAARExABBBYf/aAAgBAQABPxBHEJcTWQQaIBF4g2Dqfdf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d46ec16eddd169d74facf616dcfc44d5/81b7c/entry475-5.webp 158w,\n/static/d46ec16eddd169d74facf616dcfc44d5/6ea66/entry475-5.webp 315w,\n/static/d46ec16eddd169d74facf616dcfc44d5/7f61c/entry475-5.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d46ec16eddd169d74facf616dcfc44d5/ff44c/entry475-5.jpg 158w,\n/static/d46ec16eddd169d74facf616dcfc44d5/a6688/entry475-5.jpg 315w,\n/static/d46ec16eddd169d74facf616dcfc44d5/066f9/entry475-5.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d46ec16eddd169d74facf616dcfc44d5/066f9/entry475-5.jpg\"\n            alt=\"プロジェクト名を請求書作成に変更\"\n            title=\"プロジェクト名を請求書作成に変更\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":89,"column":1,"offset":2285},"end":{"line":89,"column":53,"offset":2337}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Chrome V8 ランタイムを無効にする（2021年6月現在）","position":{"start":{"line":91,"column":5,"offset":2343},"end":{"line":91,"column":37,"offset":2375}}}],"position":{"start":{"line":91,"column":1,"offset":2339},"end":{"line":91,"column":37,"offset":2375}},"data":{"id":"chrome-v8-ランタイムを無効にする（2021年6月現在）","htmlAttributes":{"id":"chrome-v8-ランタイムを無効にする（2021年6月現在）"},"hProperties":{"id":"chrome-v8-ランタイムを無効にする（2021年6月現在）"}}},{"type":"paragraph","children":[{"type":"text","value":"Chrome V8 ランタイムが有効だとファイルがアップロードできません。設定から、チェックを外しておきます。","position":{"start":{"line":92,"column":1,"offset":2376},"end":{"line":92,"column":56,"offset":2431}}}],"position":{"start":{"line":92,"column":1,"offset":2376},"end":{"line":92,"column":56,"offset":2431}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-11.jpg","alt":"Chrome V8 ランタイムが有効のチェックを外しておく","position":{"start":{"line":94,"column":1,"offset":2433},"end":{"line":94,"column":67,"offset":2499}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdy0gD//xAAWEAADAAAAAAAAAAAAAAAAAAAAESD/2gAIAQEAAQUCHP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGBABAQADAAAAAAAAAAAAAAAAEQEQICH/2gAIAQEAAT8h4hhK6f/aAAwDAQACAAMAAAAQsM//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgIDAAAAAAAAAAAAAAABABExcRBBUf/aAAgBAQABPxDJ0UxBmjbAFiOpR5K4/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/deff603fb6f3fd1534ad4f8f31864e65/81b7c/entry475-11.webp 158w,\n/static/deff603fb6f3fd1534ad4f8f31864e65/6ea66/entry475-11.webp 315w,\n/static/deff603fb6f3fd1534ad4f8f31864e65/7f61c/entry475-11.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/deff603fb6f3fd1534ad4f8f31864e65/ff44c/entry475-11.jpg 158w,\n/static/deff603fb6f3fd1534ad4f8f31864e65/a6688/entry475-11.jpg 315w,\n/static/deff603fb6f3fd1534ad4f8f31864e65/066f9/entry475-11.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/deff603fb6f3fd1534ad4f8f31864e65/066f9/entry475-11.jpg\"\n            alt=\"Chrome V8 ランタイムが有効のチェックを外しておく\"\n            title=\"Chrome V8 ランタイムが有効のチェックを外しておく\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":94,"column":1,"offset":2433},"end":{"line":94,"column":67,"offset":2499}}},{"type":"paragraph","children":[{"type":"text","value":"ただ、チェックを外すとテンプレートリテラルやletなど新しめのコードが書けなくなります。","position":{"start":{"line":96,"column":1,"offset":2501},"end":{"line":96,"column":45,"offset":2545}}}],"position":{"start":{"line":96,"column":1,"offset":2501},"end":{"line":96,"column":45,"offset":2545}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"アップロード用のモーダルパーツを作成（UI追加）","position":{"start":{"line":98,"column":4,"offset":2550},"end":{"line":98,"column":28,"offset":2574}}}],"position":{"start":{"line":98,"column":1,"offset":2547},"end":{"line":98,"column":28,"offset":2574}},"data":{"id":"アップロード用のモーダルパーツを作成（ui追加）","htmlAttributes":{"id":"アップロード用のモーダルパーツを作成（ui追加）"},"hProperties":{"id":"アップロード用のモーダルパーツを作成（ui追加）"}}},{"type":"paragraph","children":[{"type":"text","value":"フォームアップロード用のHTMLファイルを追加します。追加の仕方はスクリプトエディタの左のメニュー、「ファイル」から「HTML」を選びます。","position":{"start":{"line":99,"column":1,"offset":2575},"end":{"line":99,"column":71,"offset":2645}}}],"position":{"start":{"line":99,"column":1,"offset":2575},"end":{"line":99,"column":71,"offset":2645}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-6.jpg","alt":"フォームアップロード用のHTMLファイルを追加","position":{"start":{"line":101,"column":1,"offset":2647},"end":{"line":101,"column":60,"offset":2706}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.278481012658226%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAG8AD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAVEAEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAQABPyGP/9oADAMBAAIAAwAAABADz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABcQAQEBAQAAAAAAAAAAAAAAAAERAFH/2gAIAQEAAT8QZiOr11e7/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b6b19550d164948ffdfa662e73f87bf6/81b7c/entry475-6.webp 158w,\n/static/b6b19550d164948ffdfa662e73f87bf6/6ea66/entry475-6.webp 315w,\n/static/b6b19550d164948ffdfa662e73f87bf6/8aab1/entry475-6.webp 630w,\n/static/b6b19550d164948ffdfa662e73f87bf6/a70f5/entry475-6.webp 945w,\n/static/b6b19550d164948ffdfa662e73f87bf6/e89d6/entry475-6.webp 1155w\"\n              sizes=\"(max-width: 630px) 100vw, 630px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b6b19550d164948ffdfa662e73f87bf6/ff44c/entry475-6.jpg 158w,\n/static/b6b19550d164948ffdfa662e73f87bf6/a6688/entry475-6.jpg 315w,\n/static/b6b19550d164948ffdfa662e73f87bf6/828fb/entry475-6.jpg 630w,\n/static/b6b19550d164948ffdfa662e73f87bf6/0ede0/entry475-6.jpg 945w,\n/static/b6b19550d164948ffdfa662e73f87bf6/86556/entry475-6.jpg 1155w\"\n            sizes=\"(max-width: 630px) 100vw, 630px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b6b19550d164948ffdfa662e73f87bf6/828fb/entry475-6.jpg\"\n            alt=\"フォームアップロード用のHTMLファイルを追加\"\n            title=\"フォームアップロード用のHTMLファイルを追加\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":101,"column":1,"offset":2647},"end":{"line":101,"column":60,"offset":2706}}},{"type":"paragraph","children":[{"type":"text","value":"今回はファイル名を「upload」としておきました。これでUIパーツ用の「upload.html」ファイルができます。","position":{"start":{"line":103,"column":1,"offset":2708},"end":{"line":103,"column":60,"offset":2767}}}],"position":{"start":{"line":103,"column":1,"offset":2708},"end":{"line":103,"column":60,"offset":2767}}},{"type":"paragraph","children":[{"type":"text","value":"ファイル作成直後のデフォルトコードはこんな感じ。","position":{"start":{"line":105,"column":1,"offset":2769},"end":{"line":105,"column":25,"offset":2793}}}],"position":{"start":{"line":105,"column":1,"offset":2769},"end":{"line":105,"column":25,"offset":2793}}},{"type":"html","lang":"html","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>base</span> <span class=\"token attr-name\">target</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>_top<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span>\n</code></pre></div>","position":{"start":{"line":107,"column":1,"offset":2795},"end":{"line":118,"column":4,"offset":2902}}},{"type":"paragraph","children":[{"type":"text","value":"このフォームで入力した日付、案件、ファイルをサーバー側へ送信できるようにします。","position":{"start":{"line":120,"column":1,"offset":2904},"end":{"line":120,"column":41,"offset":2944}}}],"position":{"start":{"line":120,"column":1,"offset":2904},"end":{"line":120,"column":41,"offset":2944}}},{"type":"paragraph","children":[{"type":"text","value":"各パーツを表示するためのコードを書きます。","position":{"start":{"line":122,"column":1,"offset":2946},"end":{"line":122,"column":22,"offset":2967}}}],"position":{"start":{"line":122,"column":1,"offset":2946},"end":{"line":122,"column":22,"offset":2967}}},{"type":"paragraph","children":[{"type":"text","value":"案件のプルダウン用の部分は、シートからデータを取ってくるので後ほどコードを追加します。","position":{"start":{"line":124,"column":1,"offset":2969},"end":{"line":124,"column":44,"offset":3012}}}],"position":{"start":{"line":124,"column":1,"offset":2969},"end":{"line":124,"column":44,"offset":3012}}},{"type":"html","lang":"html","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>base</span> <span class=\"token attr-name\">target</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>_top<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://ssl.gstatic.com/docs/script/css/add-ons.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n        発行日：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>date<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>date<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n      プロジェクト名：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>project<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token comment\">&lt;!--項目は後で追加--></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n      ファイル：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>ファイルをアップロードする<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":126,"column":1,"offset":3014},"end":{"line":150,"column":4,"offset":3506}}},{"type":"paragraph","children":[{"type":"html","value":"<small>","position":{"start":{"line":151,"column":1,"offset":3507},"end":{"line":151,"column":8,"offset":3514}}},{"type":"text","value":"※ ここではinputのtype=dateを使っていますが一部のブラウザで機能しません。Chromeを利用することを前提で進めています。","position":{"start":{"line":151,"column":8,"offset":3514},"end":{"line":151,"column":76,"offset":3582}}},{"type":"html","value":"</small>","position":{"start":{"line":151,"column":76,"offset":3582},"end":{"line":151,"column":84,"offset":3590}}}],"position":{"start":{"line":151,"column":1,"offset":3507},"end":{"line":151,"column":84,"offset":3590}}},{"type":"paragraph","children":[{"type":"html","value":"<br>","position":{"start":{"line":153,"column":1,"offset":3592},"end":{"line":153,"column":5,"offset":3596}}},{"type":"text","value":"モーダルを表示するため「コード.gs」に以下関数を追加。","position":{"start":{"line":153,"column":5,"offset":3596},"end":{"line":153,"column":33,"offset":3624}}}],"position":{"start":{"line":153,"column":1,"offset":3592},"end":{"line":153,"column":33,"offset":3624}}},{"type":"html","lang":"js","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">showModal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> output <span class=\"token operator\">=</span> HtmlService<span class=\"token punctuation\">.</span><span class=\"token function\">createTemplateFromFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'upload'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> output<span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":156,"column":1,"offset":3627},"end":{"line":163,"column":4,"offset":3845}}},{"type":"paragraph","children":[{"type":"text","value":"関数名が「showModal」になっているのを確認して実行します。","position":{"start":{"line":165,"column":1,"offset":3847},"end":{"line":165,"column":34,"offset":3880}}}],"position":{"start":{"line":165,"column":1,"offset":3847},"end":{"line":165,"column":34,"offset":3880}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-12.jpg","alt":"権限","position":{"start":{"line":167,"column":1,"offset":3882},"end":{"line":167,"column":40,"offset":3921}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 614px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.911392405063296%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAduQsD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAYEAEBAAMAAAAAAAAAAAAAAAARAQAQYf/aAAgBAQABPyGq4Xmv/9oADAMBAAIAAwAAABCID//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhYf/aAAgBAQABPxAOQMwTQK+OFnXu/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/12faa0a5f39552b109594855f00fc3e6/81b7c/entry475-12.webp 158w,\n/static/12faa0a5f39552b109594855f00fc3e6/6ea66/entry475-12.webp 315w,\n/static/12faa0a5f39552b109594855f00fc3e6/5316f/entry475-12.webp 614w\"\n              sizes=\"(max-width: 614px) 100vw, 614px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/12faa0a5f39552b109594855f00fc3e6/ff44c/entry475-12.jpg 158w,\n/static/12faa0a5f39552b109594855f00fc3e6/a6688/entry475-12.jpg 315w,\n/static/12faa0a5f39552b109594855f00fc3e6/9453e/entry475-12.jpg 614w\"\n            sizes=\"(max-width: 614px) 100vw, 614px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/12faa0a5f39552b109594855f00fc3e6/9453e/entry475-12.jpg\"\n            alt=\"権限\"\n            title=\"権限\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":167,"column":1,"offset":3882},"end":{"line":167,"column":40,"offset":3921}}},{"type":"heading","depth":4,"children":[{"type":"text","value":"権限の許可","position":{"start":{"line":169,"column":6,"offset":3928},"end":{"line":169,"column":11,"offset":3933}}}],"position":{"start":{"line":169,"column":1,"offset":3923},"end":{"line":169,"column":11,"offset":3933}},"data":{"id":"権限の許可","htmlAttributes":{"id":"権限の許可"},"hProperties":{"id":"権限の許可"}}},{"type":"paragraph","children":[{"type":"text","value":"権限を求められるので、許可します。","position":{"start":{"line":171,"column":1,"offset":3935},"end":{"line":171,"column":18,"offset":3952}}}],"position":{"start":{"line":171,"column":1,"offset":3935},"end":{"line":171,"column":18,"offset":3952}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-7.jpg","alt":"権限","position":{"start":{"line":173,"column":1,"offset":3954},"end":{"line":173,"column":39,"offset":3992}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.9493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAEDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHu0KzJ/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAIRIP/aAAgBAQABBQKlxGP/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAAICFBkf/aAAgBAQAGPwKVrD//xAAbEAEAAgIDAAAAAAAAAAAAAAABABEQIUFR4f/aAAgBAQABPyEXiVwHdRNaq4cjL//aAAwDAQACAAMAAAAQM/8A/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/EK1//8QAFhEBAQEAAAAAAAAAAAAAAAAAABFh/9oACAECAQE/EE1//8QAHRABAAMAAgMBAAAAAAAAAAAAAQARITFBUWFxwf/aAAgBAQABPxAg4W3h1eQTpPpLHhINYT5CMvKmKWXKu59I/Z//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/500ca81d9c3d3ada6e8f8277732c0e26/81b7c/entry475-7.webp 158w,\n/static/500ca81d9c3d3ada6e8f8277732c0e26/c85cb/entry475-7.webp 300w\"\n              sizes=\"(max-width: 300px) 100vw, 300px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/500ca81d9c3d3ada6e8f8277732c0e26/ff44c/entry475-7.jpg 158w,\n/static/500ca81d9c3d3ada6e8f8277732c0e26/f93b5/entry475-7.jpg 300w\"\n            sizes=\"(max-width: 300px) 100vw, 300px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/500ca81d9c3d3ada6e8f8277732c0e26/f93b5/entry475-7.jpg\"\n            alt=\"権限\"\n            title=\"権限\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":173,"column":1,"offset":3954},"end":{"line":173,"column":39,"offset":3992}}},{"type":"paragraph","children":[{"type":"text","value":"左下の「詳細」を押して、「プロジェクト名（安全じゃないページ）に移動」をクリックします。","position":{"start":{"line":175,"column":1,"offset":3994},"end":{"line":175,"column":45,"offset":4038}}}],"position":{"start":{"line":175,"column":1,"offset":3994},"end":{"line":175,"column":45,"offset":4038}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-8.jpg","alt":"権限","position":{"start":{"line":177,"column":1,"offset":4040},"end":{"line":177,"column":39,"offset":4078}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.78481012658228%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHZsFkE/8QAFxABAAMAAAAAAAAAAAAAAAAAAAESMf/aAAgBAQABBQKyMf/EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/AWf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAYEAEBAAMAAAAAAAAAAAAAAAABABEhwf/aAAgBAQABPyEVsHti/9oADAMBAAIAAwAAABB8D//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/EAE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhAAAgIDAAAAAAAAAAAAAAAAAREAMVGRof/aAAgBAQABPxBKumCCDZDtEydmf//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8cc819ab10ce1c82634a6a1a7b6b1128/81b7c/entry475-8.webp 158w,\n/static/8cc819ab10ce1c82634a6a1a7b6b1128/c85cb/entry475-8.webp 300w\"\n              sizes=\"(max-width: 300px) 100vw, 300px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8cc819ab10ce1c82634a6a1a7b6b1128/ff44c/entry475-8.jpg 158w,\n/static/8cc819ab10ce1c82634a6a1a7b6b1128/f93b5/entry475-8.jpg 300w\"\n            sizes=\"(max-width: 300px) 100vw, 300px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8cc819ab10ce1c82634a6a1a7b6b1128/f93b5/entry475-8.jpg\"\n            alt=\"権限\"\n            title=\"権限\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":177,"column":1,"offset":4040},"end":{"line":177,"column":39,"offset":4078}}},{"type":"paragraph","children":[{"type":"text","value":"あとはアクセスの許可をすればOK。","position":{"start":{"line":179,"column":1,"offset":4080},"end":{"line":179,"column":18,"offset":4097}}}],"position":{"start":{"line":179,"column":1,"offset":4080},"end":{"line":179,"column":18,"offset":4097}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-9.jpg","alt":"権限","position":{"start":{"line":181,"column":1,"offset":4099},"end":{"line":181,"column":39,"offset":4137}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 160.75949367088606%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAgABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIBAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB9zGpYXmoUgf/xAAaEAACAwEBAAAAAAAAAAAAAAABEQAQIQJB/9oACAEBAAEFAjNr2iY6WlCclj//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAZEAACAwEAAAAAAAAAAAAAAAAAMQERIHH/2gAIAQEABj8CY8rFimOn/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARITFBURD/2gAIAQEAAT8hDd2gJ2hqPhIY6XCZMwA4QbPgAaLUO8B4Kn//2gAMAwEAAgADAAAAELwOjv/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8Qsdn/xAAYEQEAAwEAAAAAAAAAAAAAAAABABARIf/aAAgBAgEBPxBrImcZ/8QAHhABAQEAAgEFAAAAAAAAAAAAAREAITFxQWGBkdH/2gAIAQEAAT8QGgQvUuaUPad4pC1zPI2qOR2P5OVOx8bmgMeHn8yEJesuIE6yVLc5ZSwKvgxM6ZyX1v/Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bb7dda8610f36e441669f660747d3df8/81b7c/entry475-9.webp 158w,\n/static/bb7dda8610f36e441669f660747d3df8/ba381/entry475-9.webp 200w\"\n              sizes=\"(max-width: 200px) 100vw, 200px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bb7dda8610f36e441669f660747d3df8/ff44c/entry475-9.jpg 158w,\n/static/bb7dda8610f36e441669f660747d3df8/e07e9/entry475-9.jpg 200w\"\n            sizes=\"(max-width: 200px) 100vw, 200px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bb7dda8610f36e441669f660747d3df8/e07e9/entry475-9.jpg\"\n            alt=\"権限\"\n            title=\"権限\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":181,"column":1,"offset":4099},"end":{"line":181,"column":39,"offset":4137}}},{"type":"paragraph","children":[{"type":"text","value":"これでスプシ側にファイルアップロード用のフォーム（UI）が表示できるようになりました。\n","position":{"start":{"line":183,"column":1,"offset":4139},"end":{"line":184,"column":1,"offset":4183}}},{"type":"html","title":null,"url":"./images/2021/06/entry475-10.jpg","alt":"アップロード用のUI完成","position":{"start":{"line":184,"column":1,"offset":4183},"end":{"line":184,"column":50,"offset":4232}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.79746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe9NCKP/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAADAAMAAAAAAAAAAAAAAAAAAREgUXH/2gAIAQEAAT8hi0LhMP/aAAwDAQACAAMAAAAQQw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAADAAIDAAAAAAAAAAAAAAAAAREQIVFhcf/aAAgBAQABPxCTqS+EtzVLqDTjFKf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/85ec3c2752ecbe8a70bf63b69db14cce/81b7c/entry475-10.webp 158w,\n/static/85ec3c2752ecbe8a70bf63b69db14cce/6ea66/entry475-10.webp 315w,\n/static/85ec3c2752ecbe8a70bf63b69db14cce/7f61c/entry475-10.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/85ec3c2752ecbe8a70bf63b69db14cce/ff44c/entry475-10.jpg 158w,\n/static/85ec3c2752ecbe8a70bf63b69db14cce/a6688/entry475-10.jpg 315w,\n/static/85ec3c2752ecbe8a70bf63b69db14cce/066f9/entry475-10.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/85ec3c2752ecbe8a70bf63b69db14cce/066f9/entry475-10.jpg\"\n            alt=\"アップロード用のUI完成\"\n            title=\"アップロード用のUI完成\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":183,"column":1,"offset":4139},"end":{"line":184,"column":50,"offset":4232}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"値がGAS（サーバー側）で受け取れるかチェック","position":{"start":{"line":186,"column":5,"offset":4238},"end":{"line":186,"column":28,"offset":4261}}}],"position":{"start":{"line":186,"column":1,"offset":4234},"end":{"line":186,"column":28,"offset":4261}},"data":{"id":"値がgas（サーバー側）で受け取れるかチェック","htmlAttributes":{"id":"値がgas（サーバー側）で受け取れるかチェック"},"hProperties":{"id":"値がgas（サーバー側）で受け取れるかチェック"}}},{"type":"paragraph","children":[{"type":"text","value":"フォームの値がGAS（サーバー側）に送れるかチェックします。","position":{"start":{"line":187,"column":1,"offset":4262},"end":{"line":187,"column":31,"offset":4292}}}],"position":{"start":{"line":187,"column":1,"offset":4262},"end":{"line":187,"column":31,"offset":4292}}},{"type":"paragraph","children":[{"type":"text","value":"ボタンのコードを書き換えます。","position":{"start":{"line":189,"column":1,"offset":4294},"end":{"line":189,"column":16,"offset":4309}}},{"type":"html","value":"<br>","position":{"start":{"line":189,"column":16,"offset":4309},"end":{"line":189,"column":20,"offset":4313}}},{"type":"text","value":"\n","position":{"start":{"line":189,"column":20,"offset":4313},"end":{"line":190,"column":1,"offset":4314}}},{"type":"html","value":"<code class=\"language-text\">google.script.run.関数名</code>","position":{"start":{"line":190,"column":1,"offset":4314},"end":{"line":190,"column":24,"offset":4337}}},{"type":"text","value":"でGAS側にデータを送信できます。","position":{"start":{"line":190,"column":24,"offset":4337},"end":{"line":190,"column":41,"offset":4354}}}],"position":{"start":{"line":189,"column":1,"offset":4294},"end":{"line":190,"column":41,"offset":4354}}},{"type":"paragraph","children":[{"type":"text","value":"ボタンの親タグである","position":{"start":{"line":192,"column":1,"offset":4356},"end":{"line":192,"column":11,"offset":4366}}},{"type":"html","value":"<code class=\"language-text\">form</code>","position":{"start":{"line":192,"column":11,"offset":4366},"end":{"line":192,"column":17,"offset":4372}}},{"type":"text","value":"タグのデータを送信したいので引数を","position":{"start":{"line":192,"column":17,"offset":4372},"end":{"line":192,"column":34,"offset":4389}}},{"type":"html","value":"<code class=\"language-text\">this.parentNode</code>","position":{"start":{"line":192,"column":34,"offset":4389},"end":{"line":192,"column":51,"offset":4406}}},{"type":"text","value":"とします。","position":{"start":{"line":192,"column":51,"offset":4406},"end":{"line":192,"column":56,"offset":4411}}}],"position":{"start":{"line":192,"column":1,"offset":4356},"end":{"line":192,"column":56,"offset":4411}}},{"type":"html","lang":"html","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\">google<span class=\"token punctuation\">.</span>script<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">.</span><span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span> <span class=\"token punctuation\">></span></span>ファイルをアップロードする<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":194,"column":1,"offset":4413},"end":{"line":196,"column":4,"offset":4524}}},{"type":"paragraph","children":[{"type":"text","value":"さらに「コード.js」側にも","position":{"start":{"line":198,"column":1,"offset":4526},"end":{"line":198,"column":15,"offset":4540}}},{"type":"html","value":"<code class=\"language-text\">sendForm</code>","position":{"start":{"line":198,"column":15,"offset":4540},"end":{"line":198,"column":25,"offset":4550}}},{"type":"text","value":"関数を追加し、データの取得を確認します。","position":{"start":{"line":198,"column":25,"offset":4550},"end":{"line":198,"column":45,"offset":4570}}}],"position":{"start":{"line":198,"column":1,"offset":4526},"end":{"line":198,"column":45,"offset":4570}}},{"type":"html","lang":"js","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">form</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":200,"column":1,"offset":4572},"end":{"line":204,"column":4,"offset":4629}}},{"type":"paragraph","children":[{"type":"text","value":"関数「showModal」を実行し、スプレットシート側でファイルや日付を入力し、「アップロード」ボタンをクリックします。","position":{"start":{"line":205,"column":1,"offset":4630},"end":{"line":205,"column":61,"offset":4690}}}],"position":{"start":{"line":205,"column":1,"offset":4630},"end":{"line":205,"column":61,"offset":4690}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-13.jpg","alt":"アップロード用のUI完成","position":{"start":{"line":207,"column":1,"offset":4692},"end":{"line":207,"column":50,"offset":4741}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.51898734177216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3aAD/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFxABAAMAAAAAAAAAAAAAAAAAAREg4f/aAAgBAQABPyFWct//2gAMAwEAAgADAAAAEHAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGRABAQEBAQEAAAAAAAAAAAAAAQARITFR/9oACAEBAAE/EBcOnw1HTybbSW//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7ffa7d3359ba144b28f7e31619389adc/81b7c/entry475-13.webp 158w,\n/static/7ffa7d3359ba144b28f7e31619389adc/6ea66/entry475-13.webp 315w,\n/static/7ffa7d3359ba144b28f7e31619389adc/7f61c/entry475-13.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7ffa7d3359ba144b28f7e31619389adc/ff44c/entry475-13.jpg 158w,\n/static/7ffa7d3359ba144b28f7e31619389adc/a6688/entry475-13.jpg 315w,\n/static/7ffa7d3359ba144b28f7e31619389adc/066f9/entry475-13.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7ffa7d3359ba144b28f7e31619389adc/066f9/entry475-13.jpg\"\n            alt=\"アップロード用のUI完成\"\n            title=\"アップロード用のUI完成\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":207,"column":1,"offset":4692},"end":{"line":207,"column":50,"offset":4741}}},{"type":"paragraph","children":[{"type":"text","value":"左メニューの「","position":{"start":{"line":209,"column":1,"offset":4743},"end":{"line":209,"column":8,"offset":4750}}},{"type":"emphasis","children":[{"type":"text","value":"実行数","position":{"start":{"line":209,"column":9,"offset":4751},"end":{"line":209,"column":12,"offset":4754}}}],"position":{"start":{"line":209,"column":8,"offset":4750},"end":{"line":209,"column":13,"offset":4755}}},{"type":"text","value":"」から最新の関数「sendForm」を確認します。値が取得できていたらOK！","position":{"start":{"line":209,"column":13,"offset":4755},"end":{"line":209,"column":51,"offset":4793}}}],"position":{"start":{"line":209,"column":1,"offset":4743},"end":{"line":209,"column":51,"offset":4793}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-14.jpg","alt":"","position":{"start":{"line":211,"column":1,"offset":4795},"end":{"line":211,"column":38,"offset":4832}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 450px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.46835443037975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe6rSFj/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAACAgMAAAAAAAAAAAAAAAAAIQERIFFh/9oACAEBAAE/IWXPB6w//9oADAMBAAIAAwAAABBjD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAQADAQEAAAAAAAAAAAAAAAEAETGREP/aAAgBAQABPxAQ4TGjqN3HYZ7/AP/Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1e578d187ce5a581d12943f36dd15f1e/81b7c/entry475-14.webp 158w,\n/static/1e578d187ce5a581d12943f36dd15f1e/6ea66/entry475-14.webp 315w,\n/static/1e578d187ce5a581d12943f36dd15f1e/8626f/entry475-14.webp 450w\"\n              sizes=\"(max-width: 450px) 100vw, 450px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1e578d187ce5a581d12943f36dd15f1e/ff44c/entry475-14.jpg 158w,\n/static/1e578d187ce5a581d12943f36dd15f1e/a6688/entry475-14.jpg 315w,\n/static/1e578d187ce5a581d12943f36dd15f1e/20e5d/entry475-14.jpg 450w\"\n            sizes=\"(max-width: 450px) 100vw, 450px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1e578d187ce5a581d12943f36dd15f1e/20e5d/entry475-14.jpg\"\n            alt=\"entry475 14\"\n            title=\"entry475 14\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":211,"column":1,"offset":4795},"end":{"line":211,"column":38,"offset":4832}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"日付のデフォルト値と案件一覧のプルダウンを追加するコードを書く","position":{"start":{"line":214,"column":5,"offset":4839},"end":{"line":214,"column":36,"offset":4870}}}],"position":{"start":{"line":214,"column":1,"offset":4835},"end":{"line":214,"column":36,"offset":4870}},"data":{"id":"日付のデフォルト値と案件一覧のプルダウンを追加するコードを書く","htmlAttributes":{"id":"日付のデフォルト値と案件一覧のプルダウンを追加するコードを書く"},"hProperties":{"id":"日付のデフォルト値と案件一覧のプルダウンを追加するコードを書く"}}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">showModal</code>","position":{"start":{"line":215,"column":1,"offset":4871},"end":{"line":215,"column":12,"offset":4882}}},{"type":"text","value":"にコードを追記します。","position":{"start":{"line":215,"column":12,"offset":4882},"end":{"line":215,"column":23,"offset":4893}}}],"position":{"start":{"line":215,"column":1,"offset":4871},"end":{"line":215,"column":23,"offset":4893}}},{"type":"paragraph","children":[{"type":"text","value":"日付のデフォルト値を追加します。今日にします。値はゼロパティングで","position":{"start":{"line":217,"column":1,"offset":4895},"end":{"line":217,"column":34,"offset":4928}}},{"type":"html","value":"<code class=\"language-text\">0000-00-00</code>","position":{"start":{"line":217,"column":34,"offset":4928},"end":{"line":217,"column":46,"offset":4940}}},{"type":"text","value":"年は4桁、月と日は2桁になるように調整します。","position":{"start":{"line":217,"column":46,"offset":4940},"end":{"line":217,"column":69,"offset":4963}}}],"position":{"start":{"line":217,"column":1,"offset":4895},"end":{"line":217,"column":69,"offset":4963}}},{"type":"html","lang":"js","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//省略</span>\n<span class=\"token keyword\">const</span> output <span class=\"token operator\">=</span> HtmlService<span class=\"token punctuation\">.</span><span class=\"token function\">createTemplateFromFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'upload'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//元々あるコード</span>\n<span class=\"token comment\">//省略</span>\n<span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\noutput<span class=\"token punctuation\">.</span>date <span class=\"token operator\">=</span> date<span class=\"token punctuation\">.</span><span class=\"token function\">getFullYear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'-'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getMonth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'-'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span> <span class=\"token operator\">+</span> date<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//省略</span></code></pre></div>","position":{"start":{"line":219,"column":1,"offset":4965},"end":{"line":226,"column":4,"offset":5209}}},{"type":"paragraph","children":[{"type":"html","value":"<small>","position":{"start":{"line":227,"column":1,"offset":5210},"end":{"line":227,"column":8,"offset":5217}}},{"type":"text","value":"※ JSの月を取得するgetMonthメソッドは0始まりなので1プラスする必要があります。","position":{"start":{"line":227,"column":8,"offset":5217},"end":{"line":227,"column":53,"offset":5262}}},{"type":"html","value":"</small>","position":{"start":{"line":227,"column":53,"offset":5262},"end":{"line":227,"column":61,"offset":5270}}}],"position":{"start":{"line":227,"column":1,"offset":5210},"end":{"line":227,"column":61,"offset":5270}}},{"type":"paragraph","children":[{"type":"html","value":"<br>","position":{"start":{"line":229,"column":1,"offset":5272},"end":{"line":229,"column":5,"offset":5276}}},{"type":"text","value":"案件名一覧をスプシから取得します。データのA列です。","position":{"start":{"line":229,"column":5,"offset":5276},"end":{"line":229,"column":31,"offset":5302}}}],"position":{"start":{"line":229,"column":1,"offset":5272},"end":{"line":229,"column":31,"offset":5302}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-1.jpg","alt":"案件管理のシートに案件名とIDを登録","position":{"start":{"line":231,"column":1,"offset":5304},"end":{"line":231,"column":55,"offset":5358}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 144.30379746835442%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHtt0QAU86EAf/EABkQAQACAwAAAAAAAAAAAAAAABEAEAEgIf/aAAgBAQABBQIh3TFpf//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABUQAQEAAAAAAAAAAAAAAAAAAAEw/9oACAEBAAY/Amn/xAAbEAABBAMAAAAAAAAAAAAAAAABABARISAxof/aAAgBAQABPyHsjRBoMBT6YUt//9oADAMBAAIAAwAAABBwxzz/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAdEAEAAQQDAQAAAAAAAAAAAAABEQAQITFBgZHB/9oACAEBAAE/EBoh0gzp+UrKAZJ3YoOfb6bqCBME0NJjiuq//9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9d9a093ce18c281ef689907d9833cd18/81b7c/entry475-1.webp 158w,\n/static/9d9a093ce18c281ef689907d9833cd18/c85cb/entry475-1.webp 300w\"\n              sizes=\"(max-width: 300px) 100vw, 300px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9d9a093ce18c281ef689907d9833cd18/ff44c/entry475-1.jpg 158w,\n/static/9d9a093ce18c281ef689907d9833cd18/f93b5/entry475-1.jpg 300w\"\n            sizes=\"(max-width: 300px) 100vw, 300px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9d9a093ce18c281ef689907d9833cd18/f93b5/entry475-1.jpg\"\n            alt=\"案件管理のシートに案件名とIDを登録\"\n            title=\"案件管理のシートに案件名とIDを登録\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":231,"column":1,"offset":5304},"end":{"line":231,"column":55,"offset":5358}}},{"type":"html","lang":"js","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//省略</span>\n<span class=\"token keyword\">const</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//元々あるコード</span>\n<span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'データ'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//省略</span>\n<span class=\"token keyword\">const</span> projectsLastRow <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\noutput<span class=\"token punctuation\">.</span>projects <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> projectsLastRow <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//省略</span></code></pre></div>","position":{"start":{"line":233,"column":1,"offset":5360},"end":{"line":241,"column":4,"offset":5673}}},{"type":"paragraph","children":[{"type":"text","value":"取得したい列の最終行を取得し、一気に","position":{"start":{"line":242,"column":1,"offset":5674},"end":{"line":242,"column":19,"offset":5692}}},{"type":"html","value":"<code class=\"language-text\">getValues</code>","position":{"start":{"line":242,"column":19,"offset":5692},"end":{"line":242,"column":30,"offset":5703}}},{"type":"text","value":"メソッドでシートのデータを一気に取得します。","position":{"start":{"line":242,"column":30,"offset":5703},"end":{"line":242,"column":52,"offset":5725}}}],"position":{"start":{"line":242,"column":1,"offset":5674},"end":{"line":242,"column":52,"offset":5725}}},{"type":"paragraph","children":[{"type":"html","value":"<small>","position":{"start":{"line":244,"column":1,"offset":5727},"end":{"line":244,"column":8,"offset":5734}}},{"type":"text","value":"※ getValueとgetValuesがあるので間違えないように注意してください。","position":{"start":{"line":244,"column":8,"offset":5734},"end":{"line":244,"column":50,"offset":5776}}},{"type":"html","value":"</small>","position":{"start":{"line":244,"column":50,"offset":5776},"end":{"line":244,"column":58,"offset":5784}}}],"position":{"start":{"line":244,"column":1,"offset":5727},"end":{"line":244,"column":58,"offset":5784}}},{"type":"html","lang":"js","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">シート<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>行の始まり<span class=\"token punctuation\">,</span> 取得したい列<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nシート名<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>取得したい行の先頭<span class=\"token punctuation\">,</span> 取得したい列の先頭<span class=\"token punctuation\">,</span> <span class=\"token function\">行数</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">,</span>列数<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":245,"column":1,"offset":5785},"end":{"line":248,"column":4,"offset":5936}}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">getValues</code>","position":{"start":{"line":250,"column":1,"offset":5938},"end":{"line":250,"column":12,"offset":5949}}},{"type":"text","value":"で取得した値は2次元配列になります。","position":{"start":{"line":250,"column":12,"offset":5949},"end":{"line":250,"column":30,"offset":5967}}}],"position":{"start":{"line":250,"column":1,"offset":5938},"end":{"line":250,"column":30,"offset":5967}}},{"type":"html","lang":"js","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token constant\">A2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">A3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">A4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></code></pre></div>","position":{"start":{"line":251,"column":1,"offset":5968},"end":{"line":253,"column":4,"offset":5996}}},{"type":"paragraph","children":[{"type":"text","value":"HTML側で値を出力します。","position":{"start":{"line":255,"column":1,"offset":5998},"end":{"line":255,"column":15,"offset":6012}}},{"type":"link","title":null,"url":"/blogs/entry459/","children":[{"type":"text","value":"EJSちっく","position":{"start":{"line":255,"column":16,"offset":6013},"end":{"line":255,"column":22,"offset":6019}}}],"position":{"start":{"line":255,"column":15,"offset":6012},"end":{"line":255,"column":41,"offset":6038}}},{"type":"text","value":"な書き方です。","position":{"start":{"line":255,"column":41,"offset":6038},"end":{"line":255,"column":48,"offset":6045}}}],"position":{"start":{"line":255,"column":1,"offset":5998},"end":{"line":255,"column":48,"offset":6045}}},{"type":"html","lang":"html","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n  発行日：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>date<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>date<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>&lt;?= date?><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\nプロジェクト名：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>project<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token prolog\">&lt;?= projects.forEach(function(option) { ?></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>&lt;?= option[0] ?><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token prolog\">&lt;?= option[0] ?></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token prolog\">&lt;? }); ?></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":257,"column":1,"offset":6047},"end":{"line":268,"column":4,"offset":6300}}},{"type":"paragraph","children":[{"type":"text","value":"これでフォーム上でGASから取得した値が表示できるようになりました！！","position":{"start":{"line":269,"column":1,"offset":6301},"end":{"line":269,"column":36,"offset":6336}}}],"position":{"start":{"line":269,"column":1,"offset":6301},"end":{"line":269,"column":36,"offset":6336}}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"./images/2021/06/entry475-15.jpg","alt":"","position":{"start":{"line":271,"column":1,"offset":6338},"end":{"line":271,"column":38,"offset":6375}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.88607594936708%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe7qAg//xAAWEAADAAAAAAAAAAAAAAAAAAAQESD/2gAIAQEAAQUChj//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAYEAEAAwEAAAAAAAAAAAAAAAABABARIf/aAAgBAQABPyFXeUzaLP/aAAwDAQACAAMAAAAQM8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAADAAMBAAAAAAAAAAAAAAAAARExQWGB/9oACAEBAAE/EEoS8SE7p+mRMI6Juz//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/34d84b7fa5566e918bebd698020f081c/81b7c/entry475-15.webp 158w,\n/static/34d84b7fa5566e918bebd698020f081c/6ea66/entry475-15.webp 315w,\n/static/34d84b7fa5566e918bebd698020f081c/7f61c/entry475-15.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/34d84b7fa5566e918bebd698020f081c/ff44c/entry475-15.jpg 158w,\n/static/34d84b7fa5566e918bebd698020f081c/a6688/entry475-15.jpg 315w,\n/static/34d84b7fa5566e918bebd698020f081c/066f9/entry475-15.jpg 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/34d84b7fa5566e918bebd698020f081c/066f9/entry475-15.jpg\"\n            alt=\"entry475 15\"\n            title=\"entry475 15\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":271,"column":1,"offset":6338},"end":{"line":271,"column":38,"offset":6375}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"バリデーション。保存するファイルのサイズやタイプを制限","position":{"start":{"line":273,"column":4,"offset":6380},"end":{"line":273,"column":31,"offset":6407}}}],"position":{"start":{"line":273,"column":1,"offset":6377},"end":{"line":273,"column":31,"offset":6407}},"data":{"id":"バリデーション。保存するファイルのサイズやタイプを制限","htmlAttributes":{"id":"バリデーション。保存するファイルのサイズやタイプを制限"},"hProperties":{"id":"バリデーション。保存するファイルのサイズやタイプを制限"}}},{"type":"paragraph","children":[{"type":"text","value":"なんでもポンポンアップロードされても困るので、ファイルのアップロードできるサイズと種類を制限します。","position":{"start":{"line":274,"column":1,"offset":6408},"end":{"line":274,"column":51,"offset":6458}}}],"position":{"start":{"line":274,"column":1,"offset":6408},"end":{"line":274,"column":51,"offset":6458}}},{"type":"paragraph","children":[{"type":"text","value":"合わせて\bファイルがない時もフォーム送信できないようにしておきます。","position":{"start":{"line":276,"column":1,"offset":6460},"end":{"line":276,"column":35,"offset":6494}}}],"position":{"start":{"line":276,"column":1,"offset":6460},"end":{"line":276,"column":35,"offset":6494}}},{"type":"paragraph","children":[{"type":"text","value":"今回はHTML側のJSで制御します。","position":{"start":{"line":278,"column":1,"offset":6496},"end":{"line":278,"column":19,"offset":6514}}}],"position":{"start":{"line":278,"column":1,"offset":6496},"end":{"line":278,"column":19,"offset":6514}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"初期状態で送信ボタンを押せないようにしておく","position":{"start":{"line":280,"column":5,"offset":6520},"end":{"line":280,"column":27,"offset":6542}}}],"position":{"start":{"line":280,"column":1,"offset":6516},"end":{"line":280,"column":27,"offset":6542}},"data":{"id":"初期状態で送信ボタンを押せないようにしておく","htmlAttributes":{"id":"初期状態で送信ボタンを押せないようにしておく"},"hProperties":{"id":"初期状態で送信ボタンを押せないようにしておく"}}},{"type":"paragraph","children":[{"type":"text","value":"ボタンに","position":{"start":{"line":281,"column":1,"offset":6543},"end":{"line":281,"column":5,"offset":6547}}},{"type":"emphasis","children":[{"type":"text","value":"name属性","position":{"start":{"line":281,"column":6,"offset":6548},"end":{"line":281,"column":12,"offset":6554}}}],"position":{"start":{"line":281,"column":5,"offset":6547},"end":{"line":281,"column":13,"offset":6555}}},{"type":"text","value":"と","position":{"start":{"line":281,"column":13,"offset":6555},"end":{"line":281,"column":14,"offset":6556}}},{"type":"emphasis","children":[{"type":"text","value":"disbled属性","position":{"start":{"line":281,"column":15,"offset":6557},"end":{"line":281,"column":24,"offset":6566}}}],"position":{"start":{"line":281,"column":14,"offset":6556},"end":{"line":281,"column":25,"offset":6567}}},{"type":"text","value":"を付与します。初期状態では","position":{"start":{"line":281,"column":25,"offset":6567},"end":{"line":281,"column":38,"offset":6580}}},{"type":"html","value":"<code class=\"language-text\">disbled=true</code>","position":{"start":{"line":281,"column":38,"offset":6580},"end":{"line":281,"column":52,"offset":6594}}},{"type":"text","value":"をセットし、ボタンを押せないようにしておきます。","position":{"start":{"line":281,"column":52,"offset":6594},"end":{"line":281,"column":76,"offset":6618}}}],"position":{"start":{"line":281,"column":1,"offset":6543},"end":{"line":281,"column":76,"offset":6618}}},{"type":"html","lang":"html","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\">google<span class=\"token punctuation\">.</span>script<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">.</span><span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span> <span class=\"token attr-name\">disabled</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>true</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>send<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>アップロード<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":283,"column":1,"offset":6620},"end":{"line":285,"column":4,"offset":6749}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"アップロードファイルに制限をかける","position":{"start":{"line":287,"column":5,"offset":6755},"end":{"line":287,"column":22,"offset":6772}}}],"position":{"start":{"line":287,"column":1,"offset":6751},"end":{"line":287,"column":22,"offset":6772}},"data":{"id":"アップロードファイルに制限をかける","htmlAttributes":{"id":"アップロードファイルに制限をかける"},"hProperties":{"id":"アップロードファイルに制限をかける"}}},{"type":"paragraph","children":[{"type":"text","value":"ファイルのinputタグに","position":{"start":{"line":288,"column":1,"offset":6773},"end":{"line":288,"column":14,"offset":6786}}},{"type":"emphasis","children":[{"type":"text","value":"onchange属性","position":{"start":{"line":288,"column":15,"offset":6787},"end":{"line":288,"column":25,"offset":6797}}}],"position":{"start":{"line":288,"column":14,"offset":6786},"end":{"line":288,"column":26,"offset":6798}}},{"type":"text","value":"と関数","position":{"start":{"line":288,"column":26,"offset":6798},"end":{"line":288,"column":29,"offset":6801}}},{"type":"html","value":"<code class=\"language-text\">fileChange</code>","position":{"start":{"line":288,"column":29,"offset":6801},"end":{"line":288,"column":41,"offset":6813}}},{"type":"text","value":"を追加します。","position":{"start":{"line":288,"column":41,"offset":6813},"end":{"line":288,"column":48,"offset":6820}}}],"position":{"start":{"line":288,"column":1,"offset":6773},"end":{"line":288,"column":48,"offset":6820}}},{"type":"paragraph","children":[{"type":"text","value":"値が変わった時に判定を入れ、処理します。","position":{"start":{"line":290,"column":1,"offset":6822},"end":{"line":290,"column":21,"offset":6842}}}],"position":{"start":{"line":290,"column":1,"offset":6822},"end":{"line":290,"column":21,"offset":6842}}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">fileChange</code>","position":{"start":{"line":292,"column":1,"offset":6844},"end":{"line":292,"column":13,"offset":6856}}},{"type":"text","value":"の詳細は","position":{"start":{"line":292,"column":13,"offset":6856},"end":{"line":292,"column":17,"offset":6860}}},{"type":"html","value":"<code class=\"language-text\">script</code>","position":{"start":{"line":292,"column":17,"offset":6860},"end":{"line":292,"column":25,"offset":6868}}},{"type":"text","value":"タグ内に記述します。","position":{"start":{"line":292,"column":25,"offset":6868},"end":{"line":292,"column":35,"offset":6878}}}],"position":{"start":{"line":292,"column":1,"offset":6844},"end":{"line":292,"column":35,"offset":6878}}},{"type":"html","lang":"html","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\nファイル：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onchange</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">fileChange</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n省略\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">function</span> <span class=\"token function\">fileChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pdf'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token operator\">||</span> e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jpeg'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token operator\">||</span> e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'png'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'size'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      e<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">.</span>disabled <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'適切なファイルをアップロードしてください。'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      e<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":294,"column":1,"offset":6880},"end":{"line":309,"column":4,"offset":7323}}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">要素.files[0]</code>","position":{"start":{"line":311,"column":1,"offset":7325},"end":{"line":311,"column":14,"offset":7338}}},{"type":"text","value":"でファイル情報が取れます。今回は","position":{"start":{"line":311,"column":14,"offset":7338},"end":{"line":311,"column":30,"offset":7354}}},{"type":"html","value":"<code class=\"language-text\">type</code>","position":{"start":{"line":311,"column":30,"offset":7354},"end":{"line":311,"column":36,"offset":7360}}},{"type":"text","value":"と","position":{"start":{"line":311,"column":36,"offset":7360},"end":{"line":311,"column":37,"offset":7361}}},{"type":"html","value":"<code class=\"language-text\">size</code>","position":{"start":{"line":311,"column":37,"offset":7361},"end":{"line":311,"column":43,"offset":7367}}},{"type":"text","value":"の値を判定します。","position":{"start":{"line":311,"column":43,"offset":7367},"end":{"line":311,"column":52,"offset":7376}}}],"position":{"start":{"line":311,"column":1,"offset":7325},"end":{"line":311,"column":52,"offset":7376}}},{"type":"heading","depth":4,"children":[{"type":"text","value":"ファイルアップロードの条件","position":{"start":{"line":313,"column":6,"offset":7383},"end":{"line":313,"column":19,"offset":7396}}}],"position":{"start":{"line":313,"column":1,"offset":7378},"end":{"line":313,"column":19,"offset":7396}},"data":{"id":"ファイルアップロードの条件","htmlAttributes":{"id":"ファイルアップロードの条件"},"hProperties":{"id":"ファイルアップロードの条件"}}},{"type":"table","align":[null,null],"children":[{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"種類","position":{"start":{"line":314,"column":2,"offset":7398},"end":{"line":314,"column":4,"offset":7400}}}],"position":{"start":{"line":314,"column":1,"offset":7397},"end":{"line":314,"column":5,"offset":7401}}},{"type":"tableCell","children":[{"type":"text","value":"条件","position":{"start":{"line":314,"column":5,"offset":7401},"end":{"line":314,"column":7,"offset":7403}}}],"position":{"start":{"line":314,"column":5,"offset":7401},"end":{"line":314,"column":8,"offset":7404}}}],"position":{"start":{"line":314,"column":1,"offset":7397},"end":{"line":314,"column":8,"offset":7404}}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"emphasis","children":[{"type":"text","value":"サイズ","position":{"start":{"line":316,"column":3,"offset":7413},"end":{"line":316,"column":6,"offset":7416}}}],"position":{"start":{"line":316,"column":2,"offset":7412},"end":{"line":316,"column":7,"offset":7417}}}],"position":{"start":{"line":316,"column":1,"offset":7411},"end":{"line":316,"column":8,"offset":7418}}},{"type":"tableCell","children":[{"type":"text","value":"10Mバイト以下（1000000バイト）","position":{"start":{"line":316,"column":8,"offset":7418},"end":{"line":316,"column":28,"offset":7438}}}],"position":{"start":{"line":316,"column":8,"offset":7418},"end":{"line":316,"column":29,"offset":7439}}}],"position":{"start":{"line":316,"column":1,"offset":7411},"end":{"line":316,"column":29,"offset":7439}}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"emphasis","children":[{"type":"text","value":"タイプ","position":{"start":{"line":317,"column":3,"offset":7442},"end":{"line":317,"column":6,"offset":7445}}}],"position":{"start":{"line":317,"column":2,"offset":7441},"end":{"line":317,"column":7,"offset":7446}}}],"position":{"start":{"line":317,"column":1,"offset":7440},"end":{"line":317,"column":8,"offset":7447}}},{"type":"tableCell","children":[{"type":"text","value":"MIMEタイプが「pdf」、「png」、「jpg」のみ","position":{"start":{"line":317,"column":8,"offset":7447},"end":{"line":317,"column":35,"offset":7474}}}],"position":{"start":{"line":317,"column":8,"offset":7447},"end":{"line":317,"column":36,"offset":7475}}}],"position":{"start":{"line":317,"column":1,"offset":7440},"end":{"line":317,"column":36,"offset":7475}}}],"position":{"start":{"line":314,"column":1,"offset":7397},"end":{"line":317,"column":36,"offset":7475}}},{"type":"paragraph","children":[{"type":"text","value":"それ以外は警告文を出力し、","position":{"start":{"line":319,"column":1,"offset":7477},"end":{"line":319,"column":14,"offset":7490}}},{"type":"html","value":"<code class=\"language-text\">value</code>","position":{"start":{"line":319,"column":14,"offset":7490},"end":{"line":319,"column":21,"offset":7497}}},{"type":"text","value":"に格納されたファイル情報も削除します。","position":{"start":{"line":319,"column":21,"offset":7497},"end":{"line":319,"column":40,"offset":7516}}}],"position":{"start":{"line":319,"column":1,"offset":7477},"end":{"line":319,"column":40,"offset":7516}}},{"type":"paragraph","children":[{"type":"html","value":"<br>","position":{"start":{"line":321,"column":1,"offset":7518},"end":{"line":321,"column":5,"offset":7522}}},{"type":"text","value":"ボタンの二度押し防止処理を入れます。","position":{"start":{"line":321,"column":5,"offset":7522},"end":{"line":321,"column":23,"offset":7540}}},{"type":"html","value":"<code class=\"language-text\">onclick</code>","position":{"start":{"line":321,"column":23,"offset":7540},"end":{"line":321,"column":32,"offset":7549}}},{"type":"text","value":"に直書きしていた関数を外に出します。","position":{"start":{"line":321,"column":32,"offset":7549},"end":{"line":321,"column":50,"offset":7567}}}],"position":{"start":{"line":321,"column":1,"offset":7518},"end":{"line":321,"column":50,"offset":7567}}},{"type":"html","lang":"html","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">sendData</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span> <span class=\"token attr-name\">disabled</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>true</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>send<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>アップロード<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":323,"column":1,"offset":7569},"end":{"line":325,"column":4,"offset":7669}}},{"type":"paragraph","children":[{"type":"text","value":"クリック後","position":{"start":{"line":326,"column":1,"offset":7670},"end":{"line":326,"column":6,"offset":7675}}},{"type":"html","value":"<code class=\"language-text\">didabled=true</code>","position":{"start":{"line":326,"column":6,"offset":7675},"end":{"line":326,"column":21,"offset":7690}}},{"type":"text","value":"でクリックができない状態にした上で、サーバーにデータ送信します。","position":{"start":{"line":326,"column":21,"offset":7690},"end":{"line":326,"column":53,"offset":7722}}}],"position":{"start":{"line":326,"column":1,"offset":7670},"end":{"line":326,"column":53,"offset":7722}}},{"type":"html","lang":"js","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sendData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  e<span class=\"token punctuation\">.</span>disabled <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  google<span class=\"token punctuation\">.</span>script<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">.</span><span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":327,"column":1,"offset":7723},"end":{"line":332,"column":4,"offset":7821}}},{"type":"html","value":"<div class=\"box\">\n<h4>name属性の値と関数名が被らないように気をつける</h4>\nname属性の値と関数名が一緒だと関数が動かないことがあります。関数とname属性が被らないように気をつけましょう。\n</div>","position":{"start":{"line":333,"column":1,"offset":7822},"end":{"line":336,"column":7,"offset":7940}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"データの取得を確認","position":{"start":{"line":338,"column":5,"offset":7946},"end":{"line":338,"column":14,"offset":7955}}}],"position":{"start":{"line":338,"column":1,"offset":7942},"end":{"line":338,"column":14,"offset":7955}},"data":{"id":"データの取得を確認","htmlAttributes":{"id":"データの取得を確認"},"hProperties":{"id":"データの取得を確認"}}},{"type":"paragraph","children":[{"type":"text","value":"GAS側（サーバー側）でデータを受け取れたか確認します。","position":{"start":{"line":339,"column":1,"offset":7956},"end":{"line":339,"column":29,"offset":7984}}}],"position":{"start":{"line":339,"column":1,"offset":7956},"end":{"line":339,"column":29,"offset":7984}}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">sendForm</code>","position":{"start":{"line":341,"column":1,"offset":7986},"end":{"line":341,"column":11,"offset":7996}}},{"type":"text","value":"には","position":{"start":{"line":341,"column":11,"offset":7996},"end":{"line":341,"column":13,"offset":7998}}},{"type":"html","value":"<code class=\"language-text\">console.log</code>","position":{"start":{"line":341,"column":13,"offset":7998},"end":{"line":341,"column":26,"offset":8011}}},{"type":"text","value":"を仕込んだままになっているので、そのまま使います。","position":{"start":{"line":341,"column":26,"offset":8011},"end":{"line":341,"column":51,"offset":8036}}}],"position":{"start":{"line":341,"column":1,"offset":7986},"end":{"line":341,"column":51,"offset":8036}}},{"type":"html","lang":"js","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">form</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":343,"column":1,"offset":8038},"end":{"line":347,"column":4,"offset":8095}}},{"type":"paragraph","children":[{"type":"text","value":"実行数を確認します。フォームから飛んできた値が取得できましたね！！\n","position":{"start":{"line":349,"column":1,"offset":8097},"end":{"line":350,"column":1,"offset":8131}}},{"type":"html","title":null,"url":"./images/2021/06/entry476-1.jpg","alt":"","position":{"start":{"line":350,"column":1,"offset":8131},"end":{"line":350,"column":37,"offset":8167}},"value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.050632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3QUH/8QAFhAAAwAAAAAAAAAAAAAAAAAAABAR/9oACAEBAAEFAlD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAVEAEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAQABPyGIh//aAAwDAQACAAMAAAAQ8A//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAABBAMAAAAAAAAAAAAAAAARAAEhkUFhcf/aAAgBAQABPxARm0zSJna6Wv/Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e3b45849d73f941ec012a477b1c22596/81b7c/entry476-1.webp 158w,\n/static/e3b45849d73f941ec012a477b1c22596/6ea66/entry476-1.webp 315w,\n/static/e3b45849d73f941ec012a477b1c22596/e88ff/entry476-1.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e3b45849d73f941ec012a477b1c22596/ff44c/entry476-1.jpg 158w,\n/static/e3b45849d73f941ec012a477b1c22596/a6688/entry476-1.jpg 315w,\n/static/e3b45849d73f941ec012a477b1c22596/b4294/entry476-1.jpg 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e3b45849d73f941ec012a477b1c22596/b4294/entry476-1.jpg\"\n            alt=\"entry476 1\"\n            title=\"entry476 1\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>"}],"position":{"start":{"line":349,"column":1,"offset":8097},"end":{"line":350,"column":37,"offset":8167}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"ここまでの全ソースはこちら","position":{"start":{"line":352,"column":4,"offset":8172},"end":{"line":352,"column":17,"offset":8185}}}],"position":{"start":{"line":352,"column":1,"offset":8169},"end":{"line":352,"column":17,"offset":8185}},"data":{"id":"ここまでの全ソースはこちら","htmlAttributes":{"id":"ここまでの全ソースはこちら"},"hProperties":{"id":"ここまでの全ソースはこちら"}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"GAS","position":{"start":{"line":353,"column":5,"offset":8190},"end":{"line":353,"column":8,"offset":8193}}}],"position":{"start":{"line":353,"column":1,"offset":8186},"end":{"line":353,"column":8,"offset":8193}},"data":{"id":"gas","htmlAttributes":{"id":"gas"},"hProperties":{"id":"gas"}}},{"type":"html","lang":"js","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/**\n * スプシ側にUI表示\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">showModal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'データ'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> output <span class=\"token operator\">=</span> HtmlService<span class=\"token punctuation\">.</span><span class=\"token function\">createTemplateFromFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'upload'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//カスタマー取得</span>\n  <span class=\"token keyword\">const</span> projectsLastRow <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNextDataCell</span><span class=\"token punctuation\">(</span>SpreadsheetApp<span class=\"token punctuation\">.</span>Direction<span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> projects <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> projectsLastRow<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  output<span class=\"token punctuation\">.</span>projects <span class=\"token operator\">=</span> projects<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//デフォルトの日付</span>\n  <span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  output<span class=\"token punctuation\">.</span>date <span class=\"token operator\">=</span> date<span class=\"token punctuation\">.</span><span class=\"token function\">getFullYear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'-'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getMonth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span> <span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> <span class=\"token string\">'-'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span> <span class=\"token operator\">+</span> date<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> output<span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * スプシのフォームからの値の受け取り\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">form</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":354,"column":1,"offset":8194},"end":{"line":382,"column":4,"offset":8944}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"upload.html","position":{"start":{"line":383,"column":5,"offset":8949},"end":{"line":383,"column":16,"offset":8960}}}],"position":{"start":{"line":383,"column":1,"offset":8945},"end":{"line":383,"column":16,"offset":8960}},"data":{"id":"uploadhtml","htmlAttributes":{"id":"uploadhtml"},"hProperties":{"id":"uploadhtml"}}},{"type":"html","lang":"html","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>base</span> <span class=\"token attr-name\">target</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>_top<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://ssl.gstatic.com/docs/script/css/add-ons.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n          発行日：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>date<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>date<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>&lt;?= date?><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n        プロジェクト名：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>project<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          <span class=\"token prolog\">&lt;?= projects.forEach(function(option) { ?></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>&lt;?= option[0] ?><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token prolog\">&lt;?= option[0] ?></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token prolog\">&lt;? }); ?></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n        ファイル：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onchange</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">fileChange</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">/></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">sendData</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span> <span class=\"token attr-name\">disabled</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>true</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>send<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>action<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>アップロード<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n      <span class=\"token keyword\">function</span> <span class=\"token function\">fileChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pdf'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token operator\">||</span>e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jpeg'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token operator\">||</span>e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'png'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> e<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'size'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">)</span>\n          e<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">.</span>disabled <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'適切なファイルをアップロードしてください。'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          e<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">function</span> <span class=\"token function\">sendData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        e<span class=\"token punctuation\">.</span>disabled <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n        google<span class=\"token punctuation\">.</span>script<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">.</span><span class=\"token function\">sendForm</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":384,"column":1,"offset":8961},"end":{"line":427,"column":4,"offset":10283}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"まとめ・UIを作るところまでは意外とカンタン","position":{"start":{"line":429,"column":4,"offset":10288},"end":{"line":429,"column":26,"offset":10310}}}],"position":{"start":{"line":429,"column":1,"offset":10285},"end":{"line":429,"column":26,"offset":10310}},"data":{"id":"まとめ・uiを作るところまでは意外とカンタン","htmlAttributes":{"id":"まとめ・uiを作るところまでは意外とカンタン"},"hProperties":{"id":"まとめ・uiを作るところまでは意外とカンタン"}}},{"type":"paragraph","children":[{"type":"text","value":"こんな便利な機能をタダで使わせてくれるなんてGoogleは神かと思いますw","position":{"start":{"line":430,"column":1,"offset":10311},"end":{"line":430,"column":38,"offset":10348}}}],"position":{"start":{"line":430,"column":1,"offset":10311},"end":{"line":430,"column":38,"offset":10348}}},{"type":"paragraph","children":[{"type":"text","value":"一度作ってしまえば長く使えます！GASで仕事を効率化して、しっかり本業に集中しましょう！！","position":{"start":{"line":432,"column":1,"offset":10350},"end":{"line":432,"column":46,"offset":10395}}}],"position":{"start":{"line":432,"column":1,"offset":10350},"end":{"line":432,"column":46,"offset":10395}}},{"type":"paragraph","children":[{"type":"text","value":"続きもありますのでぜひ合わせてお読みいただき、効率化ライフを満喫してください！","position":{"start":{"line":434,"column":1,"offset":10397},"end":{"line":434,"column":40,"offset":10436}}}],"position":{"start":{"line":434,"column":1,"offset":10397},"end":{"line":434,"column":40,"offset":10436}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"続きの記事も合わせてお読みください","position":{"start":{"line":436,"column":5,"offset":10442},"end":{"line":436,"column":22,"offset":10459}}}],"position":{"start":{"line":436,"column":1,"offset":10438},"end":{"line":436,"column":22,"offset":10459}},"data":{"id":"続きの記事も合わせてお読みください","htmlAttributes":{"id":"続きの記事も合わせてお読みください"},"hProperties":{"id":"続きの記事も合わせてお読みください"}}},{"type":"paragraph","children":[{"type":"text","value":"次は実際ドライブに保存し、ファイルの詳細を自動でスプシに追記します。","position":{"start":{"line":437,"column":1,"offset":10460},"end":{"line":437,"column":35,"offset":10494}}}],"position":{"start":{"line":437,"column":1,"offset":10460},"end":{"line":437,"column":35,"offset":10494}}},{"type":"html","value":"<a class=\"article-link\" href=\"/blogs/entry476/\">\n<section><div class=\"article-link__img\"><img alt=\"事例で紹介【GAS】スプシからファイルアップロードし、ドライブに保存・保存編\" src=\"/static/b4bf1409820c6b3c49db0802a47b85d1/f836f/entry476.jpg\" width=\"150\" height=\"113\" class=\"\"></div><div class=\"article-link__main\">\n<div class=\"article-link__main__title\">事例で紹介【GAS】スプシからファイルアップロードし、ドライブに保存・保存編</div>\n<p class=\"description\">プログラミングで自動化してヒューマンエラーやルールのブレをを減らしたい！Google Apps Scriptを使ってスプシ（Googleスプレッドシート）から･･･</p>\n<p>\n<time datetime=\"2021-06-24\">2021.06.24</time>\n</p>\n</div>\n</section>\n</a>","position":{"start":{"line":439,"column":1,"offset":10496},"end":{"line":448,"column":5,"offset":11045}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":449,"column":1,"offset":11046}}}}